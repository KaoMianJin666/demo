import{T as e}from"./TLoading-kM9Il1tQ.js";import{r as a,x as t,o as l,j as s,k as n,m as o,n as r,p as i,w as u,F as d,A as c,u as p,B as v,D as m,y,J as g,C as _,K as f,O as k,P as w,v as b,E as h}from"./lib-COJami17.js";import{l as j}from"./logo2-l66aD4rS.js";import{o as x,j as D}from"./index-BKne-HHw.js";import{a as C,r as S,j as U}from"./file-C3RgH22k.js";import{_ as O}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{u as J,r as E}from"./index-D6YqgH8W.js";import{s as I,u as T,a as q}from"./promptSetting-hhAtHCyC.js";/* empty css                                                                 */const z={class:"resoure-data-body"},N={class:"data-area"},F={class:"name"},P={class:"data-content-area"},L={class:"data-content-box"},R={key:1,class:"data-content-colors"},A={class:"data-content-colors-info"},B={class:"data-image-area"},K=["src"],G=O({__name:"resourceData",props:["type","data"],setup(e,{expose:_}){const f=e,k=a({});t(f,"data");const w=f.type,b={prompts:[{name:"资源描述",type:"string",key:"description"},{name:"关键词语",type:"arr",key:"keywords"},{name:"触发词语",type:"string",key:"trigger"},{name:"资源权重",type:"string",key:"server_type"},{name:"资源地址",type:"string",key:"cloud_folder"},{name:"预览图地址",type:"string",key:"preview"},{name:"lora",type:"string",key:"lora"}],statics:[{name:"资源描述",type:"string",key:"description"},{name:"关键词语",type:"arr",key:"keywords"},{name:"资源文件夹",type:"string",key:"cloud_folder"},{name:"预览图地址",type:"string",key:"preview"}],texts:[{name:"资源描述",type:"string",key:"description"},{name:"关键词语",type:"arr",key:"keywords"},{name:"字体地址",type:"string",key:"font"},{name:"资源路径",type:"string",key:"cloud_folder"},{name:"字体大小",type:"string",key:"font_size"},{name:"字体颜色",type:"color",key:"font_color"}],colors:[{name:"资源描述",type:"string",key:"description"},{name:"关键词语",type:"arr",key:"keywords"},{name:"调色板",type:"colors",key:"colors"}]};return l((()=>{b[w].forEach((({key:e,type:a})=>{"arr"===a?k.value[e]=f.data[e]?f.data[e].join(","):"":"string"===a?k.value[e]=f.data[e]:"color"===a?k.value[e]=C(f.data[e]):"colors"===a&&(k.value[e]=f.data[e].map((e=>({color:C(e.color),description:e.description}))))})),k.value.resource_name=f.data.resource_name,k.value.preview=f.data.preview})),_({getSaveData:()=>{let e={};return b[w].forEach((({key:a,type:t})=>{"arr"===t?e[a]=k.value[a].split(","):"string"===t?e[a]=k.value[a]:"color"===t?e[a]=S(k.value[a]):"colors"===t&&(e[a]=k.value[a].map((e=>({color:S(e.color),description:e.description}))))})),e.resource_name=k.value.resource_name,e.preview=k.value.preview,e}}),(e,a)=>{const t=s("n-input"),l=s("n-color-picker"),_=s("n-button"),f=s("n-scrollbar");return n(),o("div",z,[r("div",N,[r("div",F,[i(t,{style:{"--n-padding-left":"0px !important","--n-font-size":"0.833rem !important"},placeholder:"请输入名称",class:"data-content-input editor-setting-input",value:k.value.resource_name,"onUpdate:value":a[0]||(a[0]=e=>k.value.resource_name=e)},null,8,["value"])]),r("div",P,[r("div",L,[i(f,null,{default:u((()=>[(n(!0),o(d,null,c(b[p(w)],(e=>(n(),o("div",{class:"data-content-item",key:e.name},[r("label",null,v(e.name),1),"color"===e.type?(n(),m(l,{key:0,value:k.value[e.key],"onUpdate:value":a=>k.value[e.key]=a},null,8,["value","onUpdate:value"])):"colors"===e.type?(n(),o("div",R,[r("div",A,[(n(!0),o(d,null,c(k.value[e.key],((s,r)=>(n(),o("div",{class:"data-content-colors-item",key:r},[i(l,{modes:["rgb"],"render-label":()=>"",value:k.value[e.key][r].color,"onUpdate:value":a=>k.value[e.key][r].color=a,style:{width:"0.9rem",color:"transparent","margin-right":"0.2rem"}},null,8,["value","onUpdate:value"]),i(t,{class:"data-content-input editor-setting-input",style:{flex:"1"},value:k.value[e.key][r].description,"onUpdate:value":a=>k.value[e.key][r].description=a},null,8,["value","onUpdate:value"]),r===k.value[e.key].length-1?(n(),m(_,{key:0,strong:"",secondary:"",type:"success",style:{width:"1rem","margin-left":"0.5rem"},onClick:a=>k.value[e.key].push({color:"rgba(255,255,255,1)",description:""})},{default:u((()=>a[1]||(a[1]=[y("+")]))),_:2},1032,["onClick"])):g("",!0)])))),128))])])):(n(),m(t,{key:2,class:"data-content-input editor-setting-input",value:k.value[e.key],"onUpdate:value":a=>k.value[e.key]=a},null,8,["value","onUpdate:value"]))])))),128))])),_:1})])])]),r("div",B,[r("img",{src:k.value.preview},null,8,K)])])}}},[["__scopeId","data-v-6ea51a01"]]),H=O({__name:"dataCard",props:{data:{type:Object,default:()=>({preview:null,name:null})}},setup(e){const{publicStore:l}=J(),r=t(l,"isCarryOut"),i=e,u=a([]),d=a(!0),c=a("imageDom"),p=()=>{u.value=[]};return(e,a)=>{const t=s("n-image");return n(),o("div",{class:_(["data-item",{expand:!r.value}])},[d.value?(n(),m(t,{key:0,ref_key:"imageDom",ref:c,width:"100%","object-fit":"cover","preview-disabled":"",onClose:p,"preview-src-list":u.value,src:i.data.preview,class:"model-image",fit:"contain"},null,8,["preview-src-list","src"])):g("",!0)],2)}}},[["__scopeId","data-v-45079080"]]),M={class:"image-card"},Q={class:"image-area"},V={class:"prompts cn"},W={class:"copy-btn"},X={class:"prompts en"},Y={class:"copy-btn"},Z=O({__name:"imagePreview",props:["to"],setup(e,{expose:t}){f();const l=a(!1),o=a(null),d=f(),c=a(null),y=a(null),g=e=>{try{navigator.clipboard.writeText(e).then((()=>{d.info("复制成功")})).catch((e=>{}))}catch(t){var a=document.createElement("textarea");a.style.position="fixed",a.style.opacity=0,a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),d.info("复制成功")}};return t({init:e=>{o.value=e.file_path,c.value=e.prompt_cn,y.value=e.prompt_en,l.value=!0}}),(e,a)=>{const t=s("n-image"),d=s("n-modal");return n(),m(d,{show:l.value,"onUpdate:show":a[2]||(a[2]=e=>l.value=e),"auto-focus":!1},{default:u((()=>[r("div",M,[r("div",Q,[i(t,{src:o.value,width:"100%",class:"image","object-fit":"cover","preview-disabled":""},null,8,["src"])]),r("div",V,[r("div",W,[r("i",{class:_(["bi",p(x)]),onClick:a[0]||(a[0]=e=>g(c.value))},null,2)]),r("div",null,[a[3]||(a[3]=r("label",null,"中文prompt",-1)),r("span",null,v(c.value),1)])]),r("div",X,[r("div",Y,[r("i",{class:_(["bi",p(x)]),onClick:a[1]||(a[1]=e=>g(y.value))},null,2)]),r("div",null,[a[4]||(a[4]=r("label",null,"英文prompt",-1)),r("span",null,v(y.value),1)])])])])),_:1},8,["show"])}}},[["__scopeId","data-v-5f963575"]]),$={class:"resoure-data-body"},ee={class:"resoure-data-title"},ae={class:"json-input"},te={class:"json-code"},le=O({__name:"resourceJsonData",props:["type","data"],setup(e,{expose:l}){const d=f();k.registerLanguage("json",w);const c=e,v=t(c,"data");c.type,a('{\n  "a":12346,\n  "b":"text"\n}');return l({getSaveData:()=>{let e=null;try{e=JSON.parse(JSON.stringify(v.value)),e.data=JSON.parse(e.data)}catch(a){throw d.error("json格式错误"),new Error("json格式错误")}return e}}),(e,a)=>{const t=s("n-input"),l=s("n-code"),d=s("n-config-provider");return n(),o("div",$,[r("div",ee,[i(t,{style:{"--n-padding-left":"0px !important","--n-font-size":"0.833rem !important"},placeholder:"请输入名称",class:"data-content-input editor-setting-input",value:v.value.resource_name,"onUpdate:value":a[0]||(a[0]=e=>v.value.resource_name=e)},null,8,["value"])]),r("div",ae,[i(t,{rows:10,type:"textarea",value:v.value.data,"onUpdate:value":a[1]||(a[1]=e=>v.value.data=e)},null,8,["value"])]),r("div",te,[i(d,{hljs:p(k)},{default:u((()=>[i(l,{"show-line-numbers":"",code:v.value.data,language:"json"},null,8,["code"])])),_:1},8,["hljs"])])])}}},[["__scopeId","data-v-4f2e65d7"]]);const se={class:"resoure-info-body"},ne={class:"resoure-info-title"},oe={class:"logo-area"},re=["src"],ie={class:"data-area"},ue={key:2,class:"empty-block"},de=O({__name:"index",setup(t){const y=f();b();const k=h(),w=k.query.type,x={prompts:"动态资源",statics:"静态资源",texts:"文字资源",colors:"调色板资源",designs:"设计理念"},C=a(null),S=a(null),O=a(null);let J=k.query.id;const z=a({}),N=a({}),F=a({}),P=()=>{let e=null;"designs"!==w?(e=S.value.getSaveData(),e=Object.assign(e,F.value)):e=O.value.getSaveData(),e.resource_type=w;const a=U("designs"!==w?e:e.data,e.resource_name),t=new FormData;t.append("file",a),I(e,t).then((e=>{200===e.code&&y.success("保存成功")}))},L=()=>{let e=null;"designs"!==w?(e=S.value.getSaveData(),e=Object.assign(e,F.value)):(e=O.value.getSaveData(),e=Object.assign(e,F.value)),e.resource_id=J,e.resource_type=w;const a=U("designs"!==w?e:e.data,e.resource_name),t=new FormData;t.append("file",a),T(e,t).then((e=>{200===e.code&&y.success("保存成功")}))},R=()=>{J&&q(J).then((e=>{if(200===e.code){if("designs"===w)N.value.data=JSON.stringify(e.data,null,2);else{const a=e.data;a.preview=e.info.preview,N.value=a}F.value=e.info,N.value.resource_name=e.info.resource_name,(a={folder_path:e.data.cloud_folder,page:1,page_size:1e5},E.post("/oplus/query_cloud_folder",a)).then((e=>{z.value=e.data}))}var a}))};return l((()=>{R(),window.loading||(window.loading=e()),setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300)})),(e,a)=>{const t=s("n-scrollbar");return n(),o("div",se,[r("div",ne,[r("div",oe,[r("img",{src:p(j)},null,8,re)]),r("div",null,[r("label",{onClick:a[0]||(a[0]=e=>{window.history.back()})},v(x[p(w)]),1),r("i",{class:_(["bi logo-icon",p(D)])},null,2)]),r("div",{class:"save-btn",onClick:a[1]||(a[1]=e=>{J?L():P()})}," 保存资料 ")]),r("div",ie,[i(t,null,{default:u((()=>["designs"===p(w)?(n(),m(le,{key:0,ref_key:"resourceJsonDataRef",ref:O,data:N.value},null,8,["data"])):g("",!0),"designs"===p(w)||!Object.keys(N.value).length&&p(J)?g("",!0):(n(),m(G,{key:1,ref_key:"resourceDataRef",ref:S,type:p(w),data:N.value},null,8,["type","data"])),"designs"!==p(w)?(n(),o("div",ue)):g("",!0),"designs"!==p(w)?(n(!0),o(d,{key:3},c(z.value,(e=>(n(),m(H,{key:e.template_id,onClick:a=>{return t=e,void C.value.init(t);var t},data:{name:e.template_name,preview:e.thumbnail}},null,8,["onClick","data"])))),128)):g("",!0)])),_:1})]),i(Z,{ref_key:"imagePreviewDom",ref:C},null,512)])}}},[["__scopeId","data-v-8f908aac"]]);export{de as default};
