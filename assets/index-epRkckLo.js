import{x as e,m as a,n as t,F as l,A as s,J as o,k as n,H as d,r,D as u,C as i,T as c,G as p,j as v,B as m,p as y,w as f,y as g,u as _,V as k,N as b,M as w,o as h,E as x,L as D,K as j}from"./lib-COJami17.js";import{_ as S}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{T as A}from"./TLoading-kM9Il1tQ.js";import{u as R,o as T}from"./opInput-CIV_1bdK.js";import{l as W}from"./logo2-l66aD4rS.js";import{u as O,_ as I}from"./index-D6YqgH8W.js";import V from"./index-Bm3kBrhg.js";import{a as C,g as P}from"./promptSetting-hhAtHCyC.js";import{g as E}from"./artwork-XtWkw08w.js";import L from"./index-bi14ToAU.js";import{m as M,c as N,h as U,a as q}from"./index-Cq1HtkT0.js";/* empty css                                                                 */import{j as J,m as Y,h as z,k as $,n as B,q as F,r as G}from"./index-BKne-HHw.js";import{a as H,u as K,s as Q}from"./dataWarehouse-H8QLTY-h.js";import{j as X}from"./file-C3RgH22k.js";import"./modelCard-DJAcxQ_x.js";import"./menu-B85Lp49n.js";const Z={class:"page-count-body"},ee={class:"page-count-inner"},ae=["num"],te=S({__name:"pageCount",props:{pageData:{type:Array(),default:()=>[]},now:{type:Number,default:0}},emits:["addPage"],setup(r,{emit:u}){const i=u,c=r,p=e(c,"pageData"),v=e(c,"now");return(e,r)=>(n(),a("div",Z,[t("div",ee,[p.value.length>1?(n(!0),a(l,{key:0},s(p.value,((e,l)=>{return n(),a("div",{class:"page-count",style:d((s=l,s===v.value?{transform:"translateY(0rem)"}:s>v.value?{transform:"translateY(100%)"}:s<v.value?{transform:"translateY(-100%)"}:void 0)),key:l},r[1]||(r[1]=[t("div",{class:"page-count-line"},null,-1),t("label",null,null,-1)]),4);var s})),128)):o("",!0),v.value===p.value.length-1?(n(),a("div",{key:1,class:"add-btn",num:p.value.length,onClick:r[0]||(r[0]=e=>{i("addPage")})},r[2]||(r[2]=[t("div",{class:"page-count-line"},null,-1),t("label",null,"+",-1)]),8,ae)):o("",!0)])]))}},[["__scopeId","data-v-95a86af8"]]),le=S({__name:"modelSelectedDialog",props:["type"],emits:["setData"],setup(t,{expose:l,emit:s}){const{publicStore:d}=O(),p=s,v=e(d,"isCarryOut"),m=r(!1),y=e=>{p("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(e,l)=>(n(),u(c,{to:"body"},[m.value?(n(),a("div",{key:0,class:i(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(n(),u(V,{key:0,componentType:"component",type:t.type,onSetData:y},null,8,["type"])):o("",!0)],2)):o("",!0)]))}},[["__scopeId","data-v-15493417"]]),se={class:"json-editor-body"},oe={class:"input-area"},ne={key:1},de={key:2,class:"image-area"},re=["src"],ue={class:"add-image-area"},ie=S({__name:"jsonEditor",props:{modelValue:{default:()=>[{key:"",code:null,value:null}]},list:{default:!1}},emits:["update:modelValue"],setup(e,{expose:d,emit:c}){const w=k((()=>I((()=>Promise.resolve().then((()=>ce))),void 0))),h=[{name:"文本",code:"text"},{name:"图片",code:"image"},{name:"字典",code:"map"},{name:"列表",code:"list"}],x=r(e.modelValue),D=c;p(x.value,(e=>{D("update:modelValue",e)}));const j=()=>{x.value.push({key:"",code:null,value:null})},S=(e=x.value,a="map")=>{const t="map"===a?{}:[];return e.forEach((({key:e,code:l,value:s},o)=>{if(l)switch(l){case"text":case"image":"map"===a?t[e]=s:t[o]=s;break;case"list":"map"===a?t[e]=S(s,"list"):t[o]=S(s,"list");break;case"map":"map"===a?t[e]=S(s):t[o]=S(s)}})),t},A=(e={},a="map")=>{let t=[];return Object.keys(e).forEach((a=>{const l={key:a,code:null,value:null};Array.isArray(e[a])?e[a].every((e=>e.includes("http")))?(l.code="image",l.value=e[a]):(l.code="list",l.value=A(e[a]).map((e=>(e.key=null,e)))):"string"==typeof e[a]?(l.code="text",l.value=e[a]):(l.code="map",l.value=A(e[a])),t.push(l)})),t};return d({getData:()=>x.value,getSaveData:S,init:e=>{const a=e[0],t=A(a);x.value=t}}),(d,r)=>{const c=v("n-input"),p=v("n-button"),k=v("n-upload");return n(),a("div",se,[t("div",oe,[(n(!0),a(l,null,s(x.value,((d,v)=>(n(),a("div",{class:"input-group",key:v},[t("div",{class:i(["input-key",{list:e.list,unlist:!e.list}])},[e.list?(n(),a("label",ne,m(v+1),1)):(n(),u(c,{key:0,value:d.key,"onUpdate:value":e=>d.key=e,placeholder:"键名称"},null,8,["value","onUpdate:value"]))],2),t("div",{class:i(["input-value",{list:e.list,unlist:!e.list}])},[d.code?o("",!0):(n(),a(l,{key:0},s(h,(e=>y(p,{class:"type-btn",key:e.code,onClick:a=>((e,a)=>{switch(e.code=a,a){case"text":e.value=null;break;case"image":case"map":case"list":e.value=[]}})(d,e.code)},{default:f((()=>[g(m(e.name),1)])),_:2},1032,["onClick"]))),64)),"text"===d.code?(n(),u(c,{key:1,value:d.value,"onUpdate:value":e=>d.value=e,placeholder:"请输入文本",type:"textarea"},null,8,["value","onUpdate:value"])):o("",!0),"image"===d.code?(n(),a("div",de,[(n(!0),a(l,null,s(d.value,((e,l)=>(n(),a("div",{class:"image-item",key:`image-${l}`},[t("img",{src:e},null,8,re)])))),128)),t("div",ue,[y(k,{"show-file-list":!1,accept:"image/*",action:"",onBeforeUpload:(...e)=>((e,{file:a})=>{const t=b(),l=new FormData;return l.append("file",a.file),R(t,l).then((a=>{200===a.code&&x.value[e].value.push(a.data)})),!1})(v,...e)},{default:f((()=>r[0]||(r[0]=[t("i",{class:"bi bi-plus"},null,-1)]))),_:2},1032,["onBeforeUpload"])])])):o("",!0),"map"===d.code?(n(),u(_(w),{key:3,class:"inline",modelValue:d.value,"onUpdate:modelValue":e=>d.value=e},null,8,["modelValue","onUpdate:modelValue"])):o("",!0),"list"===d.code?(n(),u(_(w),{key:4,list:!0,class:"inline",modelValue:d.value,"onUpdate:modelValue":e=>d.value=e},null,8,["modelValue","onUpdate:modelValue"])):o("",!0)],2)])))),128)),t("div",{class:i(["add-area",{list:e.list,unlist:!e.list}])},[t("label",{onClick:j},"+")],2)])])}}},[["__scopeId","data-v-477d4a69"]]),ce=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),pe={class:"model-selected-title"},ve={class:"model-selected-title-text"},me={key:0,class:"other-data-area"},ye={key:1,class:"selected-data-area"},fe={class:"card-tags"},ge=S({__name:"modelSelected",props:{type:{},data:{default:()=>[]}},setup(d,{expose:u}){const{publicStore:c}=O(),p=e(c,"isCarryOut"),_=d,k=r(null),b=r(null),h=r(0),x={prompts:"动态",statics:"静态",texts:"文字",colors:"调色板",designs:"设计理念"},D={prompts:["resource_id","preview","resource_name","description","keywords","trigger","server_type"],statics:["resource_id","preview","resource_name","description","keywords","cloud_folder"],texts:["resource_id","preview","resource_name","description","keywords","cloud_folder"],colors:["resource_id","preview","resource_name","description","keywords","colors"]},j=r(_.data[0]?_.data[0].value:[]),S=()=>{k.value.init()},A=e=>{C(e.resource_id).then((e=>{if(200===e.code)if("designs"===_.type){const a=Object.assign({data:e.data},e.info);j.value.push(a)}else{const a=Object.assign(e.data,e.info);j.value.push(a)}}))},R=e=>{const a={};return D[_.type]?(D[_.type].forEach((t=>{a[t]=e[t]})),a):e.data?Object.assign(e.data,{resource_id:e.resource_id,preview:e.preview}):{resource_id:e.resource_id,preview:e.preview}};return u({getSaveData:()=>({role:"database",type:`${x[_.type]}资源参考`,content:[{type:"json",value:j.value.map((e=>R(e)))}]})}),(e,r)=>{const u=v("n-scrollbar"),c=v("n-image"),_=v("n-tag"),D=v("n-space");return n(),a("div",{class:i(["model-selected-body",{expand:!p.value}])},[t("div",pe,[t("div",ve," 选择"+m(x[d.type])+"资源 ",1)]),1===h.value?(n(),a("div",me,[y(u,{onWheel:r[0]||(r[0]=w((()=>{}),["stop"]))},{default:f((()=>[y(ie,{ref_key:"jsonEditorRef",ref:b},null,512)])),_:1})])):o("",!0),0===h.value?(n(),a("div",ye,[(n(!0),a(l,null,s(j.value,(e=>(n(),a("div",{class:"card",key:e.resource_id},[y(c,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),t("div",fe,[y(D,null,{default:f((()=>[y(_,{bordered:!1},{default:f((()=>r[1]||(r[1]=[g(" 家纺平面设计 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>r[2]||(r[2]=[g(" 卡通风格和可爱ins风 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>r[3]||(r[3]=[g(" 奶牛 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>r[4]||(r[4]=[g(" 胡萝卜 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>r[5]||(r[5]=[g(" 樱桃 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>r[6]||(r[6]=[g(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),j.value.length<3?(n(),a("div",{key:0,class:"card",onClick:S},r[7]||(r[7]=[t("i",{class:"bi bi-plus"},null,-1)]))):o("",!0)])):o("",!0),y(le,{type:d.type,ref_key:"modelSelectedDialogRef",ref:k,onSetData:A},null,8,["type"])],2)}}},[["__scopeId","data-v-1e509e85"]]),_e={class:"other-data-area"},ke=S({__name:"generateDemandAnalysis",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:o}=O(),d=e(o,"isCarryOut"),u=l;r(null);const c=r(null);r(0),r([]);return h((()=>{u.data&&u.data[0]&&(data.value=c.value.init(u.data[0].value))})),s({getSaveData:()=>({role:"system",type:"需求分析",content:[{type:"json",value:[c.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return n(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 生成需求分析 ")],-1)),t("div",_e,[y(s,{onWheel:l[0]||(l[0]=w((()=>{}),["stop"]))},{default:f((()=>[y(ie,{ref_key:"jsonEditorRef",ref:c},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-b7860791"]]),be={class:"other-data-area"},we=S({__name:"generateText",setup(l){const{publicStore:s}=O(),o=e(s,"isCarryOut");return(e,l)=>{const s=v("n-input");return n(),a("div",{class:i(["model-selected-body",{expand:!o.value}])},[l[0]||(l[0]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 生成文本段落 ")],-1)),t("div",be,[y(s,{type:"textarea",placeholder:"请输入文本段落",style:{height:"100%"},resize:"none"})])],2)}}},[["__scopeId","data-v-5c1fa973"]]),he=S({__name:"artworkSelectedDialog",props:["type"],emits:["setData"],setup(t,{expose:l,emit:s}){const{publicStore:d}=O(),p=s,v=e(d,"isCarryOut"),m=r(!1),y=e=>{p("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(e,l)=>(n(),u(c,{to:"body"},[m.value?(n(),a("div",{key:0,class:i(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(n(),u(L,{key:0,componentType:"component",type:t.type,onSetData:y},null,8,["type"])):o("",!0)],2)):o("",!0)]))}},[["__scopeId","data-v-05088086"]]),xe={key:0,class:"selected-data-area"},De={class:"card-tags"},je={key:1,class:"selected-data-area"},Se=S({__name:"artWorkSelected",props:{type:{},data:{default:()=>[]}},setup(d,{expose:c}){b();const{publicStore:p}=O(),m=e(p,"isCarryOut"),_=d,k=r(null);r(null);const w=r(_.data[0]&&"generateArtWork"===_.type?1:0),h=r(_.data[0]?_.data[0].value:[]),j=r(_.data[0]?_.data[0].value:[]),S=x(),A=r([]),R=r([]),T=r([]),W=r([]),I=r({template_filter:"nomal",template_level:"nomal",points:1}),V=r(!1),C=r(null),L=r({canvasData:{name:S.query.file_name||"",width:2048,height:2048}}),J=r({groups:{},layers:{},elements:{}}),Y=r(!1),z=e=>new Promise((a=>{E(e).then((e=>{L.value=Object.assign(L.value,e.data.viewData),L.value.canvasData.name=e.info.artwork_name,J.value=e.data.layerData,I.value=e.info,Y.value=!0,a()}))})),$=e=>{Promise.all([new Promise((e=>{P("colors").then((a=>{T.value=a.data,e()}))})),new Promise((e=>{P("texts").then((a=>{W.value=a.data,e()}))})),new Promise((e=>{P("prompts").then((a=>{A.value=a.data,e()}))})),new Promise((e=>{P("statics").then((a=>{R.value=a.data,e()}))})),z(e)]).then((()=>{V.value=!0}))},B=()=>{k.value.init()},F=e=>{h.value.push(e),"generateArtWork"===_.type&&(C.value=e.artwork_id,w.value=1,Y.value=!1,G())},G=async(e=C.value)=>{Y.value||(w.value||"generateArtWork"===_.type)&&(N(),j.value.length?(Y.value=!0,D((()=>{j.value.forEach((async e=>{await U(e)}))}))):e?$(e):Y.value=!0)};return c({hideView:()=>{if("generateArtWork"===_.type){if(!Y.value)return;Y.value=!1,j.value.length<q.length&&(j.value=JSON.parse(JSON.stringify(q))),j.value.length&&N()}else"selectedArtWork"===_.type&&(Y.value=!1)},initView:G,getSaveData:()=>"generateArtWork"===_.type?(w.value&&Y.value&&(j.value=JSON.parse(JSON.stringify(q))),{role:"system",type:"生成操作链",content:[{type:"json",value:j.value}]}):"selectedArtWork"===_.type?{role:"system",type:"作品资源参考",content:[{type:"json",value:h.value}]}:void 0}),(e,d)=>{const r=v("n-image"),c=v("n-tag"),p=v("n-space");return n(),a("div",{class:i(["model-selected-body",{expand:!m.value}])},[d[7]||(d[7]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"},"生成作品资源")],-1)),0===w.value?(n(),a("div",xe,[(n(!0),a(l,null,s(h.value,(e=>(n(),a("div",{class:"card",key:e.artwork_id},[y(r,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),t("div",De,[y(p,null,{default:f((()=>[y(c,{bordered:!1},{default:f((()=>d[0]||(d[0]=[g(" 家纺平面设计 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[1]||(d[1]=[g(" 卡通风格和可爱ins风 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[2]||(d[2]=[g(" 奶牛 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[3]||(d[3]=[g(" 胡萝卜 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[4]||(d[4]=[g(" 樱桃 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[5]||(d[5]=[g(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),t("div",{class:"card",onClick:B},d[6]||(d[6]=[t("i",{class:"bi bi-plus"},null,-1)]))])):o("",!0),1===w.value?(n(),a("div",je,[Y.value?(n(),u(M,{key:0,colorsList:T.value,textsList:W.value,editorType:"generate",promptsList:A.value,staticsList:R.value,setting:L.value,layerData:J.value,templateId:C.value,info:I.value,needOpInput:!1,needTaskList:!1,needDelete:!1},null,8,["colorsList","textsList","promptsList","staticsList","setting","layerData","templateId","info"])):o("",!0)])):o("",!0),y(he,{ref_key:"artworkSelectedDialogRef",ref:k,onSetData:F},null,512)],2)}}},[["__scopeId","data-v-5398b95f"]]),Ae={class:"other-data-area"},Re=S({__name:"referenceResource",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:o}=O(),d=e(o,"isCarryOut"),u=l,c=r([]);r(null);const p=r(null);r(0),r([]);return h((()=>{u.data&&u.data[0]&&(c.value=p.value.init(u.data[0].value))})),s({getSaveData:()=>({role:"system",type:"参考资源分析",content:[{type:"json",value:[p.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return n(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 参考资源分析 ")],-1)),t("div",Ae,[y(s,{onWheel:l[0]||(l[0]=w((()=>{}),["stop"]))},{default:f((()=>[y(ie,{ref_key:"jsonEditorRef",ref:p},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-606af7f2"]]),Te={key:0,class:"set-data-area"},We={key:1,class:"init-area"},Oe=["onClick"],Ie={class:"init-card-info"},Ve={class:"icon"},Ce={class:"name"},Pe={class:"content"},Ee={class:"type"},Le=S({__name:"pageItem",props:{count:{type:Number,default:0},now:{type:Number,default:0},data:{}},setup(c,{expose:p}){const v={input:"搜索资源",output:"生成结果"},y=c,f=r(null),g=r(null),_={selectedModelRef:r(null),generateDemandAnalysisRef:r(null),referenceResourceRef:r(null),generateTextRef:r(null),generateArtWorkRef:r(null),selectedArtWorkRef:r(null)},k=e(y,"count"),b=e(y,"now"),w=e(y,"data"),x=["动态资源参考","静态资源参考","文字资源参考","调色板资源参考","设计理念资源参考","作品资源参考","参考资源分析","需求分析","生成操作链"],j=[{name:"选择动态资源",content:"选择可参考的动态资源",icon:J,cardType:"input",code:"selectedModel",type:"prompts"},{name:"选择静态资源",content:"选择可参考的静态资源",icon:Y,cardType:"input",code:"selectedModel",type:"statics"},{name:"选择文字资源",content:"选择可参考的文字资源",icon:z,cardType:"input",code:"selectedModel",type:"texts"},{name:"选择调色板",content:"合理且舒适的颜色搭配",icon:$,cardType:"input",code:"selectedModel",type:"colors"},{name:"选择设计理念",content:"无数种设计思想的集合",icon:B,cardType:"input",code:"selectedModel",type:"designs"},{name:"选择作品资源",content:"选择用户需要的作品资源",icon:F,cardType:"input",code:"selectedArtWork",type:"prompts"},{name:"参考资源分析",content:"生成用户需求的参考分析",icon:G,cardType:"output",code:"referenceResource",type:""},{name:"生成需求分析",content:"生成用户需求的模板分析",icon:G,cardType:"output",code:"generateDemandAnalysis",type:""},{name:"生成作品资源",content:"生成用户需要的模板资源",icon:F,cardType:"output",code:"generateArtWork",type:"designs"}],S=(e=k.value)=>e===b.value+1?("generateArtWork"===f.value&&(_.generateArtWorkRef.value?_.generateArtWorkRef.value.initView():D((()=>{_.generateArtWorkRef.value.initView()}))),{top:"0rem",zIndex:1}):("generateArtWork"===f.value&&(_.generateArtWorkRef.value?_.generateArtWorkRef.value.hideView():D((()=>{_.generateArtWorkRef.value.hideView()}))),{display:"none"});return h((()=>{if(w.value.type){const e=x.findIndex((e=>e===w.value.type));f.value=j[e].code,g.value=j[e].type}})),p({getSaveData:()=>f.value?_[`${f.value}Ref`].value.getSaveData():null}),(e,r)=>(n(),a("div",{class:"page-item-body",style:d(S())},[null!==f.value?(n(),a("div",Te,["selectedModel"===f.value?(n(),u(ge,{key:0,type:g.value,data:w.value.content,ref:_.selectedModelRef},null,8,["type","data"])):o("",!0),"generateDemandAnalysis"===f.value?(n(),u(ke,{key:1,data:w.value.content,ref:_.generateDemandAnalysisRef},null,8,["data"])):o("",!0),"referenceResource"===f.value?(n(),u(Re,{key:2,data:w.value.content,ref:_.referenceResourceRef},null,8,["data"])):o("",!0),"generateText"===f.value?(n(),u(we,{key:3,data:w.value.content,ref:_.generateTextRef},null,8,["data"])):o("",!0),"selectedArtWork"===f.value||"generateArtWork"===f.value?(n(),u(Se,{key:4,data:w.value.content,type:f.value,ref:_[`${f.value}Ref`]},null,8,["data","type"])):o("",!0)])):o("",!0),null===f.value?(n(),a("div",We,[(n(),a(l,null,s(j,((e,a)=>t("div",{class:"init-card",key:a,onClick:a=>(({code:e,type:a})=>{f.value=e,g.value=a})(e)},[t("div",Ie,[t("div",Ve,[t("i",{class:i(["bi",e.icon])},null,2)]),t("div",Ce,m(e.name),1),t("div",Pe,m(e.content),1),t("div",Ee,m(v[e.cardType]),1)])],8,Oe))),64))])):o("",!0)],4))}},[["__scopeId","data-v-2de6aacf"]]),Me={class:"page-ouoter-body"},Ne=S({__name:"pageOuter",props:{count:{type:Number,default:0},now:{type:Number,default:0},pageData:{type:Array,default:()=>[]}},setup(t,{expose:o}){const d=t,i=r(null);o({getSaveData:()=>{const e=[];return i.value.forEach((a=>{const t=a.getSaveData();t&&e.push(t)})),e}});const c=e(d,"pageData");e(d,"count");const p=e(d,"now");return(e,t)=>(n(),a("div",Me,[(n(!0),a(l,null,s(c.value,((e,a)=>(n(),u(Le,{ref_for:!0,ref_key:"page",ref:i,data:e,key:e.uuid,count:a+1,now:p.value},null,8,["data","count","now"])))),128))]))}},[["__scopeId","data-v-6b49b489"]]),Ue={class:"page-count"},qe={class:"data-warehouse-editor"},Je={class:"data-warehouse-editor-input-box"},Ye={class:"logo-area"},ze=["src"],$e={class:"data-warehouse-editor-input-area"},Be={class:"data-warehouse-editor-view"},Fe=S({__name:"index",setup(l){const s=j(),o=x(),d=e(o.query,"id"),u=r(o.query.type),i=r(0),c=r(null),p=r(null),m=r([]),k=r(!1),D=e=>{if(!k.value){if(k.value=!0,setTimeout((()=>{k.value=!1}),200),e.deltaY<0){if(i.value-1<0)return;i.value--}else if(e.deltaY>0){if(i.value+1>m.value.length-1)return;i.value++}e.stopPropagation()}},S=()=>{m.value.push({}),i.value=m.value.length-1},R=()=>{const e=p.value.getSaveData(),a=X(e,String((new Date).getTime())),t=new FormData;t.append("file",a),d.value||0===d.value?K({data_id:d.value,data_type:u.value,data_status:"进行中",formData:t}).then((e=>{200===e.code&&s.success("更新成功")})):Q({data_type:u.value,data_status:"进行中",formData:t}).then((e=>{200===e.code&&(d.value=e.data.data_id,s.success("保存成功"))}))};return h((()=>{window.loading||(window.loading=A()),d.value?H({data_id:d.value}).then((e=>{200===e.code&&(m.value=e.data.map((e=>(e.uuid=b(),e))))})):m.value=[{}],setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300)})),(e,l)=>{const s=v("n-button");return n(),a("div",{class:"data-warehouse-editor-body",onWheel:w(D,["stop"]),tabindex:"0"},[t("div",Ue,[y(te,{pageData:m.value,now:i.value,onAddPage:S},null,8,["pageData","now"])]),t("div",qe,[t("div",Je,[t("div",Ye,[t("img",{src:_(W)},null,8,ze),l[0]||(l[0]=t("label",null,"Oplus",-1))]),t("div",$e,[y(T,{style:{"box-shadow":"var(--op-thr-shadow)"},ref_key:"opInputRef",ref:c},null,512)]),y(s,{class:"save-btn",size:"large",onClick:R},{default:f((()=>l[1]||(l[1]=[g("保存数据")]))),_:1})]),l[2]||(l[2]=t("div",{class:"message"}," 参考其他的设计作品，查看是否有喜欢的风格布局或者元素，把它加入你的设计理念中！ ",-1)),t("div",Be,[y(Ne,{now:i.value,pageData:m.value,ref_key:"pageOuterRef",ref:p},null,8,["now","pageData"])])])],32)}}},[["__scopeId","data-v-7c41aa8d"]]);export{Fe as default};
