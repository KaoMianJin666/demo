import{r as e,o as a,c as t,u as l,a as s,b as i,d as n,e as o,f as d,g as r,h as c,w as u,F as h,i as m,j as v,t as g,k as p,p as f,l as w,m as y,E as b,n as k,q as x,s as D,v as C,x as A,y as _,z as I,A as L,B as V,C as M,D as S,G as E,H as P,I as R,J as T,K as Y,L as F,M as U,N as X,O,P as Z,Q as W,R as z,S as N,T as j,U as $,V as H,W as G,X as B,Y as Q,Z as q,_ as J,$ as K}from"./lib.899ba6e3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?a.credentials="include":"anonymous"===e.crossorigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();var ee=(e,a)=>{const t=e.__vccOpts||e;for(const[l,s]of a)t[l]=s;return t};var ae=ee({},[["render",function(l,s){const i=e("RouterView");return a(),t(i,{id:"main-view"})}]]);const te=e=>(f("data-v-df5e462e"),e=e(),w(),e),le={class:"nav-bar-body"},se={class:"logo-area"},ie=["src"],ne={class:"router-link-area"},oe={width:"14",style:{"margin-right":"10px"},height:"15",viewBox:"0 0 14 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},de=[te((()=>d("path",{d:"M1 6.36368L7 1.45459L13 6.36368V14H1V6.36368Z",stroke:"white","stroke-width":"1.2"},null,-1))),te((()=>d("path",{d:"M4.82031 10.7272C4.82031 9.52224 5.79715 8.54541 7.00213 8.54541V8.54541C8.20712 8.54541 9.18395 9.52224 9.18395 10.7272V14H4.82031V10.7272Z",stroke:"white","stroke-width":"1.2"},null,-1)))],re={width:"14",style:{"margin-right":"10px"},height:"15",viewBox:"0 0 14 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ce=[te((()=>d("path",{d:"M1 6.36368L7 1.45459L13 6.36368V14H1V6.36368Z",stroke:"white","stroke-width":"1.2"},null,-1))),te((()=>d("path",{d:"M4.82031 10.7272C4.82031 9.52224 5.79715 8.54541 7.00213 8.54541V8.54541C8.20712 8.54541 9.18395 9.52224 9.18395 10.7272V14H4.82031V10.7272Z",stroke:"white","stroke-width":"1.2"},null,-1)))],ue={width:"14",style:{"margin-right":"10px"},height:"15",viewBox:"0 0 14 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},he=[te((()=>d("path",{d:"M1 6.36368L7 1.45459L13 6.36368V14H1V6.36368Z",stroke:"white","stroke-width":"1.2"},null,-1))),te((()=>d("path",{d:"M4.82031 10.7272C4.82031 9.52224 5.79715 8.54541 7.00213 8.54541V8.54541C8.20712 8.54541 9.18395 9.52224 9.18395 10.7272V14H4.82031V10.7272Z",stroke:"white","stroke-width":"1.2"},null,-1)))],me=te((()=>d("div",{class:"user-phone-no"},"188 8888 8888",-1))),ve=te((()=>d("div",{class:"line"},null,-1))),ge=te((()=>d("div",{class:"logout-btn"},[d("span",null,"退出")],-1)));var pe=ee({__name:"navBar",setup(f){const w=l(),y=s(),b=[{name:"图生图",path:"ImageGenerationImage"},{name:"AI换脸",path:"swapFace"},{name:"AI换背景",path:"partialModifications"},{name:"识图",path:"imageSearch",children:[{name:"AI识图",path:"imageSearch"},{name:"图库",path:"gallery"},{name:"超级识图",path:"superImageSearch"},{name:"激活码管理",path:"activationKeys"}]},{name:"识图训练",path:"imageSearchTrain",children:[{name:"数据集",path:"imageSearchTrainDataset"},{name:"训练",path:"imageSearchTrain"},{name:"测试",path:"imageSearchTrainCheck"}]},{name:"模型训练",path:"trainModel"}];let k=i("ImageGenerationImage");const x=e=>{w.push(e)};return n((()=>{k.value=y.name})),(l,s)=>{const i=e("el-menu-item"),n=e("el-sub-menu"),f=e("el-menu");return a(),o("div",le,[d("div",se,[d("img",{src:r("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVQAAABSCAYAAAALvCwcAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MThBRjRERjM3Q0I5MTFFRTlDQ0FEMTY4RDhCNTg0RkYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MThBRjRERjQ3Q0I5MTFFRTlDQ0FEMTY4RDhCNTg0RkYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxOEFGNERGMTdDQjkxMUVFOUNDQUQxNjhEOEI1ODRGRiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxOEFGNERGMjdDQjkxMUVFOUNDQUQxNjhEOEI1ODRGRiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgnCosYAAA7KSURBVHja7F3t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")},null,8,ie)]),d("div",ne,[c(f,{"background-color":"#22335D","text-color":"#ffffff","default-active":r(k),class:"el-menu-demo",mode:"horizontal",onSelect:x},{default:u((()=>[(a(),o(h,null,m(b,((e,l)=>(a(),o(h,{key:l},[e.children?p("",!0):(a(),t(i,{key:0,index:e.path},{default:u((()=>[(a(),o("svg",oe,de)),v(" "+g(e.name),1)])),_:2},1032,["index"])),e.children?(a(),t(n,{key:1,index:String(l)},{title:u((()=>[(a(),o("svg",re,ce)),v(" "+g(e.name),1)])),default:u((()=>[(a(!0),o(h,null,m(e.children,(e=>(a(),t(i,{index:e.path,key:e.path},{default:u((()=>[(a(),o("svg",ue,he)),v(" "+g(e.name),1)])),_:2},1032,["index"])))),128))])),_:2},1032,["index"])):p("",!0)],64)))),64))])),_:1},8,["default-active"])]),d("div",{class:"handle-area"},[me,ve,d("div",{class:"user-profile-image"},[d("img",{src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"})]),ge])])}}},[["__scopeId","data-v-df5e462e"]]);const fe={class:"home-body"},we={class:"home-child-view"};var ye=ee({__name:"index",setup:t=>(t,l)=>{const s=e("router-view");return a(),o("div",fe,[c(pe),d("div",we,[c(s)])])}},[["__scopeId","data-v-f24c8a92"]]);const be=e=>(f("data-v-621e1b82"),e=e(),w(),e),ke={class:"main-body"},xe={class:"image-area"},De=be((()=>d("div",{class:"main-title"},"参考图",-1))),Ce={class:"image-all"},Ae={class:"image-item upload-image-area"},_e={class:"upload-text-tips"},Ie=be((()=>d("div",{class:"upload-text"},"点击上传",-1))),Le={class:"other-images"},Ve={class:"other-images-view-box"},Me={class:"del-btn"},Se={class:"image-handl-area"},Ee=be((()=>d("label",null,"权重",-1))),Pe=be((()=>d("div",{class:"main-title"},null,-1))),Re={class:"bottom-area"},Te={class:"handle-area"},Ye=be((()=>d("div",{class:"main-title"},"正向提示词",-1))),Fe={class:"handle-item"},Ue=be((()=>d("div",{class:"main-title"},"负向提示词",-1))),Xe={class:"handle-item"},Oe={class:"handle-item"},Ze={class:"handle-min"},We=be((()=>d("div",{class:"main-title"},"风格",-1))),ze={class:"handle-min"},Ne=be((()=>d("div",{class:"main-title"},"相似度",-1))),je={class:"handle-min-slider"},$e={class:"handle-min"},He=be((()=>d("div",{class:"main-title"},"宽度",-1))),Ge={class:"handle-min"},Be=be((()=>d("div",{class:"main-title"},"高度",-1))),Qe=be((()=>d("div",{class:"main-title"},"线稿参考图",-1))),qe={class:"handle-item bg"},Je={class:"line-draft-image-area"},Ke={class:"upload-image-area-other"},ea=["src"],aa={key:1,class:"upload-text-tips"},ta=be((()=>d("div",{class:"upload-text"},"点击上传",-1))),la={class:"image-handl-area"},sa=be((()=>d("label",null,"权重",-1))),ia={class:"generate-btn"},na={class:"review-area"},oa="https://u248120-87de-6175a03c.westc.gpuhub.com:8443";var da=ee({__name:"index",setup(l){const s=i([]),g=i(null),f=i(null),w=i([]),_=i(null),I=i(70),L=i(""),V=i(""),M=i(1024),S=i(1024),E=i(70),P=i(""),R=e=>{const a=new FileReader;return a.onload=({target:a})=>{s.value.length>=5||s.value.push({file:e,url:a.result,weight:100})},a.readAsDataURL(e),!1},T=e=>{g.value=e;const a=new FileReader;return a.onload=({target:e})=>{f.value=e.result},a.readAsDataURL(e),!1},Y=()=>{g.value=null,f.value=null},F=()=>{if(!s.value.length)return b.error("请至少上传一张参考图"),!1;if(!_.value)return b.error("请选择风格后操作"),!1;const e=(()=>{const e=new FormData;return e.append("base_model",_.value),g.value&&(e.append("lineart",g.value||""),e.append("lineart_weight",I.value/100)),e.append("positive_prompt",L.value),e.append("negative_prompt",V.value),e.append("ref",E.value/100),e.append("width",M.value),e.append("height",S.value),s.value.forEach((({weight:a,file:t})=>{e.append("weights",a/100),e.append("files",t)})),e})(),a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});y.post(`${oa}/img2img/gen`,e).then((e=>{a.close(),P.value=`${oa}/img2img/${e.data}`})).catch((e=>{a.close(),e.response&&413===e.response.status&&b.error("上传图片过大, 请减少图片数量或者大小")}))};return n((()=>{y.get(`${oa}/img2img/base_models`).then((e=>{Object.keys(e.data).forEach((a=>{w.value.push({name:a,value:e.data[a]})}))}))})),(l,i)=>{const n=e("el-icon"),g=e("el-upload"),y=e("el-image"),b=e("el-slider"),k=e("el-scrollbar"),U=e("el-input"),X=e("el-option"),O=e("el-select"),Z=e("el-input-number"),W=e("el-button");return a(),o("div",ke,[d("div",xe,[De,d("div",Ce,[d("div",Ae,[c(g,{class:"avatar-uploader",drag:"",multiple:"",limit:5,disabled:s.value.length>=5,action:"","show-file-list":!1,"before-upload":R},{default:u((()=>[d("div",_e,[c(n,{class:"avatar-uploader-icon"},{default:u((()=>[c(r(D))])),_:1}),Ie])])),_:1},8,["disabled"])]),d("div",Le,[c(k,null,{default:u((()=>[d("div",Ve,[(a(!0),o(h,null,m(s.value,((e,t)=>(a(),o("div",{class:"image-item",key:t},[c(y,{style:{width:"150px",height:"150px"},src:e.url},null,8,["src"]),d("div",Me,[c(n,{style:{color:"red"},onClick:e=>(e=>{s.value.splice(e,1)})(t)},{default:u((()=>[c(r(C))])),_:2},1032,["onClick"])]),d("div",Se,[Ee,c(b,{modelValue:e.weight,"onUpdate:modelValue":a=>e.weight=a,style:{width:"calc(100% - 50px)"},min:0,max:100,size:"small"},null,8,["modelValue","onUpdate:modelValue"])])])))),128))])])),_:1})])])]),Pe,d("div",Re,[d("div",Te,[c(k,null,{default:u((()=>[Ye,d("div",Fe,[c(U,{type:"textarea",modelValue:L.value,"onUpdate:modelValue":i[0]||(i[0]=e=>L.value=e),maxlength:"255"},null,8,["modelValue"])]),Ue,d("div",Xe,[c(U,{type:"textarea",modelValue:V.value,"onUpdate:modelValue":i[1]||(i[1]=e=>V.value=e),maxlength:"255"},null,8,["modelValue"])]),d("div",Oe,[d("div",Ze,[We,c(O,{modelValue:_.value,"onUpdate:modelValue":i[2]||(i[2]=e=>_.value=e)},{default:u((()=>[(a(!0),o(h,null,m(w.value,(e=>(a(),t(X,{key:e.name,value:e.value,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])]),d("div",ze,[Ne,d("div",je,[c(b,{modelValue:E.value,"onUpdate:modelValue":i[3]||(i[3]=e=>E.value=e)},null,8,["modelValue"])])]),d("div",$e,[He,c(Z,{style:{width:"100%"},modelValue:M.value,"onUpdate:modelValue":i[4]||(i[4]=e=>M.value=e),controls:!1,min:1,max:2048},null,8,["modelValue"])]),d("div",Ge,[Be,c(Z,{style:{width:"100%"},modelValue:S.value,"onUpdate:modelValue":i[5]||(i[5]=e=>S.value=e),controls:!1,min:1,max:2048},null,8,["modelValue"])])]),Qe,d("div",qe,[d("div",Je,[d("div",Ke,[c(g,{class:"avatar-uploader",drag:"",action:"","show-file-list":!1,"before-upload":T},{default:u((()=>[f.value?(a(),o("div",{key:0,class:"upload-image-del-area",onClick:i[7]||(i[7]=x((()=>{}),["stop"]))},[d("img",{src:f.value,class:"avatar"},null,8,ea),d("div",{class:"upload-image-del-btn-area",onClick:i[6]||(i[6]=x((()=>{}),["stop"]))},[d("div",{class:"upload-image-del-btn",onClick:x(Y,["stop"])},[c(n,null,{default:u((()=>[c(r(A))])),_:1})])])])):(a(),o("div",aa,[c(n,{class:"avatar-uploader-icon"},{default:u((()=>[c(r(D))])),_:1}),ta]))])),_:1})]),d("div",la,[sa,c(b,{style:{width:"calc(100% - 50px)"},disabled:!f.value,modelValue:I.value,"onUpdate:modelValue":i[8]||(i[8]=e=>I.value=e),min:0,max:100,size:"small"},null,8,["disabled","modelValue"])])])])])),_:1}),d("div",ia,[c(W,{style:{width:"100%"},type:"primary",onClick:i[9]||(i[9]=e=>F())},{default:u((()=>[v("生成")])),_:1})])]),d("div",na,[P.value?(a(),t(y,{key:0,fit:"scale-down",src:P.value,"preview-src-list":[P.value],style:{width:"100%",height:"100%"}},null,8,["src","preview-src-list"])):p("",!0)])])])}}},[["__scopeId","data-v-621e1b82"]]);function ra(e){const a=e.split(","),t=a[0].match(/:(.*?);/)[1],l=atob(a[1]);let s=l.length;const i=new Uint8Array(s);for(;s--;)i[s]=l.charCodeAt(s);return new Blob([i],{type:t})}class ca{constructor(e){this.canvasDom=e,this.ctx=e.getContext("2d"),this.canvasDom.width=this.canvasDom.offsetWidth,this.canvasDom.height=this.canvasDom.offsetHeight,this.handleList=[],this.imageData={image:null,x:0,y:0,height:0,width:0},this.isMoving=!1,this.clearSetting={radius:10},this.listeners={},window.addEventListener("resize",(()=>{this.canvasDom.width=this.canvasDom.offsetWidth,this.canvasDom.height=this.canvasDom.offsetHeight,this.clearSelectionArea(),this.initImage(this.imageData.image.src)}))}handleChange(e,a){const{canvasDom:t}=this;switch(this.clearHandle(),e){case"selectionArea":t.style.cursor="crosshair",this.addListener(t,"mousedown",(e=>{this.selectionAreaStart(e)})),this.addListener(t,"mouseup",(e=>{this.selectionAreaFinish(e)})),this.addListener(t,"mousemove",(e=>{this.selectionAreaMoving(e)}));break;case"clearArea":t.style.cursor="none",this.addListener(t,"mousedown",(e=>{this.clearAreaStart(e,a)})),this.addListener(t,"mouseup",(e=>{this.clearAreaFinish(e,a)})),this.addListener(t,"mousemove",(e=>{this.clearAreaMoving(e,a)}));break;default:this.clearHandle()}}clearAreaStart(e,a){const{offsetX:t,offsetY:l}=e,{clearSetting:s}=this,{radius:i}=s;this.handleList.find((e=>"clearArea"===e.type))?(this.handleList.find((e=>"clearArea"===e.type)).status=0,this.handleList.find((e=>"clearArea"===e.type)).imageData=null):this.handleList.push({dataList:[],radius:i,handleX:t,handleY:l,type:"clearArea",clearType:a,status:0,imageData:null})}clearAreaMouseStyle(e){const{offsetX:a,offsetY:t}=e,{ctx:l,clearSetting:s}=this,{radius:i}=s;l.beginPath(),l.arc(a,t,i,0,2*Math.PI),l.stroke(),l.closePath()}clearAreaMoving(e){const{offsetX:a,offsetY:t}=e,{clearSetting:l}=this,{radius:s}=l;this.handleList.find((e=>"clearArea"===e.type))&&0===this.handleList.find((e=>"clearArea"===e.type)).status&&this.handleList.find((e=>"clearArea"===e.type)).dataList.push({offsetX:a,offsetY:t,radius:s}),this.reDraw(),this.clearAreaMouseStyle(e)}clearAreaFinish(e){this.handleList.find((e=>"clearArea"===e.type))&&(this.handleList.find((e=>"clearArea"===e.type)).status=1),this.reDraw()}selectionAreaStart(e){const{offsetX:a,offsetY:t}=e;this.handleList.push({handleX:a,handleY:t,type:"selectionArea",status:0,imageData:null})}selectionAreaMoving(e){const{offsetX:a,offsetY:t}=e;this.handleList.length&&0===this.handleList[this.handleList.length-1].status&&(this.handleList[this.handleList.length-1].offsetX=a,this.handleList[this.handleList.length-1].offsetY=t,this.reDraw())}selectionAreaFinish(){this.handleList[this.handleList.length-1].status=1,this.reDraw()}clearHandle(){this.canvasDom.style.cursor="auto",this.removeAllListeners()}initImage(e){const{ctx:a,canvasDom:t}=this,{width:l,height:s}=t;this.handleList=[],a.beginPath(),a.clearRect(0,0,l,s),a.closePath();const i=new Image;i.src=e,i.onload=()=>{this.initImageData(i),this.drawImage()}}initImageData(e){const{canvasDom:a}=this,{width:t,height:l}=a,s=e.width,i=e.height,n={image:e,x:0,y:0,height:0,width:0};if(i>l||s>t)if(i/l>s/t){const e=l/i;n.height=l,n.width=e*s,n.y=0,n.x=t/2-n.width/2}else{const e=t/s;n.width=t,n.height=e*i,n.x=0,n.y=l/2-n.height/2}else if(i>s){const e=l/t;n.height=l,n.width=l/e,n.y=0,n.x=t/2-n.width/2}else{const e=t/l;n.width=t,n.height=t/e,n.y=l/2-n.width/2,n.x=0}this.imageData=n}drawImage(){const{image:e,x:a,y:t,width:l,height:s}=this.imageData,{ctx:i}=this;e&&(i.beginPath(),i.drawImage(e,a,t,l,s),i.closePath())}reDraw(){const{ctx:e,canvasDom:a,imageData:t}=this,{image:l}=t,{width:s,height:i}=a;e.beginPath(),e.clearRect(0,0,s,i),e.closePath(),l&&(this.drawImage(),this.getSelecttionAreaImages(),this.handleList.forEach((a=>{let{type:t}=a;if("selectionArea"===t){let{handleX:t,handleY:l,offsetX:s,offsetY:i,status:n}=a;e.beginPath(),e.strokeStyle="rgba(255, 0, 0, 1)",e.lineWidth=2;const o=t>s?s:t,d=l>i?i:l,r=t>s?t-s:s-t,c=l>i?l-i:i-l;if((!r||!c)&&n)return;e.rect(o,d,r,c),e.stroke(),e.closePath()}if("clearArea"===t){let{clearType:t,dataList:l,offsetX:s,offsetY:i,radius:n}=a;"arc"==t&&(e.beginPath(),e.globalCompositeOperation="destination-out",e.moveTo(s+n,i+n),e.arc(s,i,n,0,2*Math.PI),l.forEach((a=>{e.moveTo(a.offsetX+a.radius,a.offsetY+a.radius),e.arc(a.offsetX,a.offsetY,a.radius,0,2*Math.PI)})),e.fill(),e.globalCompositeOperation="source-over",e.closePath())}})))}getSelecttionAreaImages(){const{image:e}=this.imageData;this.handleList.forEach(((a,t)=>{let{type:l}=a;if("selectionArea"===l){const{handleX:l,handleY:s,offsetX:i,offsetY:n,status:o,imageData:d}=a,r=this.canvasDom.width,c=this.canvasDom.height,u=this.imageData.width;this.imageData.height;const h=r===u?c/e.height:r/e.width;if(o&&!d){const o=document.createElement("canvas");o.width=r/h,o.height=c/h;const d=o.getContext("2d"),u=l>i?i:l,m=s>n?n:s,v=l>i?l-i:i-l,g=s>n?s-n:n-s;if(d.beginPath(),d.drawImage(e,this.imageData.x/h,this.imageData.y/h,this.imageData.width/h,this.imageData.height/h),d.clearRect(Math.round(u/h),Math.round(m/h),Math.round(v/h),Math.round(g/h)),d.closePath(),!v||!g)return;const p=d.getImageData(this.imageData.x/h,this.imageData.y/h,this.imageData.width/h,this.imageData.height/h),f=document.createElement("canvas");f.width=Math.round(this.imageData.width/h),f.height=Math.round(this.imageData.height/h);f.getContext("2d").putImageData(p,0,0);const w=ra(f.toDataURL("image/png"));a.imageData=new File([w],`${(new Date).getTime()}_${t}.png`,{type:"image/png"})}}if("clearArea"===l){const{clearType:l,dataList:s,offsetX:i,offsetY:n,radius:o,status:d,imageData:r}=a,c=this.canvasDom.width,u=this.canvasDom.height,h=this.imageData.width;this.imageData.height;const m=c===h?u/e.height:c/e.width;if(d&&!r&&"arc"==l){const l=document.createElement("canvas");l.width=c/m,l.height=u/m;const d=l.getContext("2d");d.beginPath(),d.drawImage(e,this.imageData.x/m,this.imageData.y/m,this.imageData.width/m,this.imageData.height/m),d.closePath(),d.beginPath(),d.globalCompositeOperation="destination-out",d.moveTo((i+o)/m,(n+o)/m),d.arc(i,n,o,0,2*Math.PI),s.forEach((e=>{d.moveTo((e.offsetX+e.radius)/m,(e.offsetY+e.radius)/m),d.arc(e.offsetX/m,e.offsetY/m,e.radius/m,0,2*Math.PI)})),d.fill(),d.globalCompositeOperation="source-over",d.closePath();const r=d.getImageData(this.imageData.x/m,this.imageData.y/m,this.imageData.width/m,this.imageData.height/m),h=document.createElement("canvas");h.width=Math.round(this.imageData.width/m),h.height=Math.round(this.imageData.height/m);h.getContext("2d").putImageData(r,0,0);const v=ra(h.toDataURL("image/png"));a.imageData=new File([v],`${(new Date).getTime()}_${t}.png`,{type:"image/png"})}}}))}addListener(e,a,t){e.addEventListener(a,t);var l=a+"_"+t.toString();this.listeners[l]={element:e,eventType:a,listener:t}}removeAllListeners(){for(var e in this.listeners){var a=this.listeners[e];a.element.removeEventListener(a.eventType,a.listener)}this.listeners={}}clearSelectionArea(){this.handleList=[],this.reDraw()}clearAll(){const{ctx:e,canvasDom:a}=this,{width:t,height:l}=a;e.beginPath(),e.clearRect(0,0,t,l),e.closePath()}setClearAreaRadius(e=10){this.clearSetting.radius=e}}const ua=e=>(f("data-v-061b6b3e"),e=e(),w(),e),ha={class:"main-body"},ma={class:"image-area"},va=ua((()=>d("div",{class:"main-title"},"模特照片",-1))),ga={class:"image-all"},pa={class:"image-item upload-image-area"},fa={class:"upload-text-tips"},wa=ua((()=>d("div",{class:"upload-text"},"点击上传",-1))),ya={class:"other-images"},ba={class:"other-images-view-box"},ka={class:"del-btn"},xa=ua((()=>d("div",{class:"main-title"},null,-1))),Da={class:"bottom-area"},Ca={class:"handle-area"},Aa=ua((()=>d("div",{class:"main-title"},"正向提示词",-1))),_a={class:"handle-item"},Ia=ua((()=>d("div",{class:"main-title"},"负向提示词",-1))),La={class:"handle-item"},Va=ua((()=>d("div",{class:"main-title"},"待换脸人像",-1))),Ma={class:"handle-item bg"},Sa={class:"line-draft-image-area"},Ea={class:"upload-image-area-other"},Pa=["src"],Ra={key:1,class:"upload-text-tips"},Ta=ua((()=>d("div",{class:"upload-text"},"点击上传",-1))),Ya={class:"image-handl-area"},Fa=ua((()=>d("label",null,"笔刷半径",-1))),Ua={class:"image-handl-area"},Xa=ua((()=>d("div",{class:"main-title"},"相似度",-1))),Oa={class:"handle-item"},Za={class:"handle-min-slider"},Wa={class:"generate-btn"},za={class:"review-area"},Na="https://u248120-87de-6175a03c.westc.gpuhub.com:8443";var ja=ee({__name:"index",setup(l){const s=i([]),g=i(null),f=i(null);i([]),i(null),i(70);const w=i(""),_=i("");i(1024),i(1024);const I=i(70),L=i(""),V=i(0),M=i(null),S=i(10),E=e=>{const a=new FileReader;return a.onload=({target:a})=>{s.value.length>=15||s.value.push({file:e,url:a.result,weight:100})},a.readAsDataURL(e),!1},P=e=>{g.value=e;const a=new FileReader;return a.onload=({target:e})=>{f.value=e.result,M.value.initImage(f.value)},a.readAsDataURL(e),!1},R=()=>{g.value=null,f.value=null},T=()=>{if(!s.value.length)return b.error("请至少上传一张模特照片"),!1;if(!g.value)return b.error("请上传待换脸人像后操作"),!1;if(!M.value.handleList.length)return b.error("款选人脸区域后操作"),!1;const e=(()=>{const e=new FormData;return e.append("positive_prompt",w.value),e.append("negative_prompt",_.value),e.append("mask_strength",I.value/100),s.value.forEach((({weight:a,file:t})=>{e.append("ref_faces",t)})),e.append("face",g.value),M.value.handleList.forEach((({imageData:a})=>{e.append("face_mask",a)})),e})(),a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});y.post(`${Na}/img2img/swap_face`,e).then((e=>{if(a.close(),"未检测到人脸，请扩大人脸选区区域！"===e.data)return b.error(e.data),!1;L.value=`${Na}/img2img/${e.data}`})).catch((e=>{a.close(),e.response&&413===e.response.status&&b.error("上传图片过大, 请减少图片数量或者大小")}))},Y=()=>{M.value.clearSelectionArea()},F=()=>{M.value.setClearAreaRadius(S.value)};return n((()=>{M.value=new ca(V.value),M.value.handleChange("clearArea","arc")})),(l,i)=>{const n=e("el-icon"),g=e("el-upload"),y=e("el-image"),b=e("el-scrollbar"),k=e("el-input"),M=e("el-slider"),U=e("el-button");return a(),o("div",ha,[d("div",ma,[va,d("div",ga,[d("div",pa,[c(g,{class:"avatar-uploader",drag:"",multiple:"",limit:15,disabled:s.value.length>=15,action:"","show-file-list":!1,"before-upload":E},{default:u((()=>[d("div",fa,[c(n,{class:"avatar-uploader-icon"},{default:u((()=>[c(r(D))])),_:1}),wa])])),_:1},8,["disabled"])]),d("div",ya,[c(b,null,{default:u((()=>[d("div",ba,[(a(!0),o(h,null,m(s.value,((e,t)=>(a(),o("div",{class:"image-item",key:t},[c(y,{style:{width:"150px",height:"150px"},src:e.url},null,8,["src"]),d("div",ka,[c(n,{style:{color:"red"},onClick:e=>(e=>{s.value.splice(e,1)})(t)},{default:u((()=>[c(r(C))])),_:2},1032,["onClick"])])])))),128))])])),_:1})])])]),xa,d("div",Da,[d("div",Ca,[c(b,null,{default:u((()=>[Aa,d("div",_a,[c(k,{type:"textarea",modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=e=>w.value=e),maxlength:"255"},null,8,["modelValue"])]),Ia,d("div",La,[c(k,{type:"textarea",modelValue:_.value,"onUpdate:modelValue":i[1]||(i[1]=e=>_.value=e),maxlength:"255"},null,8,["modelValue"])]),Va,d("div",Ma,[d("div",Sa,[d("div",Ea,[c(g,{class:"avatar-uploader",drag:"",action:"","show-file-list":!1,"before-upload":P},{default:u((()=>[f.value?(a(),o("div",{key:0,class:"upload-image-del-area",onClick:i[3]||(i[3]=x((()=>{}),["stop"]))},[d("img",{src:f.value,class:"avatar"},null,8,Pa),d("div",{class:"upload-image-del-btn-area",onClick:i[2]||(i[2]=x((()=>{}),["stop"]))},[d("div",{class:"upload-image-del-btn",onClick:x(R,["stop"])},[c(n,null,{default:u((()=>[c(r(A))])),_:1})])])])):(a(),o("div",Ra,[c(n,{class:"avatar-uploader-icon"},{default:u((()=>[c(r(D))])),_:1}),Ta]))])),_:1}),d("div",Ya,[Fa,c(M,{style:{width:"calc(100% - 50px)"},modelValue:S.value,"onUpdate:modelValue":i[4]||(i[4]=e=>S.value=e),onChange:F,min:1,max:100,size:"small"},null,8,["modelValue"])])]),d("div",Ua,[d("div",{class:"main-title"},[v(" 框选人脸区域 "),d("div",{class:"title-handle-area",onClick:Y}," 重置 ")]),d("canvas",{ref_key:"canvasDom",ref:V},null,512)])])]),Xa,d("div",Oa,[d("div",Za,[c(M,{modelValue:I.value,"onUpdate:modelValue":i[5]||(i[5]=e=>I.value=e)},null,8,["modelValue"])])])])),_:1}),d("div",Wa,[c(U,{style:{width:"100%"},type:"primary",onClick:i[6]||(i[6]=e=>T())},{default:u((()=>[v("生成")])),_:1})])]),d("div",za,[L.value?(a(),t(y,{key:0,fit:"scale-down",src:L.value,"preview-src-list":[L.value],style:{width:"100%",height:"100%"}},null,8,["src","preview-src-list"])):p("",!0)])])])}}},[["__scopeId","data-v-061b6b3e"]]);const $a={class:"layout-body"},Ha={class:"layout-right"};var Ga=ee({__name:"layout",props:{leftStyle:{}},setup:e=>(t,l)=>(a(),o("div",$a,[d("div",{class:"layout-left",style:I(e.leftStyle)},[_(t.$slots,"left",{},void 0,!0)],4),_(t.$slots,"center",{},void 0,!0),d("div",Ha,[_(t.$slots,"right",{},void 0,!0)])]))},[["__scopeId","data-v-2be9378c"]]);function Ba(e){const a=e.split(","),t=a[0].match(/:(.*?);/)[1],l=atob(a[1]);let s=l.length;const i=new Uint8Array(s);for(;s--;)i[s]=l.charCodeAt(s);return new Blob([i],{type:t})}class Qa{constructor(e){this.canvasDom=e,this.ctx=e.getContext("2d"),this.canvasDom.width=this.canvasDom.offsetWidth,this.canvasDom.height=this.canvasDom.offsetHeight,this.handleList=[],this.imageData={image:null,x:0,y:0,height:0,width:0},this.isMoving=!1,this.clearSetting={radius:10},this.finishImage=null,this.listeners={},window.addEventListener("resize",(()=>{this.canvasDom.width=this.canvasDom.offsetWidth,this.canvasDom.height=this.canvasDom.offsetHeight,this.clearSelectionArea(),this.initImage(this.imageData.image.src)}))}handleChange(e,a){const{canvasDom:t}=this;switch(this.clearHandle(),e){case"selectionArea":t.style.cursor="crosshair",this.addListener(t,"mousedown",(e=>{this.selectionAreaStart(e)})),this.addListener(t,"mouseup",(e=>{this.selectionAreaFinish(e),this.getFinishImage()})),this.addListener(t,"mousemove",(e=>{this.selectionAreaMoving(e)}));break;case"selectionArcArea":t.style.cursor="crosshair",this.addListener(t,"mousedown",(e=>{this.selectionArcAreaStart(e)})),this.addListener(t,"mouseup",(e=>{this.selectionArcAreaFinish(e),this.getFinishImage()})),this.addListener(t,"mousemove",(e=>{this.selectionArcAreaMoving(e)}));break;case"clearArea":t.style.cursor="none",this.addListener(t,"mousedown",(e=>{this.clearAreaStart(e,a)})),this.addListener(t,"mouseup",(e=>{this.clearAreaFinish(e,a),this.getFinishImage()})),this.addListener(t,"mousemove",(e=>{this.clearAreaMoving(e,a)}));break;default:this.clearHandle()}}selectionArcAreaStart(e){const{offsetX:a,offsetY:t}=e;this.handleList.push({handleX:a,handleY:t,type:"selectionArcArea",status:0,imageData:null})}selectionArcAreaMoving(e){const{offsetX:a,offsetY:t}=e;this.handleList.length&&0===this.handleList[this.handleList.length-1].status&&(this.handleList[this.handleList.length-1].offsetX=a,this.handleList[this.handleList.length-1].offsetY=t,this.reDraw())}selectionArcAreaFinish(){this.handleList[this.handleList.length-1].status=1,this.reDraw()}clearAreaStart(e,a){const{offsetX:t,offsetY:l}=e,{clearSetting:s}=this,{radius:i}=s;this.handleList.find((e=>"clearArea"===e.type))?(this.handleList.find((e=>"clearArea"===e.type)).status=0,this.handleList.find((e=>"clearArea"===e.type)).imageData=null):this.handleList.push({dataList:[],radius:i,handleX:t,handleY:l,type:"clearArea",clearType:a,status:0,imageData:null})}clearAreaMouseStyle(e){const{offsetX:a,offsetY:t}=e,{ctx:l,clearSetting:s}=this,{radius:i}=s;l.beginPath(),l.arc(a,t,i,0,2*Math.PI),l.stroke(),l.closePath()}clearAreaMoving(e){const{offsetX:a,offsetY:t}=e,{clearSetting:l}=this,{radius:s}=l;this.handleList.find((e=>"clearArea"===e.type))&&0===this.handleList.find((e=>"clearArea"===e.type)).status&&this.handleList.find((e=>"clearArea"===e.type)).dataList.push({offsetX:a,offsetY:t,radius:s}),this.reDraw(),this.clearAreaMouseStyle(e)}clearAreaFinish(e){this.handleList.find((e=>"clearArea"===e.type))&&(this.handleList.find((e=>"clearArea"===e.type)).status=1),this.reDraw()}selectionAreaStart(e){const{offsetX:a,offsetY:t}=e;this.handleList.push({handleX:a,handleY:t,type:"selectionArea",status:0,imageData:null})}selectionAreaMoving(e){const{offsetX:a,offsetY:t}=e;this.handleList.length&&0===this.handleList[this.handleList.length-1].status&&(this.handleList[this.handleList.length-1].offsetX=a,this.handleList[this.handleList.length-1].offsetY=t,this.reDraw())}selectionAreaFinish(){this.handleList[this.handleList.length-1].status=1,this.reDraw()}clearHandle(){this.canvasDom.style.cursor="auto",this.removeAllListeners()}initImage(e){const{ctx:a,canvasDom:t}=this,{width:l,height:s}=t;this.handleList=[],a.beginPath(),a.clearRect(0,0,l,s),a.closePath(),e.includes("http")&&y({method:"get",url:e,responseType:"blob"}).then((e=>{this.finishImage=new File([e.data],`${(new Date).getTime()}.png`,{type:"image/png"})}));const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{this.initImageData(i),this.drawImage()},i.src=e}initImageData(e){const{canvasDom:a}=this,{width:t,height:l}=a,s=e.width,i=e.height,n={image:e,x:0,y:0,height:0,width:0};if(i>l||s>t)if(i/l>s/t){const e=l/i;n.height=l,n.width=e*s,n.y=0,n.x=t/2-n.width/2}else{const e=t/s;n.width=t,n.height=e*i,n.x=0,n.y=l/2-n.height/2}else if(i>s){const e=l/t;n.height=l,n.width=l/e,n.y=0,n.x=t/2-n.width/2}else{const e=t/l;n.width=t,n.height=t/e,n.y=l/2-n.width/2,n.x=0}this.imageData=n}drawImage(){const{image:e,x:a,y:t,width:l,height:s}=this.imageData,{ctx:i}=this;e&&(i.beginPath(),i.drawImage(e,a,t,l,s),i.closePath())}reDraw(){const{ctx:e,canvasDom:a,imageData:t}=this,{image:l}=t,{width:s,height:i}=a;e.beginPath(),e.clearRect(0,0,s,i),e.closePath(),l&&(this.drawImage(),this.getSelecttionAreaImages(),e.beginPath(),this.handleList.forEach((a=>{e.globalCompositeOperation="destination-out";let{type:t}=a;if("selectionArea"===t){let{handleX:t,handleY:l,offsetX:s,offsetY:i,status:n}=a;e.strokeStyle="rgba(255, 255, 255, 1)",e.lineWidth=2;const o=t>s?s:t,d=l>i?i:l,r=t>s?t-s:s-t,c=l>i?l-i:i-l;if((!r||!c)&&n)return;e.rect(o,d,r,c)}if("selectionArcArea"===t){let{handleX:t,handleY:l,offsetX:s,offsetY:i,status:n}=a;e.strokeStyle="rgba(255, 255, 255, 1)",e.lineWidth=2;const o=t>s?s:t,d=l>i?i:l,r=t>s?t-s:s-t,c=l>i?l-i:i-l,u=Math.sqrt(r*r+c*c)/2;if((!r||!c)&&n)return;e.moveTo(o+r/2-u,d+c/2-u),e.arc(o+r/2,d+c/2,u,0,2*Math.PI)}if("clearArea"===t){let{clearType:t,dataList:l,offsetX:s,offsetY:i,radius:n}=a;e.moveTo(s+n,i+n),e.arc(s,i,n,0,2*Math.PI),l.forEach((a=>{e.moveTo(a.offsetX+a.radius,a.offsetY+a.radius),e.arc(a.offsetX,a.offsetY,a.radius,0,2*Math.PI)}))}})),e.fill(),e.globalCompositeOperation="source-over",e.closePath())}getSelecttionAreaImages(){const{image:e}=this.imageData;this.handleList.forEach(((a,t)=>{let{type:l}=a;if("selectionArea"===l){const{handleX:l,handleY:s,offsetX:i,offsetY:n,status:o,imageData:d}=a,r=this.canvasDom.width,c=this.canvasDom.height,u=this.imageData.width;this.imageData.height;const h=r===u?c/e.height:r/e.width;if(o&&!d){const o=document.createElement("canvas");o.width=r/h,o.height=c/h;const d=o.getContext("2d"),u=l>i?i:l,m=s>n?n:s,v=l>i?l-i:i-l,g=s>n?s-n:n-s;if(d.beginPath(),d.drawImage(e,this.imageData.x/h,this.imageData.y/h,this.imageData.width/h,this.imageData.height/h),d.clearRect(Math.round(u/h),Math.round(m/h),Math.round(v/h),Math.round(g/h)),d.closePath(),!v||!g)return;const p=d.getImageData(this.imageData.x/h,this.imageData.y/h,this.imageData.width/h,this.imageData.height/h),f=document.createElement("canvas");f.width=Math.round(this.imageData.width/h),f.height=Math.round(this.imageData.height/h);f.getContext("2d").putImageData(p,0,0);const w=Ba(f.toDataURL("image/png"));a.imageData=new File([w],`${(new Date).getTime()}_${t}.png`,{type:"image/png"})}}if("clearArea"===l){const{clearType:l,dataList:s,offsetX:i,offsetY:n,radius:o,status:d,imageData:r}=a,c=this.canvasDom.width,u=this.canvasDom.height,h=this.imageData.width;this.imageData.height;const m=c===h?u/e.height:c/e.width;if(d&&!r&&"arc"==l){const l=document.createElement("canvas");l.width=c/m,l.height=u/m;const d=l.getContext("2d");d.beginPath(),d.drawImage(e,this.imageData.x/m,this.imageData.y/m,this.imageData.width/m,this.imageData.height/m),d.closePath(),d.beginPath(),d.globalCompositeOperation="destination-out",d.moveTo((i+o)/m,(n+o)/m),d.arc(i,n,o,0,2*Math.PI),s.forEach((e=>{d.moveTo((e.offsetX+e.radius)/m,(e.offsetY+e.radius)/m),d.arc(e.offsetX/m,e.offsetY/m,e.radius/m,0,2*Math.PI)})),d.fill(),ctx.globalCompositeOperation="source-over",d.closePath();const r=d.getImageData(this.imageData.x/m,this.imageData.y/m,this.imageData.width/m,this.imageData.height/m),h=document.createElement("canvas");h.width=Math.round(this.imageData.width/m),h.height=Math.round(this.imageData.height/m);h.getContext("2d").putImageData(r,0,0);const v=Ba(h.toDataURL("image/png"));a.imageData=new File([v],`${(new Date).getTime()}_${t}.png`,{type:"image/png"})}}}))}getFinishImage(){const{image:e}=this.imageData,a=this.canvasDom.width,t=this.canvasDom.height,l=this.imageData.width;this.imageData.height;const s=a===l?t/e.height:a/e.width,i=document.createElement("canvas");i.width=a/s,i.height=t/s;const n=i.getContext("2d");n.beginPath(),n.drawImage(e,this.imageData.x/s,this.imageData.y/s,this.imageData.width/s,this.imageData.height/s),n.closePath(),n.globalCompositeOperation="destination-out",n.beginPath(),this.handleList.forEach(((e,a)=>{const{type:t}=e;if("selectionArea"===t){let{handleX:a,handleY:t,offsetX:l,offsetY:i,status:o}=e;n.strokeStyle="rgba(255, 255, 255, 1)",n.lineWidth=2;const d=a>l?l:a,r=t>i?i:t,c=a>l?a-l:l-a,u=t>i?t-i:i-t;if((!c||!u)&&o)return;n.rect(d/s,r/s,c/s,u/s)}if("clearArea"===t){let{clearType:a,dataList:t,offsetX:l,offsetY:i,radius:o}=e;n.moveTo((l+o)/s,(i+o)/s),n.arc(l/s,i/s,o/s,0,2*Math.PI),t.forEach((e=>{n.moveTo((e.offsetX+e.radius)/s,(e.offsetY+e.radius)/s),n.arc(e.offsetX/s,e.offsetY/s,e.radius/s,0,2*Math.PI)}))}if("selectionArcArea"===t){let{handleX:a,handleY:t,offsetX:l,offsetY:i,status:o}=e;n.strokeStyle="rgba(255, 255, 255, 1)",n.lineWidth=2;const d=a>l?l:a,r=t>i?i:t,c=a>l?a-l:l-a,u=t>i?t-i:i-t,h=Math.sqrt(c*c+u*u)/2;if((!c||!u)&&o)return;n.moveTo((d+c/2-h)/s,(r+u/2-h)/s),n.arc((d+c/2)/s,(r+u/2)/s,h/s,0,2*Math.PI)}})),n.fill(),n.globalCompositeOperation="source-over",n.closePath();const o=n.getImageData(this.imageData.x/s,this.imageData.y/s,this.imageData.width/s,this.imageData.height/s),d=document.createElement("canvas");d.width=Math.round(this.imageData.width/s),d.height=Math.round(this.imageData.height/s);d.getContext("2d").putImageData(o,0,0);const r=Ba(d.toDataURL("image/png"));this.finishImage=new File([r],`${(new Date).getTime()}_finish.png`,{type:"image/png"})}addListener(e,a,t){e.addEventListener(a,t);var l=a+"_"+t.toString();this.listeners[l]={element:e,eventType:a,listener:t}}removeAllListeners(){for(var e in this.listeners){var a=this.listeners[e];a.element.removeEventListener(a.eventType,a.listener)}this.listeners={}}clearSelectionArea(){this.handleList=[],this.finishImage=null,this.reDraw()}clearAll(){const{ctx:e,canvasDom:a}=this,{width:t,height:l}=a;e.beginPath(),e.clearRect(0,0,t,l),e.closePath()}setClearAreaRadius(e=10){this.clearSetting.radius=e}}const qa=e=>(f("data-v-35679002"),e=e(),w(),e),Ja={class:"super-image-search-body"},Ka={class:"image-search-title"},et={key:8,class:"image-handle-setting"},at=qa((()=>d("label",null," 笔刷半径 ",-1))),tt={class:"image-search-title-handle"},lt={class:"content"},st={class:"search-btn-area"},it=qa((()=>d("div",{class:"image-search-title",style:{height:"30px"}},[d("div",null,"提示词")],-1))),nt={class:"prompt-area"},ot={class:"prompt-item"},dt=qa((()=>d("div",{class:"prompt-item-label"},"正向提示词",-1))),rt={class:"prompt-item-input"},ct={class:"prompt-item"},ut=qa((()=>d("div",{class:"prompt-item-label"},"负向提示词",-1))),ht={class:"prompt-item-input"},mt={class:"prompt-btn"},vt=qa((()=>d("div",{class:"image-search-title",style:{height:"30px"}},[d("div",null,"生成图片")],-1))),gt={class:"content",style:{height:"calc(100% - 40px)"}},pt="https://u248120-87de-6175a03c.westc.gpuhub.com:8443";var ft=ee({__name:"index",setup(l){const s=i(null),h=i(null),m=i(null),g=i(0);i(0);const f=i(10),w=i(""),x=i(""),D=i(""),A=i(""),_=e=>{h.value?(w.value=e,m.value.handleChange(e)):b.error("请在上传图片后操作")},I=()=>{m.value.setClearAreaRadius(f.value)},E=e=>{s.value=e;const a=new FileReader;return a.onload=({target:e})=>{h.value=e.result,m.value.initImage(h.value)},a.readAsDataURL(e),!1};const P=()=>{if(!s.value)return b.error("请上传图片后操作"),!1;const e=(()=>{const e=new FormData;return e.append("positive_prompt",D.value),e.append("negative_prompt",A.value),e.append("image",s.value),m.value.finishImage?(e.append("image_with_mask",m.value.finishImage),e):(e.append("image_with_mask",s.value),e)})(),a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});y.post(`${pt}/img2img/inpaint`,e).then((e=>{a.close(),x.value=`${pt}/img2img/${e.data}`})).catch((e=>{a.close(),e.response&&413===e.response.status&&b.error("上传图片过大, 请减少图片数量或者大小")}))};return n((()=>{m.value=new Qa(g.value)})),(l,i)=>{const n=e("el-icon"),R=e("el-button"),T=e("el-slider"),Y=e("el-upload"),F=e("el-input"),U=e("el-image");return a(),o("div",Ja,[c(Ga,{leftStyle:{width:"calc(50% - 180px)"}},{left:u((()=>[d("div",Ka,[d("div",null,["selectionArea"!==w.value&&h.value?(a(),t(R,{key:0,type:"primary",class:"title-handle-btn",onClick:i[0]||(i[0]=e=>_("selectionArea")),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(V))])),_:1}),v(" 矩形 ")])),_:1})):p("",!0),"selectionArea"===w.value&&h.value?(a(),t(R,{key:1,class:"title-handle-btn",type:"warning",onClick:i[1]||(i[1]=e=>_("")),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(V))])),_:1}),v(" 矩形 ")])),_:1})):p("",!0),"selectionArcArea"!==w.value&&h.value?(a(),t(R,{key:2,type:"primary",class:"title-handle-btn",onClick:i[2]||(i[2]=e=>_("selectionArcArea")),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(M))])),_:1}),v(" 圆形 ")])),_:1})):p("",!0),"selectionArcArea"===w.value&&h.value?(a(),t(R,{key:3,class:"title-handle-btn",type:"warning",onClick:i[3]||(i[3]=e=>_("")),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(M))])),_:1}),v(" 圆形 ")])),_:1})):p("",!0),"clearArea"!==w.value&&h.value?(a(),t(R,{key:4,type:"primary",class:"title-handle-btn",onClick:i[4]||(i[4]=e=>_("clearArea")),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(S))])),_:1}),v(" 笔刷 ")])),_:1})):p("",!0),"clearArea"===w.value&&h.value?(a(),t(R,{key:5,class:"title-handle-btn",type:"warning",onClick:i[5]||(i[5]=e=>_("")),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(S))])),_:1}),v(" 笔刷 ")])),_:1})):p("",!0),h.value?(a(),t(R,{key:6,class:"title-handle-btn",type:"primary",onClick:i[6]||(i[6]=e=>{m.value.initImage(h.value)}),style:{"font-size":"12px"}},{default:u((()=>[c(n,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(C))])),_:1}),v(" 重置 ")])),_:1})):p("",!0),h.value?(a(),t(R,{key:7,class:"title-handle-btn",type:"primary",onClick:i[7]||(i[7]=e=>{L.prompt("请输入要识别的物品类别,例如: 床, 被单, 人物(英文)等,多种类别之间请使用逗号分割","提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((({value:e})=>{if(!e)return void b.error("请输入prompt后操作");e=(e+=",").replaceAll("，",",");const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),t=new FormData;t.append("prompt",e),t.append("image",s.value),y.post(`${pt}/img2img/segment`,t).then((e=>{a.close(),"没有识别到任何物体，需要给定更加详细的物体类别prompt!"!==e.data?(m.value.clearSelectionArea(),m.value.initImage(`${pt}/img2img/${e.data}`)):b.error(e.data)})).catch((e=>{a.close(),e.response&&413===e.response.status&&b.error("上传图片过大, 请减少图片数量或者大小")}))})).catch((()=>{b({type:"info",message:"取消操作"})}))}),style:{"font-size":"12px"}},{default:u((()=>[v(" Ai识别 ")])),_:1})):p("",!0),h.value?(a(),o("div",et,[at,c(T,{style:{width:"100px","margin-left":"20px",display:"inline-block","padding-top":"9px"},modelValue:f.value,"onUpdate:modelValue":i[8]||(i[8]=e=>f.value=e),onChange:I,min:1,max:100},null,8,["modelValue"])])):p("",!0)]),d("div",tt,[c(Y,{class:"upload-demo","before-upload":E,"show-file-list":!1,action:""},{default:u((()=>[c(R,{type:"text"},{default:u((()=>[v("上传图片")])),_:1})])),_:1})])]),d("div",lt,[d("canvas",{ref_key:"canvasDom",ref:g},null,512)])])),center:u((()=>[d("div",st,[it,d("div",nt,[d("div",ot,[dt,d("div",rt,[c(F,{type:"textarea",modelValue:D.value,"onUpdate:modelValue":i[9]||(i[9]=e=>D.value=e)},null,8,["modelValue"])])]),d("div",ct,[ut,d("div",ht,[c(F,{type:"textarea",modelValue:A.value,"onUpdate:modelValue":i[10]||(i[10]=e=>A.value=e)},null,8,["modelValue"])])]),d("div",mt,[c(R,{type:"primary",style:{width:"100%"},onClick:P},{default:u((()=>[v(" 生成 ")])),_:1})])])])])),right:u((()=>[vt,d("div",gt,[c(U,{src:x.value,fit:"scale-down","preview-src-list":[x.value],style:{width:"100%",height:"100%"}},null,8,["src","preview-src-list"])])])),_:1},8,["leftStyle"])])}}},[["__scopeId","data-v-35679002"]]);const wt=e=>(f("data-v-7720ba97"),e=e(),w(),e),yt={class:"m-spin"},bt={class:"m-spin-box"},kt={key:0,class:"m-spin-dot"},xt=[wt((()=>d("span",{class:"u-dot-item"},null,-1))),wt((()=>d("span",{class:"u-dot-item"},null,-1))),wt((()=>d("span",{class:"u-dot-item"},null,-1))),wt((()=>d("span",{class:"u-dot-item"},null,-1)))],Dt={key:1,class:"u-quarter-circle"},Ct={key:2,class:"u-three-quarters-circle"},At={key:3,class:"m-dynamic-circle"},_t=[wt((()=>d("svg",{class:"circular",viewBox:"0 0 50 50"},[d("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})],-1)))];var It=ee(E({__name:"Spin",props:{spinning:{type:Boolean,default:!0},size:{default:"default"},tip:{default:""},indicator:{default:"dot"},color:{default:"#1677FF"}},setup:e=>(e,t)=>(a(),o("div",{class:T(`m-spin-wrap ${e.size}`),style:I(`--color: ${e.color};`)},[P(d("div",yt,[d("div",bt,["dot"===e.indicator?(a(),o("div",kt,xt)):p("",!0),"quarter-circle"===e.indicator?(a(),o("div",Dt)):p("",!0),"three-quarters-circle"===e.indicator?(a(),o("div",Ct)):p("",!0),"dynamic-circle"===e.indicator?(a(),o("div",At,_t)):p("",!0),P(d("p",{class:"u-tip"},g(e.tip),513),[[R,e.tip]])])],512),[[R,e.spinning]]),d("div",{class:T(["m-spin-content",{"m-spin-mask":e.spinning}])},[_(e.$slots,"default",{},void 0,!0)],2)],6))}),[["__scopeId","data-v-7720ba97"]]);const Lt=e=>(f("data-v-bd6aed36"),e=e(),w(),e),Vt=["onMouseenter"],Mt=["src","alt","onLoad"],St=["onClick"],Et={style:{color:"#fff","margin-bottom":"5px"}},Pt={style:{color:"#fff","margin-bottom":"5px"}},Rt={style:{color:"#fff",width:"100%",display:"-webkit-box","word-break":"break-all","-webkit-line-clamp":"1","-webkit-box-orient":"vertical",overflow:"hidden","text-overflow":"ellipsis"}},Tt={style:{position:"absolute",right:"10px",bottom:"5px"}},Yt=["onClick"],Ft=[Lt((()=>d("rect",{stroke:"null",id:"svg_1",fill:"white",rx:"18",height:"36",width:"36"},null,-1))),Lt((()=>d("path",{stroke:"#F3745D",id:"svg_2","stroke-width":"2",d:"m9.699395,11l16.60121,0l0,16.532009l-16.60121,0l0,-16.532009z"},null,-1))),Lt((()=>d("path",{stroke:"#F3745D",id:"svg_3","stroke-width":"2",d:"m14.553074,6l6.893853,0l0,4.173591l-6.893853,0l0,-4.173591z"},null,-1))),Lt((()=>d("path",{stroke:"#F3745D",id:"svg_4","stroke-width":"2",d:"m6.932526,10l22.134948,0"},null,-1))),Lt((()=>d("path",{stroke:"#F3745D",id:"svg_5","stroke-width":"1.6",d:"m20.62999,14.8l0,7.240074"},null,-1))),Lt((()=>d("path",{stroke:"#F3745D",id:"svg_6","stroke-width":"1.6",d:"m15.649886,14.8l0,7.170871"},null,-1)))],Ut=["onClick"],Xt=[Lt((()=>d("rect",{width:"36",height:"36",rx:"18",fill:"white"},null,-1))),Lt((()=>d("path",{d:"M9.8125 9.81836H17.9943L19.4819 11.8638H26.1761V26.182H9.8125V9.81836Z",stroke:"#4075E5","stroke-width":"2"},null,-1))),Lt((()=>d("path",{d:"M9.8125 15.9547H26.1761",stroke:"#4075E5","stroke-width":"2"},null,-1)))],Ot=["onClick"],Zt=[Lt((()=>d("rect",{width:"36",height:"36",rx:"18",fill:"white"},null,-1))),Lt((()=>d("path",{d:"M17.2504 24.6942C21.3583 24.6942 24.6884 21.3642 24.6884 17.2563C24.6884 13.1484 21.3583 9.81836 17.2504 9.81836C13.1426 9.81836 9.8125 13.1484 9.8125 17.2563C9.8125 21.3642 13.1426 24.6942 17.2504 24.6942Z",stroke:"#4075E5","stroke-width":"2"},null,-1))),Lt((()=>d("path",{d:"M26.1721 26.182L22.4531 22.46",stroke:"#4075E5","stroke-width":"2"},null,-1)))],Wt=["onMouseenter"],zt=["src","alt","onLoad"],Nt={class:"overlay"},jt={style:{color:"#fff"}};var $t=ee(E({__name:"Index",props:{images:{default:()=>[]},columnCount:{default:3},columnGap:{default:20},width:{default:"100%"},backgroundColor:{default:"#fff"},mode:{default:"JS"}},emits:["handleShowInfoModal","handleDelete"],setup(l,{emit:s}){const v=l,f=Y((()=>"number"==typeof v.width?v.width+"px":v.width)),w=s,y=i([]),b=i([]),k=i(),D=i(),C=Y((()=>Math.max(...b.value)+v.columnGap)),A=Y((()=>v.images.length)),_=i(Array(A.value).fill(!1));function L(e){_.value[e]=!0}function V(e,a){if(e<v.columnCount)return b.value[e]=v.columnGap+a,{top:v.columnGap,left:(D.value+v.columnGap)*e+v.columnGap};{const e=Math.min(...b.value);var t=0;for(let a=0;a<b.value.length;a++)if(b.value[a]===e){t=a;break}return b.value[t]=e+v.columnGap+a,{top:e+v.columnGap,left:(D.value+v.columnGap)*t+v.columnGap}}}function M(e,a){return new Promise((t=>{const l=new Image;l.src=e,l.onload=function(){var e=l.height/(l.width/D.value);y.value[a]={width:D.value,height:e,...V(a,e)},t("load")}}))}async function S(){var e;D.value=(k.value.offsetWidth-(v.columnCount+1)*v.columnGap)/v.columnCount;const a=v.images.length;for(let t=null==(e=y.value)?void 0:e.length;t<a;t++)await M(v.images[t].src,t)}F((()=>v.images),(e=>{e.length&&"JS"===v.mode&&S()})),n((()=>{v.images.length&&"JS"===v.mode&&S()}));let E=i(null);return(l,s)=>{const i=e("svg-icon"),n=e("a-space");return a(),o(h,null,["JS"===l.mode?(a(),o("div",U({key:0},l.$attrs,{class:"m-waterfall-js",ref_key:"waterfall",ref:k,style:`background-color: ${l.backgroundColor}; width: ${f.value}; height: ${C.value}px;`}),[(a(!0),o(h,null,m(y.value,((e,i)=>(a(),t(It,{class:"m-img",style:I(`border:solid 1px #d9d9d9; border-radius: 16px; width: ${e.width}px; height: ${e.height}px; top: ${e&&e.top}px; left: ${e&&e.left}px;`),spinning:!_.value[i],size:"small",indicator:"dynamic-circle",key:i},{default:u((()=>{var e,t;return[d("div",{class:"relative flex justify-center align-center",onMouseenter:e=>X(E)?E.value=i:E=i,onMouseleave:s[0]||(s[0]=e=>X(E)?E.value=null:E=null)},[d("img",{class:"u-img",src:l.images[i].src,alt:l.images[i].title,onLoad:e=>L(i)},null,40,Mt),P(d("div",{class:"overlay",onClick:e=>w("showHandle",l.images[i])},[d("div",null,[d("div",Et,g(l.images[i].title),1),d("div",Pt,"尺寸："+g((null==(e=l.images[i].width)?void 0:e.toFixed(2))+" * "+(null==(t=l.images[i].height)?void 0:t.toFixed(2))),1),d("div",Rt,"文件位置："+g(l.images[i].fileAddress),1)]),d("div",Tt,[(a(),o("svg",{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{"margin-right":"10px"},onClick:x((e=>w("handleDel",l.images[i])),["stop"])},Ft,8,Yt)),(a(),o("svg",{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{"margin-right":"10px"},onClick:x((e=>w("handleOpenDir",l.images[i])),["stop"])},Xt,8,Ut)),(a(),o("svg",{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:x((e=>w("handleshowImage",l.images[i])),["stop"])},Zt,8,Ot))])],8,St),[[R,r(E)===i]])],40,Vt)]})),_:2},1032,["style","spinning"])))),128))],16)):p("",!0),"CSS"===l.mode?(a(),o("div",U({key:1},l.$attrs,{class:"m-waterfall-css",style:`background: ${l.backgroundColor}; width: ${f.value}; padding: ${l.columnGap}px; column-count: ${l.columnCount}; column-gap: ${l.columnGap}px;`}),[(a(!0),o(h,null,m(l.images,((e,o)=>(a(),t(It,{style:I(`border:solid 1px #E6EAEE;border-radius: 10px;margin-bottom: ${l.columnGap}px;`),spinning:!_.value[o],size:"small",indicator:"dynamic-circle",key:o},{default:u((()=>[d("div",{style:{position:"relative"},onMouseenter:e=>X(E)?E.value=o:E=o,onMouseleave:s[1]||(s[1]=e=>X(E)?E.value=null:E=null)},[d("img",{class:"u-img",src:e.src,alt:e.title,onLoad:e=>L(o)},null,40,zt),P(d("div",Nt,[c(n,{size:20},{default:u((()=>[c(i,{"icon-class":"del_active",onClick:e=>w("handleDelete",l.images[o])},null,8,["onClick"]),c(i,{"icon-class":"edit2",onClick:e=>w("handleShowInfoModal",l.images[o])},null,8,["onClick"])])),_:2},1024),d("div",jt,g(e.title),1)],512),[[R,r(E)===o]])],40,Wt)])),_:2},1032,["style","spinning"])))),128))],16)):p("",!0)],64)}}}),[["__scopeId","data-v-bd6aed36"]]);const Ht={class:"my-header"},Gt={class:"dialog-header"},Bt=["id"],Qt={class:"image-area"},qt={class:"image-item"},Jt=["src"],Kt={class:"image-msg-area"},el={class:"image-msg-item"},al={style:{"padding-left":"10px","box-sizing":"border-box",color:"#000","margin-bottom":"10px"}},tl={style:{"padding-left":"10px","box-sizing":"border-box",color:"#000","margin-bottom":"10px"}},ll={style:{"padding-left":"10px","box-sizing":"border-box",color:"#000",width:"100%",display:"-webkit-box","word-break":"break-all","margin-bottom":"10px","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",overflow:"hidden","text-overflow":"ellipsis"}},sl=(e=>(f("data-v-0b61c804"),e=e(),w(),e))((()=>d("svg",{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[d("rect",{width:"36",height:"36",rx:"18",fill:"white"}),d("path",{d:"M9.8125 9.81836H17.9943L19.4819 11.8638H26.1761V26.182H9.8125V9.81836Z",stroke:"#4075E5","stroke-width":"2"}),d("path",{d:"M9.8125 15.9547H26.1761",stroke:"#4075E5","stroke-width":"2"})],-1)));var il=ee({__name:"imageDialog",setup(l,{expose:s}){const n=i(!1),o=i({});return s({init:e=>{o.value=e,n.value=!0}}),(l,s)=>{const i=e("el-button"),r=e("el-dialog");return a(),t(r,{"align-center":"",modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=e=>n.value=e),"show-close":!1,width:"600","before-close":l.handleClose},{header:u((({close:e,titleId:a})=>[d("div",Ht,[d("div",Gt,[d("div",{id:a,class:"dialog-title",style:{"text-align":"center"}},"预览",8,Bt),c(i,{size:"small",type:"text",onClick:e,class:"dialog-close-btn"},{default:u((()=>[v(" 关闭 ")])),_:2},1032,["onClick"])])])])),default:u((()=>[d("div",Qt,[d("div",qt,[d("img",{src:o.value.src},null,8,Jt)]),d("div",Kt,[d("div",el,[d("div",al,g(o.value.title),1),d("div",tl," 尺寸："+g(o.value.width.toFixed(2)+" * "+o.value.height.toFixed(2)),1),d("div",ll," 文件位置："+g(o.value.fileAddress),1),c(i,{type:"text",style:{padding:"0"},onClick:s[0]||(s[0]=e=>(({fileAddress:e})=>{window.open(e)})(o.value))},{default:u((()=>[sl,v(" 打开所在文件夹 ")])),_:1})])])])])),_:1},8,["modelValue","before-close"])}}},[["__scopeId","data-v-0b61c804"]]);function nl(e){const a=e.split(","),t=a[0].match(/:(.*?);/)[1],l=atob(a[1]);let s=l.length;const i=new Uint8Array(s);for(;s--;)i[s]=l.charCodeAt(s);return new Blob([i],{type:t})}function ol(e,a){return"left"===a?(e=>new Promise((a=>{const t=new Image;t.src=e,t.onload=()=>{const e=t.width,l=t.height,s=document.createElement("canvas");s.width=e>l?e:l,s.height=e>l?e:l;const i=s.getContext("2d"),n=s.width/2,o=s.height/2;i.beginPath(),i.translate(n,o),i.rotate(-Math.PI/2),i.translate(-n,-o),i.drawImage(t,n-t.width/2,o-t.height/2),i.closePath();const d=i.getImageData(o-t.height/2,n-t.width/2,l,e),r=document.createElement("canvas");r.width=l,r.height=e,r.getContext("2d").putImageData(d,0,0);const c=nl(r.toDataURL("image/png")),u=new File([c],`${(new Date).getTime()}_${Math.round(1e3*Math.random())}.png`,{type:"image/png"}),h=new FileReader;h.onload=({target:e})=>{a({file:u,url:e.result})},h.readAsDataURL(u)}})))(e):"right"===a?(e=>new Promise((a=>{const t=new Image;t.src=e,t.onload=()=>{const e=t.width,l=t.height,s=document.createElement("canvas");s.width=e>l?e:l,s.height=e>l?e:l;const i=s.getContext("2d"),n=s.width/2,o=s.height/2;i.beginPath(),i.translate(n,o),i.rotate(Math.PI/2),i.translate(-n,-o),i.drawImage(t,n-t.width/2,o-t.height/2),i.closePath();const d=i.getImageData(o-t.height/2,n-t.width/2,l,e),r=document.createElement("canvas");r.width=l,r.height=e,r.getContext("2d").putImageData(d,0,0);const c=nl(r.toDataURL("image/png")),u=new File([c],`${(new Date).getTime()}_${Math.round(1e3*Math.random())}.png`,{type:"image/png"}),h=new FileReader;h.onload=({target:e})=>{a({file:u,url:e.result})},h.readAsDataURL(u)}})))(e):"horizontal"===a?(e=>new Promise((a=>{const t=new Image;t.src=e,t.onload=()=>{const e=t.width,l=t.height,s=document.createElement("canvas");s.width=e,s.height=l;const i=s.getContext("2d"),n=s.width/2,o=s.height/2;i.beginPath(),i.translate(2*n,0),i.scale(-1,1),i.drawImage(t,n-t.width/2,o-t.height/2),i.closePath();const d=i.getImageData(0,0,e,l),r=document.createElement("canvas");r.width=e,r.height=l,r.getContext("2d").putImageData(d,0,0);const c=nl(r.toDataURL("image/png")),u=new File([c],`${(new Date).getTime()}_${Math.round(1e3*Math.random())}.png`,{type:"image/png"}),h=new FileReader;h.onload=({target:e})=>{a({file:u,url:e.result})},h.readAsDataURL(u)}})))(e):"vertical"===a?(e=>new Promise((a=>{const t=new Image;t.src=e,t.onload=()=>{const e=t.width,l=t.height,s=document.createElement("canvas");s.width=e,s.height=l;const i=s.getContext("2d"),n=s.width/2,o=s.height/2;i.beginPath(),i.translate(0,2*o),i.scale(1,-1),i.drawImage(t,n-t.width/2,o-t.height/2),i.closePath();const d=i.getImageData(0,0,e,l),r=document.createElement("canvas");r.width=e,r.height=l,r.getContext("2d").putImageData(d,0,0);const c=nl(r.toDataURL("image/png")),u=new File([c],`${(new Date).getTime()}_${Math.round(1e3*Math.random())}.png`,{type:"image/png"}),h=new FileReader;h.onload=({target:e})=>{a({file:u,url:e.result})},h.readAsDataURL(u)}})))(e):void 0}const dl={class:"image-search-body"},rl={class:"upload-image-title"},cl={key:0,class:"clear-result"},ul={class:"upload-image-area"},hl=["src"],ml={key:1,class:"upload-text-tips"},vl=(e=>(f("data-v-216c4056"),e=e(),w(),e))((()=>d("div",{class:"upload-text"},"点击上传",-1))),gl={key:0,class:"image-handle-area"},pl={class:"image-handle-item"},fl={class:"image-handle-item"},wl={key:1,class:"search-btn-area"},yl={class:"search-result-area"},bl={class:"search-result-title"},kl={key:0,class:"result-num"},xl={key:0,class:"search-result-images-area"},Dl="https://u248120-ac90-72cbfad9.westb.seetacloud.com:8443/demo";var Cl=ee({__name:"index",setup(t){const l=i(null),s=i(null),n=i([]),h=i(0),m=i([]),f=i(!1),w=e=>{ol(s.value,e).then((({file:e,url:a})=>{l.value=e,s.value=a}))},b=e=>{l.value=e;const a=new FileReader;return a.onload=({target:e})=>{s.value=e.result},a.readAsDataURL(e),!1},k=()=>{l.value=null,s.value=null},C=()=>{const e=new FormData;e.append("file",l.value),f.value=!0,y.post(`${Dl}/search`,e).then((e=>{const{data:a}=e;m.value=a.result.map((e=>({title:e,fileAddress:`${Dl}/static/${e}`,width:1920,height:1080,src:`${Dl}/static/${e}`}))),f.value=!1}))},_=e=>{h.value.init(e)},I=({fileAddress:e})=>{window.open(e)},L=()=>{n.value=[],m.value=[],s.value=null,l.value=null};return(t,l)=>{const i=e("el-button"),n=e("el-icon"),y=e("el-upload"),V=e("el-scrollbar"),M=O("loading");return a(),o("div",dl,[c(Ga,null,{left:u((()=>[d("div",rl,[v(" 上传识别图 "),m.value.length?(a(),o("div",cl,[c(i,{style:{padding:"0",height:"20px","line-height":"20px"},type:"text",onClick:L},{default:u((()=>[v("清空")])),_:1})])):p("",!0)]),d("div",ul,[c(y,{class:"avatar-uploader",drag:"",action:"","show-file-list":!1,"before-upload":b},{default:u((()=>[s.value?(a(),o("div",{key:0,class:"upload-image-del-area",onClick:l[1]||(l[1]=x((()=>{}),["stop"]))},[d("img",{src:s.value,class:"avatar"},null,8,hl),d("div",{class:"upload-image-del-btn-area",onClick:l[0]||(l[0]=x((()=>{}),["stop"]))},[d("div",{class:"upload-image-del-btn",onClick:x(k,["stop"])},[c(n,null,{default:u((()=>[c(r(A))])),_:1})])])])):(a(),o("div",ml,[c(n,{class:"avatar-uploader-icon"},{default:u((()=>[c(r(D))])),_:1}),vl]))])),_:1})]),s.value?(a(),o("div",gl,[d("div",pl,[c(i,{onClick:l[2]||(l[2]=e=>w("left")),size:"small"},{default:u((()=>[v(" 左旋90° ")])),_:1}),c(i,{onClick:l[3]||(l[3]=e=>w("horizontal")),size:"small"},{default:u((()=>[v(" 水平镜像 ")])),_:1})]),d("div",fl,[c(i,{onClick:l[4]||(l[4]=e=>w("right")),size:"small"},{default:u((()=>[v(" 右旋90° ")])),_:1}),c(i,{onClick:l[5]||(l[5]=e=>w("vertical")),size:"small"},{default:u((()=>[v(" 垂直镜像 ")])),_:1})])])):p("",!0),s.value?(a(),o("div",wl,[c(i,{round:"",type:"primary",onClick:C},{default:u((()=>[v("开始识别")])),_:1})])):p("",!0)])),right:u((()=>[d("div",yl,[d("div",bl,[v(" 搜索结果 "),m.value.length?(a(),o("div",kl," 共 "+g(m.value.length)+" 张 ",1)):p("",!0)]),P((a(),o("div",{class:"search-result-images","element-loading-spinner":'<svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M60 30C60 46.5685 46.5685 60 30 60C13.4315 60 0 46.5685 0 30C0 13.4315 13.4315 0 30 0C46.5685 0 60 13.4315 60 30ZM9 30C9 41.598 18.402 51 30 51C41.598 51 51 41.598 51 30C51 18.402 41.598 9 30 9C18.402 9 9 18.402 9 30Z" fill="#E6EAEE"/>\n<path d="M45.6207 55.6124C39.8677 59.1211 33.1009 60.5907 26.4108 59.7845C19.7206 58.9783 13.4967 55.9432 8.74189 51.1682C3.98711 46.3932 0.978394 40.1565 0.200542 33.463C-0.577311 26.7695 0.921008 20.009 4.45407 14.2709C7.98712 8.53278 13.3492 4.15125 19.6761 1.83232C26.0031 -0.48661 32.9266 -0.607895 39.3309 1.48801C45.7353 3.58392 51.2475 7.77495 54.9793 13.3858C58.7112 18.9966 60.4454 25.7005 59.9025 32.4171L50.9317 31.692C51.3118 26.9903 50.0979 22.2976 47.4855 18.37C44.8732 14.4425 41.0147 11.5087 36.5317 10.0416C32.0486 8.57447 27.2022 8.65937 22.7733 10.2826C18.3444 11.9059 14.591 14.9729 12.1178 18.9896C9.64471 23.0063 8.59588 27.7386 9.14038 32.4241C9.68488 37.1096 11.791 41.4753 15.1193 44.8177C18.4477 48.1602 22.8044 50.2848 27.4875 50.8492C32.1706 51.4135 36.9074 50.3848 40.9345 47.9287L45.6207 55.6124Z" fill="#4075E5"/>\n</svg>\n',"element-loading-svg-view-box":"0, 0, 60, 60","element-loading-text":"加载中...","element-loading-background":"#ffffff"},[c(V,null,{default:u((()=>[m.value.length?(a(),o("div",xl,[c($t,{onHandleshowImage:_,onHandleOpenDir:I,columnCount:5,images:m.value},null,8,["images"])])):p("",!0)])),_:1})])),[[M,f.value]])])])),_:1}),c(il,{ref_key:"imageDialogDom",ref:h},null,512)])}}},[["__scopeId","data-v-216c4056"]]);const Al=e=>(f("data-v-6e71c3e2"),e=e(),w(),e),_l={class:"dir-area"},Il=Al((()=>d("div",{class:"dir-list-title"},[v(" 链接本地图库 "),d("div",{class:"add-gallery-btn"})],-1))),Ll={key:0,class:"dir-list"},Vl={class:"dir-path"},Ml={class:"dir-handle"},Sl={class:"images-all-area"},El={class:"images-all-title"},Pl=Al((()=>d("div",null,null,-1))),Rl={class:"images-num"},Tl=Al((()=>d("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[d("rect",{x:"3.5",y:"3.5",width:"13",height:"13",stroke:"#79bbff","stroke-width":"1.5"}),d("path",{d:"M5 10H15",stroke:"#79bbff","stroke-width":"1.5"}),d("path",{d:"M10 5V15",stroke:"#79bbff","stroke-width":"1.5"})],-1))),Yl={key:0,style:{"margin-left":"20px"}},Fl={key:0,class:"images-all-images-area"},Ul={class:"dir-list-content"},Xl={class:"dir-info-icon"},Ol=["onClick"],Zl="https://u248120-ac90-72cbfad9.westb.seetacloud.com:8443/demo",Wl='<svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M60 30C60 46.5685 46.5685 60 30 60C13.4315 60 0 46.5685 0 30C0 13.4315 13.4315 0 30 0C46.5685 0 60 13.4315 60 30ZM9 30C9 41.598 18.402 51 30 51C41.598 51 51 41.598 51 30C51 18.402 41.598 9 30 9C18.402 9 9 18.402 9 30Z" fill="#E6EAEE"/>\n<path d="M45.6207 55.6124C39.8677 59.1211 33.1009 60.5907 26.4108 59.7845C19.7206 58.9783 13.4967 55.9432 8.74189 51.1682C3.98711 46.3932 0.978394 40.1565 0.200542 33.463C-0.577311 26.7695 0.921008 20.009 4.45407 14.2709C7.98712 8.53278 13.3492 4.15125 19.6761 1.83232C26.0031 -0.48661 32.9266 -0.607895 39.3309 1.48801C45.7353 3.58392 51.2475 7.77495 54.9793 13.3858C58.7112 18.9966 60.4454 25.7005 59.9025 32.4171L50.9317 31.692C51.3118 26.9903 50.0979 22.2976 47.4855 18.37C44.8732 14.4425 41.0147 11.5087 36.5317 10.0416C32.0486 8.57447 27.2022 8.65937 22.7733 10.2826C18.3444 11.9059 14.591 14.9729 12.1178 18.9896C9.64471 23.0063 8.59588 27.7386 9.14038 32.4241C9.68488 37.1096 11.791 41.4753 15.1193 44.8177C18.4477 48.1602 22.8044 50.2848 27.4875 50.8492C32.1706 51.4135 36.9074 50.3848 40.9345 47.9287L45.6207 55.6124Z" fill="#4075E5"/>\n</svg>\n';var zl=ee({__name:"index",setup(l){i([]);const s=i(0),r=i([]),f=i([]),w=i(!1),k=i(!1),D=i(!1),C=i([]),A=()=>{w.value=!0,y.get(`${Zl}/images`).then((e=>{const{data:a}=e;w.value=!1,f.value=r.value=a.images.map((e=>({title:e,fileAddress:`${Zl}/static/${e}`,width:1920,height:1080,src:`${Zl}/static/${e}`})))}))},_=()=>{k.value=!0,setTimeout((()=>{k.value=!1,C.value=["线上图库"]}),1e3),A()},I=e=>{C.value.push(e),D.value=!1},L=()=>{b("演示版本暂无此功能，请于正式版本使用")};return n((()=>{_(),window.onFolderSelected=I})),(l,i)=>{const n=e("el-button"),y=e("el-empty"),b=e("el-scrollbar"),_=e("el-upload"),I=e("el-image"),V=O("loading");return P((a(),o("div",{class:"gallery-body","element-loading-spinner":Wl,"element-loading-svg-view-box":"0, 0, 60, 60","element-loading-text":"加载中...","element-loading-background":"#ffffff"},[c(Ga,null,{left:u((()=>[d("div",_l,[Il,P((a(),o("div",{class:"dir-all-area","element-loading-spinner":Wl,"element-loading-svg-view-box":"0, 0, 60, 60","element-loading-text":"加载中...","element-loading-background":"#ffffff"},[c(b,null,{default:u((()=>[C.value.length?(a(),o("div",Ll,[(a(!0),o(h,null,m(C.value,((e,t)=>(a(),o("div",{class:"dir-list-item",key:t},[d("div",Vl,g(e),1),d("div",Ml,[c(n,{type:"text",onClick:e=>{},style:{color:"#f3745d",padding:"0",height:"20px","vertical-align":"top"}},{default:u((()=>[v("删除")])),_:2},1032,["onClick"])])])))),128))])):(a(),t(y,{key:1,description:"暂未连接本地图库",style:{"padding-top":"200px",color:"rgba(0, 0, 0, 1)"}},{default:u((()=>[c(n,{type:"primary",round:"",onClick:L},{default:u((()=>[v("选择")])),_:1})])),_:1}))])),_:1})])),[[V,k.value]])])])),right:u((()=>[d("div",Sl,[d("div",El,[v(" 图库预览 "),Pl,d("div",Rl,[c(_,{class:"upload-demo","show-file-list":!1,"on-success":A,action:`${Zl}/upload`},{default:u((()=>[c(n,{type:"text",size:"small",style:{padding:"0"}},{default:u((()=>[Tl,v(" 上传图片 ")])),_:1})])),_:1},8,["action"]),f.value.length?(a(),o("div",Yl," 共 "+g(r.value.length)+" 张 ",1)):p("",!0)])]),P((a(),o("div",{class:"images-all-images","element-loading-spinner":Wl,"element-loading-svg-view-box":"0, 0, 60, 60","element-loading-text":"加载中...","element-loading-background":"#ffffff"},[c(b,null,{default:u((()=>[f.value.length?(a(),o("div",Fl,[d("div",Ul,[(a(!0),o(h,null,m(f.value,((e,t)=>(a(),o("div",{class:"dir-list-info",type:"image",key:t},[d("div",Xl,[c(I,{style:{width:"100%",height:"100px"},"preview-src-list":[e.src],src:e.src,fit:"cover",lazy:""},null,8,["preview-src-list","src"])]),d("div",{class:"dir-name",onClick:x((a=>{return t=e,void s.value.init(t);var t}),["stop"])},g(e.title),9,Ol)])))),128))])])):(a(),t(y,{key:1,description:"暂无内容",style:{"padding-top":"200px",color:"rgba(0, 0, 0, 1)"}}))])),_:1})])),[[V,w.value]])])])),_:1}),c(il,{ref_key:"imageDialogDom",ref:s},null,512)])),[[V,D.value]])}}},[["__scopeId","data-v-6e71c3e2"]]);class Nl{constructor(e){this.canvasDom=e,this.ctx=e.getContext("2d"),this.canvasDom.width=this.canvasDom.offsetWidth,this.canvasDom.height=this.canvasDom.offsetHeight,this.handleList=[],this.imageData={image:null,x:0,y:0,height:0,width:0},this.listeners={},window.addEventListener("resize",(()=>{this.canvasDom.width=this.canvasDom.offsetWidth,this.canvasDom.height=this.canvasDom.offsetHeight,this.clearSelectionArea(),this.initImage(this.imageData.image.src)}))}handleChange(e){const{canvasDom:a}=this;if("selectionArea"===e)a.style.cursor="crosshair",this.addListener(a,"mousedown",(e=>{this.selectionAreaStart(e)})),this.addListener(a,"mouseup",(e=>{this.selectionAreaFinish(e)})),this.addListener(a,"mousemove",(e=>{this.selectionAreaMoving(e)}));else this.clearHandle()}selectionAreaStart(e){const{offsetX:a,offsetY:t}=e;this.handleList.push({handleX:a,handleY:t,status:0,imageData:null})}selectionAreaMoving(e){const{offsetX:a,offsetY:t}=e;this.handleList.length&&0===this.handleList[this.handleList.length-1].status&&(this.handleList[this.handleList.length-1].offsetX=a,this.handleList[this.handleList.length-1].offsetY=t,this.reDraw())}selectionAreaFinish(){this.handleList[this.handleList.length-1].status=1,this.reDraw()}clearHandle(){this.canvasDom.style.cursor="auto",this.removeAllListeners()}initImage(e){const{ctx:a,canvasDom:t}=this,{width:l,height:s}=t;this.handleList=[],a.beginPath(),a.clearRect(0,0,l,s),a.closePath();const i=new Image;i.src=e,i.onload=()=>{this.initImageData(i),this.drawImage()}}initImageData(e){const{canvasDom:a}=this,{width:t,height:l}=a,s=e.width,i=e.height,n={image:e,x:0,y:0,height:0,width:0};if(i>l||s>t)if(i/l>s/t){const e=l/i;n.height=l,n.width=e*s,n.y=0,n.x=t/2-n.width/2}else{const e=t/s;n.width=t,n.height=e*i,n.x=0,n.y=l/2-n.height/2}else if(i>s){const e=l/t;n.height=l,n.width=l/e,n.y=0,n.x=t/2-n.width/2}else{const e=t/l;n.width=t,n.height=t/e,n.y=l/2-n.width/2,n.x=0}this.imageData=n}drawImage(){const{image:e,x:a,y:t,width:l,height:s}=this.imageData,{ctx:i}=this;e&&(i.beginPath(),i.drawImage(e,a,t,l,s),i.closePath())}reDraw(){const{ctx:e,canvasDom:a}=this,{width:t,height:l}=a;e.beginPath(),e.clearRect(0,0,t,l),e.closePath(),this.drawImage(),this.getSelecttionAreaImages(),this.handleList.forEach((({handleX:a,handleY:t,offsetX:l,offsetY:s,status:i})=>{e.beginPath(),e.strokeStyle="rgba(255, 0, 0, 1)",e.lineWidth=2;const n=a>l?l:a,o=t>s?s:t,d=a>l?a-l:l-a,r=t>s?t-s:s-t;(d&&r||!i)&&(e.rect(n,o,d,r),e.stroke(),e.closePath())}))}getSelecttionAreaImages(){this.handleList.forEach(((e,a)=>{const{handleX:t,handleY:l,offsetX:s,offsetY:i,status:n,imageData:o}=e,{ctx:d}=this;if(n&&!o){const n=t>s?s:t,o=l>i?i:l,r=t>s?t-s:s-t,c=l>i?l-i:i-l;if(!r||!c)return;const u=d.getImageData(Math.round(n),Math.round(o),Math.round(r),Math.round(c)),h=document.createElement("canvas");h.width=r,h.height=c;h.getContext("2d").putImageData(u,0,0);const m=function(e){const a=e.split(","),t=a[0].match(/:(.*?);/)[1],l=atob(a[1]);let s=l.length;const i=new Uint8Array(s);for(;s--;)i[s]=l.charCodeAt(s);return new Blob([i],{type:t})}(h.toDataURL("image/png"));e.imageData=new File([m],`${(new Date).getTime()}_${a}.png`,{type:"image/png"})}}))}addListener(e,a,t){e.addEventListener(a,t);var l=a+"_"+t.toString();this.listeners[l]={element:e,eventType:a,listener:t}}removeAllListeners(){for(var e in this.listeners){var a=this.listeners[e];a.element.removeEventListener(a.eventType,a.listener)}this.listeners={}}clearSelectionArea(){this.handleList=[],this.reDraw()}clearAll(){const{ctx:e,canvasDom:a}=this,{width:t,height:l}=a;e.beginPath(),e.clearRect(0,0,t,l),e.closePath()}}const jl=e=>(f("data-v-589b370f"),e=e(),w(),e),$l={class:"super-image-search-body"},Hl={class:"image-search-title"},Gl={key:3,class:"image-handle-area"},Bl={class:"image-handle-item"},Ql=jl((()=>d("div",{class:"image-handle-item"},null,-1))),ql={class:"image-search-title-handle"},Jl={class:"content"},Kl={class:"search-btn-area"},es=jl((()=>d("br",null,null,-1))),as={class:"image-search-title",style:{height:"30px"}},ts=jl((()=>d("div",null,"搜索结果",-1))),ls={class:"image-search-title-handle"},ss={class:"content",style:{height:"calc(100% - 40px)"}},is="https://u248120-ac90-72cbfad9.westb.seetacloud.com:8443/demo";var ns=ee({__name:"index",setup(l){const s=i(null),h=i(null),m=i(null),f=i(0),w=i(0),k=i(""),x=i([]),D=i(!1),A=i("图片搜索"),_=i(""),I=i(10),L=i(!1),M=e=>{ol(h.value,e).then((({file:e,url:a})=>{s.value=e,h.value=a,m.value.initImage(h.value)}))},S=e=>{h.value?(k.value=e,m.value.handleChange(e)):b.error("请在上传图片后操作")};const E=e=>{s.value=e;const a=new FileReader;return a.onload=({target:e})=>{h.value=e.result,m.value.initImage(h.value)},a.readAsDataURL(e),!1},T=()=>{if(D.value=!0,"图片搜索"===A.value){let e=m.value.handleList;e.length?(e=>{let a=new FormData;e.forEach((({imageData:e})=>{a.append("files",e)})),L.value&&x.value.forEach((e=>{a.append("img_list",e.title)})),y.post(`${is}/super_search?search_num=${I.value}`,a).then((e=>{const{data:a}=e;x.value=a.result.map((e=>({title:e,fileAddress:`${is}/static/${e}`,width:1920,height:1080,src:`${is}/static/${e}`}))),D.value=!1}))})(e):(()=>{const e=new FormData;e.append("file",s.value),L.value&&x.value.forEach((a=>{e.append("img_list",a.title)})),y.post(`${is}/search?search_num=${I.value}`,e).then((e=>{const{data:a}=e;x.value=a.result.map((e=>({title:e,fileAddress:`${is}/static/${e}`,width:1920,height:1080,src:`${is}/static/${e}`}))),D.value=!1}))})()}else"描述搜索"===A.value&&(L.value&&JSON.parse(JSON.stringify(x.value)).map((e=>e.title)),y.post(`${is}/text_search?text=${_.value}&search_num=${I.value}`).then((e=>{const{data:a}=e;x.value=a.result.map((e=>({title:e,fileAddress:`${is}/static/${e}`,width:1920,height:1080,src:`${is}/static/${e}`}))),D.value=!1})))},Y=e=>{s.value=null,h.value=null,k.value="",_.value="",A.value=e,m.value.handleChange(""),m.value.clearAll()},F=e=>{w.value.init(e)},U=({fileAddress:e})=>{window.open(e)};return n((()=>{m.value=new Nl(f.value)})),(l,s)=>{const i=e("el-icon"),n=e("el-button"),y=e("el-dropdown-item"),b=e("el-dropdown-menu"),X=e("el-dropdown"),O=e("el-upload"),W=e("el-input"),z=e("el-checkbox"),N=e("el-input-number"),j=e("el-form-item"),$=e("el-form"),H=e("el-scrollbar");return a(),o("div",$l,[c(Ga,{leftStyle:{width:"calc(50% - 55px)"}},{left:u((()=>[d("div",Hl,[d("div",null,[c(X,null,{dropdown:u((()=>[c(b,null,{default:u((()=>[c(y,{onClick:s[0]||(s[0]=e=>Y("图片搜索"))},{default:u((()=>[v("图片搜索")])),_:1}),c(y,{onClick:s[1]||(s[1]=e=>Y("描述搜索"))},{default:u((()=>[v("描述搜索")])),_:1})])),_:1})])),default:u((()=>[c(n,{type:"primary"},{default:u((()=>[v(g(A.value)+" ",1),c(i,{class:"el-icon--right"},{default:u((()=>[c(r(Z))])),_:1})])),_:1})])),_:1}),""===k.value&&h.value?(a(),t(n,{key:0,type:"primary",class:"title-handle-btn",onClick:s[2]||(s[2]=e=>S("selectionArea")),style:{"font-size":"12px"}},{default:u((()=>[c(i,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(V))])),_:1}),v(" 框选区域 ")])),_:1})):p("",!0),"selectionArea"===k.value&&h.value?(a(),t(n,{key:1,class:"title-handle-btn",type:"warning",onClick:s[3]||(s[3]=e=>S("")),style:{"font-size":"12px"}},{default:u((()=>[c(i,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(V))])),_:1}),v(" 框选区域 ")])),_:1})):p("",!0),h.value?(a(),t(n,{key:2,class:"title-handle-btn",type:"primary",onClick:s[4]||(s[4]=e=>{m.value.clearSelectionArea()}),style:{"font-size":"12px"}},{default:u((()=>[c(i,{style:{"vertical-align":"middle","margin-right":"10px"}},{default:u((()=>[c(r(C))])),_:1}),v(" 清空框选区域 ")])),_:1})):p("",!0),h.value?(a(),o("div",Gl,[d("div",Bl,[c(n,{onClick:s[5]||(s[5]=e=>M("left")),size:"small"},{default:u((()=>[v(" 左旋90° ")])),_:1}),c(n,{onClick:s[6]||(s[6]=e=>M("right")),size:"small"},{default:u((()=>[v(" 右旋90° ")])),_:1}),c(n,{onClick:s[7]||(s[7]=e=>M("horizontal")),size:"small"},{default:u((()=>[v(" 水平镜像 ")])),_:1}),c(n,{onClick:s[8]||(s[8]=e=>M("vertical")),size:"small"},{default:u((()=>[v(" 垂直镜像 ")])),_:1})]),Ql])):p("",!0)]),d("div",ql,["图片搜索"===A.value?(a(),t(O,{key:0,class:"upload-demo","before-upload":E,"show-file-list":!1,action:""},{default:u((()=>[c(n,{type:"text"},{default:u((()=>[v("上传图片")])),_:1})])),_:1})):p("",!0)])]),d("div",Jl,[P(d("canvas",{ref_key:"canvasDom",ref:f},null,512),[[R,"图片搜索"===A.value]]),P(c(W,{style:{height:"100%"},type:"textarea",modelValue:_.value,"onUpdate:modelValue":s[9]||(s[9]=e=>_.value=e),placeholder:"请输入图片描述"},null,8,["modelValue"]),[[R,"描述搜索"===A.value]])])])),center:u((()=>[d("div",Kl,[d("div",null,[c(z,{modelValue:L.value,"onUpdate:modelValue":s[10]||(s[10]=e=>L.value=e),style:{"margin-bottom":"10px"}},{default:u((()=>[v("基于上次"),es,v("结果搜索")])),_:1},8,["modelValue"]),c(n,{type:"primary",class:"title-handle-btn",onClick:s[11]||(s[11]=e=>T()),disabled:!h.value&&!_.value,loading:D.value},{default:u((()=>[v("搜索")])),_:1},8,["disabled","loading"])])])])),right:u((()=>[d("div",as,[ts,d("div",ls,[c($,null,{default:u((()=>[c(j,{label:"搜索数量"},{default:u((()=>[c(N,{modelValue:I.value,"onUpdate:modelValue":s[12]||(s[12]=e=>I.value=e),min:1,controls:!1},null,8,["modelValue"])])),_:1})])),_:1})])]),d("div",ss,[c(H,null,{default:u((()=>[D.value?p("",!0):(a(),t($t,{key:0,onHandleshowImage:F,onHandleOpenDir:U,columnCount:3,images:x.value},null,8,["images"]))])),_:1})])])),_:1},8,["leftStyle"]),c(il,{ref_key:"imageDialogDom",ref:w},null,512)])}}},[["__scopeId","data-v-589b370f"]]);const os={__name:"addOrUpdate",emits:["review"],setup(l,{expose:s,emit:n}){i([]);const r=i(!1),g=i({}),p=i("add"),f=i(["普通会员","超级会员"]),w=i(!1),b=n;return s({init:(e="add",a={name:"",valid_days:0,account_type:"普通会员",available_images:0})=>{g.value=a,p.value=e,r.value=!0}}),(l,s)=>{const i=e("el-input"),n=e("el-form-item"),p=e("el-input-number"),k=e("el-option"),x=e("el-select"),D=e("el-form"),C=e("el-button"),A=e("el-dialog");return a(),t(A,{title:"激活码",modelValue:r.value,"onUpdate:modelValue":s[5]||(s[5]=e=>r.value=e),"show-close":!1,width:"400","before-close":l.handleClose},{footer:u((()=>[d("div",null,[c(C,{onClick:s[4]||(s[4]=e=>(w.value=!0,void y.post("https://u248120-ac90-72cbfad9.westb.seetacloud.com:8443/demo/add_account",g.value).then((()=>{b("review"),w.value=!1,r.value=!1})).catch((e=>{e.includes("Network Error")?ElMessage.error("网络错误"):ElMessage.error("未知错误")})))),loading:w.value},{default:u((()=>[v("保存")])),_:1},8,["loading"])])])),default:u((()=>[c(D,{"label-width":"100px"},{default:u((()=>[c(n,{label:"用户名"},{default:u((()=>[c(i,{modelValue:g.value.username,"onUpdate:modelValue":s[0]||(s[0]=e=>g.value.username=e)},null,8,["modelValue"])])),_:1}),c(n,{label:"有效时长"},{default:u((()=>[c(p,{modelValue:g.value.valid_days,"onUpdate:modelValue":s[1]||(s[1]=e=>g.value.valid_days=e),controls:!1,precision:0,step:1,min:0},null,8,["modelValue"]),v("  天 ")])),_:1}),c(n,{label:"会员类型"},{default:u((()=>[c(x,{style:{width:"100%","text-align":"left"},modelValue:g.value.account_type,"onUpdate:modelValue":s[2]||(s[2]=e=>g.value.account_type=e)},{default:u((()=>[(a(!0),o(h,null,m(f.value,(e=>(a(),t(k,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(n,{label:"可用图片数量"},{default:u((()=>[c(p,{modelValue:g.value.available_images,"onUpdate:modelValue":s[3]||(s[3]=e=>g.value.available_images=e),controls:!1,precision:0,step:1,min:0},null,8,["modelValue"]),v("  张 ")])),_:1})])),_:1})])),_:1},8,["modelValue","before-close"])}}};const ds=e=>(f("data-v-52ff9cb6"),e=e(),w(),e),rs={class:"table-handle-area"},cs={class:"table-handle-info-area"},us={class:"table-area"},hs={class:"table-area-info"},ms={class:"table-area"},vs=ds((()=>d("br",null,null,-1))),gs=ds((()=>d("br",null,null,-1))),ps={class:"pagination-body"},fs="https://u248120-ac90-72cbfad9.westb.seetacloud.com:8443/demo";var ws=ee({__name:"index",setup(l){const s=i([]),r=i(1),h=i(10),m=i(!1),f=i(0),w=i([]);i(["普通会员","超级会员"]);const k=()=>{y.get(`${fs}/get_accounts`).then((({data:e})=>{w.value=e,x()})).catch((e=>{}))},x=()=>{const e=JSON.parse(JSON.stringify(w.value)).filter((({"用户名称":e})=>!C.value||e.includes(C.value)));s.value=e.splice((r.value-1)*h.value,(r.value-1)*h.value+h.value)},D=()=>{r.value=1,x()},C=i(null);return n((()=>{k()})),(l,i)=>{const n=e("el-input"),h=e("el-col"),A=e("el-button"),_=e("el-row"),I=e("el-table-column"),V=e("el-switch"),M=e("el-table"),S=e("el-pagination"),E=O("loading");return P((a(),o("div",{class:"main-body","element-loading-spinner":'<svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M60 30C60 46.5685 46.5685 60 30 60C13.4315 60 0 46.5685 0 30C0 13.4315 13.4315 0 30 0C46.5685 0 60 13.4315 60 30ZM9 30C9 41.598 18.402 51 30 51C41.598 51 51 41.598 51 30C51 18.402 41.598 9 30 9C18.402 9 9 18.402 9 30Z" fill="#E6EAEE"/>\n<path d="M45.6207 55.6124C39.8677 59.1211 33.1009 60.5907 26.4108 59.7845C19.7206 58.9783 13.4967 55.9432 8.74189 51.1682C3.98711 46.3932 0.978394 40.1565 0.200542 33.463C-0.577311 26.7695 0.921008 20.009 4.45407 14.2709C7.98712 8.53278 13.3492 4.15125 19.6761 1.83232C26.0031 -0.48661 32.9266 -0.607895 39.3309 1.48801C45.7353 3.58392 51.2475 7.77495 54.9793 13.3858C58.7112 18.9966 60.4454 25.7005 59.9025 32.4171L50.9317 31.692C51.3118 26.9903 50.0979 22.2976 47.4855 18.37C44.8732 14.4425 41.0147 11.5087 36.5317 10.0416C32.0486 8.57447 27.2022 8.65937 22.7733 10.2826C18.3444 11.9059 14.591 14.9729 12.1178 18.9896C9.64471 23.0063 8.59588 27.7386 9.14038 32.4241C9.68488 37.1096 11.791 41.4753 15.1193 44.8177C18.4477 48.1602 22.8044 50.2848 27.4875 50.8492C32.1706 51.4135 36.9074 50.3848 40.9345 47.9287L45.6207 55.6124Z" fill="#4075E5"/>\n</svg>\n',"element-loading-svg-view-box":"0, 0, 60, 60","element-loading-text":"加载中...","element-loading-background":"#ffffff"},[d("div",rs,[d("div",cs,[c(_,{gutter:20},{default:u((()=>[c(h,{span:4},{default:u((()=>[c(n,{onInput:D,placeholder:"用户名称",modelValue:C.value,"onUpdate:modelValue":i[0]||(i[0]=e=>C.value=e),clearable:""},null,8,["modelValue"])])),_:1}),c(h,{span:12},{default:u((()=>[v("   ")])),_:1}),c(h,{span:8,style:{"text-align":"right"}},{default:u((()=>[c(A,{type:"primary",onClick:i[1]||(i[1]=e=>{f.value.init()})},{default:u((()=>[v("添加激活码")])),_:1})])),_:1})])),_:1})])]),d("div",us,[d("div",hs,[d("div",ms,[c(M,{data:s.value,border:"",height:"100%"},{default:u((()=>[c(I,{label:"用户名称",prop:"用户名称",align:"center"}),c(I,{label:"激活码",prop:"API",align:"center"},{default:u((({row:e})=>[v(g(e.API)+" ",1),c(A,{type:"text",size:"small",onClick:a=>{return t=e.API,(l=document.createElement("textarea")).style.position="fixed",l.style.opacity=0,l.value=t,document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l),void b.success("复制成功");var t,l}},{default:u((()=>[v(" 复制 ")])),_:2},1032,["onClick"])])),_:1}),c(I,{label:"注册时间",prop:"注册时间",align:"center"}),c(I,{label:"到期时间",prop:"到期时间",align:"center"}),c(I,{label:"会员类型",prop:"会员类型",align:"center"},{default:u((({row:e})=>[v(g(e.会员类型)+" ",1),"普通会员"===e.会员类型?(a(),t(A,{key:0,type:"text",size:"small",onClick:a=>{return t=e.用户名称,m.value=!0,void y.post(`${fs}/upgrade_account`,{username:t}).then((()=>{k(),m.value=!1})).catch((e=>{}));var t}},{default:u((()=>[v("升级")])),_:2},1032,["onClick"])):p("",!0)])),_:1}),c(I,{label:"注册图片数目",prop:"注册图片数目",align:"center"}),c(I,{label:"可用图片数目",prop:"可用图片数目",align:"center"}),c(I,{label:"是否停用",align:"center",fixed:"right"},{default:u((({row:e})=>[c(V,{size:"small",modelValue:e.是否停用,"onUpdate:modelValue":a=>e.是否停用=a,onChange:a=>{return t=e.用户名称,m.value=!0,void y.post(`${fs}/ban_account`,{username:t}).then((()=>{m.value=!1})).catch((e=>{}));var t}},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),c(I,{label:"操作",align:"center",fixed:"right"},{default:u((({row:e})=>[c(A,{size:"small",style:{"margin-bottom":"5px"},onClick:a=>{return t=e.用户名称,void L.prompt("请输入延长时间","提示",{confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/[0-9]?/,inputErrorMessage:"请输入数字"}).then((({value:e})=>{m.value=!0,y.post(`${fs}/span_account`,{username:t,days:e}).then((()=>{m.value=!1,k(),b.success("修改成功")})).catch((e=>{}))})).catch((()=>{b({type:"info",message:"取消操作"})}));var t}},{default:u((()=>[v("延长时间")])),_:2},1032,["onClick"]),vs,c(A,{size:"small",style:{"margin-bottom":"5px"},onClick:a=>{return t=e.用户名称,void L.prompt("请输入增加数量","提示",{confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/[0-9]?/,inputErrorMessage:"请输入数字"}).then((({value:e})=>{m.value=!0,y.post(`${fs}/addImg_account`,{username:t,available_images:e}).then((()=>{m.value=!1,k(),b.success("修改成功")})).catch((e=>{}))})).catch((()=>{b({type:"info",message:"取消操作"})}));var t}},{default:u((()=>[v("增加次数")])),_:2},1032,["onClick"]),gs,c(A,{type:"danger",size:"small",onClick:a=>{return t=e.用户名称,m.value=!0,void y.post(`${fs}/delete_account`,{username:t}).then((()=>{m.value=!1,k()})).catch((e=>{}));var t}},{default:u((()=>[v("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d("div",ps,[c(S,{small:"",modelValue:r.value,"onUpdate:modelValue":i[2]||(i[2]=e=>r.value=e),onCurrentChange:i[3]||(i[3]=e=>x()),background:"",layout:"prev, pager, next",total:w.value.length},null,8,["modelValue","total"])])])])]),c(os,{ref_key:"addOrUpdateDom",ref:f,onReview:k},null,512)])),[[E,m.value]])}}},[["__scopeId","data-v-52ff9cb6"]]);const ys={},bs={class:"main-body"},ks=[(e=>(f("data-v-7883bf73"),e=e(),w(),e))((()=>d("iframe",{src:"http://47.88.56.24:5006/"},null,-1)))];var xs=ee(ys,[["render",function(e,t){return a(),o("div",bs,ks)}],["__scopeId","data-v-7883bf73"]]);const Ds={class:"image-list"},Cs=["onClick"],As="https://u248120-8f1e-2c47d43a.westb.seetacloud.com:8443";var _s=ee({__name:"addImageset",emits:["reviewImageset","reviewImage"],setup(l,{expose:s,emit:n}){const g=n,f=i(!1),w=i(null),D=i(null),C=i([]),_=i([]),I=i(null),L=i(null),V=["本地上传","网络图片"],M=()=>{L.value=null,f.value=!0,_.value=[],C.value=[]},S=e=>{const a=new FileReader;return a.onload=({target:a})=>{C.value.push(e),_.value.push(a.result)},a.readAsDataURL(e),!1},E=()=>{if(!C.value.length&&"本地图片"===I.value)return b.error("请上传图片后操作"),!1;if(!_.value.length&&"本地图片"!==I.value)return b.error("请搜索图片后操作"),!1;(null===D.value?"本地图片"===I.value?Y:R:P)().then((()=>{D.value?g("reviewImage"):g("reviewImageset"),f.value=!1}))},P=()=>{const e=new FormData;e.append("dataset",w.value),e.append("imageset",D.value),C.value.forEach((a=>{e.append("images",a)}));const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});return new Promise((t=>{y.post(`${As}/datasets/upload_image`,e).then((()=>{a.close(),b({type:"success",message:"操作成功"}),t()}))}))},R=()=>{const e=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});return new Promise((a=>{y.post(`${As}/datasets/add_imageset_spider`,{dataset:w.value,image_urls:_.value}).then((()=>{e.close(),b({type:"success",message:"操作成功"}),a()}))}))},T=()=>{const e=new FormData;e.append("web_url",L.value),y.post(`${As}/datasets/spider`,e).then((({data:e})=>{_.value=e,b({type:"success",message:"操作成功"})}))},Y=()=>{const e=new FormData;e.append("dataset",w.value),C.value.forEach((a=>{e.append("images",a)}));const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});return new Promise((t=>{y.post(`${As}/datasets/add_imageset`,e).then((()=>{a.close(),b({type:"success",message:"操作成功"}),t()}))}))};return s({init:(e,a=null)=>{w.value=e||w.value,D.value=a,L.value=null,I.value="本地上传",f.value=!0,_.value=[],C.value=[]}}),(l,s)=>{const i=e("el-segmented"),n=e("el-form-item"),g=e("el-button"),w=e("el-upload"),y=e("el-input"),b=e("el-image"),k=e("el-icon"),P=e("el-scrollbar"),R=e("el-form"),Y=e("el-dialog");return a(),t(Y,{modelValue:f.value,"onUpdate:modelValue":s[2]||(s[2]=e=>f.value=e),width:"800",title:D.value?"上传图片":"新建图片集"},{footer:u((()=>[c(g,{onClick:E},{default:u((()=>[v("保存")])),_:1})])),default:u((()=>[c(R,{"label-width":"100px"},{default:u((()=>[D.value?p("",!0):(a(),t(n,{key:0,label:"图片目标"},{default:u((()=>[c(i,{modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=e=>I.value=e),options:V,onChange:M},null,8,["modelValue"])])),_:1})),"本地上传"===I.value?(a(),t(n,{key:1,label:"上传图片"},{default:u((()=>[c(w,{class:"upload-demo","show-file-list":!1,accept:"image/*",action:"''",multiple:"","before-upload":S},{default:u((()=>[c(g,{size:"small"},{default:u((()=>[v(" 上传图片 ")])),_:1})])),_:1})])),_:1})):p("",!0),"网络图片"===I.value?(a(),t(n,{key:2,label:"网络地址"},{default:u((()=>[c(y,{modelValue:L.value,"onUpdate:modelValue":s[1]||(s[1]=e=>L.value=e),clearable:""},{append:u((()=>[c(g,{icon:r(W),onClick:T},null,8,["icon"])])),_:1},8,["modelValue"])])),_:1})):p("",!0),c(n,{label:"图片预览"},{default:u((()=>[d("div",Ds,[c(P,{height:"300px"},{default:u((()=>[(a(!0),o(h,null,m(_.value,((e,t)=>(a(),o("div",{class:"image-item",key:t},[c(b,{style:{width:"100%",height:"130px"},src:e,fit:"cover",lazy:""},null,8,["src"]),d("div",{class:"image-icon del",onClick:x((e=>(e=>{C.value.splice(e,1),_.value.splice(e,1)})(t)),["stop"])},[c(k,null,{default:u((()=>[c(r(A))])),_:1})],8,Cs)])))),128))])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])}}},[["__scopeId","data-v-3bf904a4"]]);const Is={key:1,class:"image-item"},Ls={class:"file-name"};var Vs=ee({__name:"addMockup",emits:["review"],setup(l,{expose:s,emit:n}){const h=i(!1),m=i(null),p=i(null),f=i(null),w=i(null),D=n,C=e=>{const a=new FileReader;return a.onload=({target:a})=>{m.value=e,p.value=a.result},a.readAsDataURL(e),!1},_=e=>(f.value=e,!1),I=()=>{if(!w.value)return void b.error("请输入样机名后操作");if(!m.value)return void b.error("请上传封面图后操作");if(!f.value)return void b.error("请上传样机psd后操作");const e=new FormData;e.append("psd_file",f.value),e.append("preview_file",m.value),e.append("mockup_name",w.value);const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});y.post("https://u248120-8f1e-2c47d43a.westb.seetacloud.com:8443/datasets/upload_mockup",e).then((({data:e})=>{a.close(),"错误的psd文件"!==e?(D("review"),h.value=!1,b({type:"success",message:"添加成功"})):b.error("请上传正确的psd文件")}))};return s({init:()=>{m.value=null,p.value=null,f.value=null,h.value=!0}}),(l,s)=>{const i=e("el-input"),n=e("el-form-item"),y=e("el-button"),b=e("el-upload"),k=e("el-image"),D=e("el-icon"),L=e("el-form"),V=e("el-dialog");return a(),t(V,{modelValue:h.value,"onUpdate:modelValue":s[2]||(s[2]=e=>h.value=e),width:"500",title:"添加样机"},{footer:u((()=>[c(y,{onClick:I},{default:u((()=>[v("保存")])),_:1})])),default:u((()=>[c(L,{"label-width":"100px"},{default:u((()=>[c(n,{label:"样机名称"},{default:u((()=>[c(i,{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=e=>w.value=e),clearable:""},null,8,["modelValue"])])),_:1}),c(n,{label:"上传封面图片"},{default:u((()=>[null===p.value?(a(),t(b,{key:0,class:"upload-demo","show-file-list":!1,accept:"image/*",action:"''","before-upload":C},{default:u((()=>[c(y,{size:"small"},{default:u((()=>[v(" 上传图片 ")])),_:1})])),_:1})):(a(),o("div",Is,[c(k,{style:{width:"100%",height:"130px"},src:p.value,fit:"cover",lazy:""},null,8,["src"]),d("div",{class:"image-icon del",onClick:s[1]||(s[1]=x((e=>(m.value=null,void(p.value=null))),["stop"]))},[c(D,null,{default:u((()=>[c(r(A))])),_:1})])]))])),_:1}),c(n,{label:"上传样机psd"},{default:u((()=>[d("div",Ls,g(null===f.value?"暂未上传":f.value.name),1),c(b,{class:"upload-demo","show-file-list":!1,accept:"image/vnd.adobe.photoshop,.psd",action:"''","before-upload":_},{default:u((()=>[c(y,{size:"small"},{default:u((()=>[v(" 上传样机 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-058b9088"]]);const Ms=e=>(f("data-v-7ef9b215"),e=e(),w(),e),Ss={class:"handle-area"},Es={class:"selected-all-area"},Ps={class:"select-all-item"},Rs=Ms((()=>d("div",{class:"select-all-name"},"样机",-1))),Ts={class:"select-all-item"},Ys=Ms((()=>d("div",{class:"select-all-name"},"数据集",-1))),Fs={class:"other-select-area"},Us={class:"select-list"},Xs=["onClick"],Os={class:"selected-name"},Zs={class:"select-list"},Ws=["onClick"],zs={class:"selected-name"},Ns={key:0,class:"progress-area"},js={class:"progress-item"},$s={class:"btn-area"},Hs="https://u248120-8f1e-2c47d43a.westb.seetacloud.com:8443";var Gs=ee({__name:"updateMockupImage",emits:["review"],setup(l,{expose:s,emit:n}){const r=i(!1),f=i([]),w=i([]),k=i(!1),D=i([]),C=i([]),A=i(!1),_=i(!0),L=i(1),V=i(1),M=i(!1),S=n,E=()=>{if(!w.value.length)return void b.error("请选择样机后操作");if(!C.value.length)return void b.error("请选择数据集后操作");const e=[];w.value.forEach((a=>{C.value.forEach((t=>{e.push({mockup:a,dataset:t})}))})),L.value=e.length+1,V.value=1,M.value=!0,e.forEach((({mockup:e,dataset:a})=>{const t=new FormData;t.append("mockup",e),t.append("dataset",a),y.post(`${Hs}/datasets/update_mockup_image`,t).then((()=>{V.value+=1,V.value===L.value&&(M.value=!1)})).catch((()=>{V.value+=1,V.value===L.value&&(M.value=!1)}))}))},P=()=>{r.value=!1,S("review")};return F(k,(e=>{_.value&&(w.value=e?JSON.parse(JSON.stringify(f.value)):[])})),F(A,(e=>{_.value&&(C.value=e?JSON.parse(JSON.stringify(D.value)):[])})),s({init:(e,a)=>{r.value=!0,f.value=e,D.value=a,L.value=1,V.value=1,w.value=[],C.value=[],k.value=!1,A.value=!1}}),(l,s)=>{const i=e("el-checkbox"),n=e("el-image"),y=e("el-scrollbar"),b=e("el-button"),S=e("el-dialog");return a(),t(S,{modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=e=>r.value=e),width:"800",title:"更新样机图片","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{default:u((()=>[d("div",Ss,[d("div",Es,[d("div",Ps,[Rs,c(i,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=e=>k.value=e),value:!0},{default:u((()=>[v("全选")])),_:1},8,["modelValue"])]),d("div",Ts,[Ys,c(i,{modelValue:A.value,"onUpdate:modelValue":s[1]||(s[1]=e=>A.value=e),value:!0},{default:u((()=>[v("全选")])),_:1},8,["modelValue"])])]),d("div",Fs,[d("div",Us,[c(y,null,{default:u((()=>[(a(!0),o(h,null,m(f.value,((e,t)=>{return a(),o("div",{class:T(["selected-item",{selected:(l=e,-1!==w.value.findIndex((e=>e===l)))}]),onClick:a=>(e=>{const a=w.value.findIndex((a=>a===e));a>=0?(1!==w.value.length&&(_.value=!1),k.value=!1,w.value.splice(a,1),z((()=>{_.value=!0}))):w.value.length+1===f.value.length?k.value=!0:w.value.push(e)})(e),key:t},[c(n,{style:{width:"50px",height:"50px","margin-right":"10px"},onClick:s[2]||(s[2]=x((()=>{}),["stop"])),previewSrcList:[`${Hs}/datasets/mockups/${e}`],src:`${Hs}/datasets/mockups/${e}`},null,8,["previewSrcList","src"]),d("div",Os,g(e),1)],10,Xs);var l})),128))])),_:1})]),d("div",Zs,[c(y,null,{default:u((()=>[(a(!0),o(h,null,m(D.value,((e,t)=>{return a(),o("div",{class:T(["selected-item",{selected:(l=e,-1!==C.value.findIndex((e=>e===l)))}]),onClick:a=>(e=>{const a=C.value.findIndex((a=>a===e));a>=0?(1!==C.value.length&&(_.value=!1),A.value=!1,C.value.splice(a,1),z((()=>{_.value=!0}))):C.value.length+1===D.value.length?A.value=!0:C.value.push(e)})(e),key:t},[d("div",zs,g(e),1)],10,Ws);var l})),128))])),_:1})])])]),L.value!==V.value?(a(),o("div",Ns,[d("div",js,[d("div",{class:"progress-info",style:I({width:V.value/L.value*100+"%"})},null,4)])])):p("",!0),d("div",$s,[M.value?p("",!0):(a(),t(b,{key:0,type:"primary",onClick:P},{default:u((()=>[v("关闭")])),_:1})),c(b,{type:"primary",disabled:M.value,onClick:E},{default:u((()=>[v("开始")])),_:1},8,["disabled"])])])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-7ef9b215"]]);const Bs={class:"main-body"},Qs={class:"dataset"},qs=(e=>(f("data-v-1ff63afe"),e=e(),w(),e))((()=>d("div",{class:"dataset-title"},"图像数据集",-1))),Js={class:"dataset-list"},Ks=["onClick"],ei={class:"dataset-handle"},ai={class:"add-dataset-btn"},ti={class:"handle-area"},li={class:"image-area"},si={class:"image-name"},ii=["onClick"],ni={key:3,class:"image-icon"},oi=["onClick"],di={class:"image-name"},ri="https://u248120-8f1e-2c47d43a.westb.seetacloud.com:8443";var ci=ee({__name:"index",setup(l){const s=i([]),f=i(0),w=i([]),D=i([]),C=i([]),_=i(null),I=i(null),V=i("addImagesetDom"),M=i("addMockupDom"),S=i("updateMockupImageDom"),E=()=>{w.value=[],y.get(`${ri}/datasets/datasets`).then((e=>{const{data:a}=e;s.value=a}))},P=()=>{f.value=0,w.value=[],_.value=null,I.value=null,y.get(`${ri}/datasets/mockups`).then((e=>{const{data:a}=e;D.value=a}))},R=e=>{const a=w.value.findIndex((e=>e===I.value));I.value=w.value[a+e],Z(I.value)},T=e=>{e=e||_.value,f.value=1,I.value=null,w.value=[];const a=new FormData;a.append("dataset",e),_.value=e,y.post(`${ri}/datasets/get_imagesets`,a).then((e=>{const{data:a}=e;w.value=a}))},Y=e=>{const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),t=new FormData;t.append("dataset",_.value),t.append("imageset",e),y.post(`${ri}/datasets/delete_imageset`,t).then((()=>{a.close(),T(),b({type:"success",message:"删除成功"})}))},F=e=>{const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),t=new FormData;t.append("dataset",_.value),t.append("imageset",I.value),t.append("image_name",e),y.post(`${ri}/datasets/delete_image`,t).then((()=>{a.close(),Z(),b({type:"success",message:"删除成功"})}))},U=()=>{V.value.init(_.value)},X=()=>{V.value.init(_.value,I.value)},O=()=>{S.value.init(D.value,s.value)},Z=e=>{e=e||I.value,I.value=e;const a=new FormData;a.append("dataset",_.value),a.append("imageset",e),y.post(`${ri}/datasets/get_images`,a).then((e=>{const{data:a}=e;C.value=a}))},W=()=>{M.value.init()},z=()=>{f.value=0,I.value=null,_.value=null,C.value=[],D.value=[],w.value=[],E(),P()};return n((()=>{z()})),(l,i)=>{const n=e("el-button"),$=e("el-scrollbar"),H=e("el-image"),G=e("el-icon");return a(),o("div",Bs,[c(Ga,null,{left:u((()=>[d("div",Qs,[d("label",{class:"dataset-name",onClick:i[0]||(i[0]=e=>P())},"样机数据集")]),qs,d("div",Js,[c($,null,{default:u((()=>[(a(!0),o(h,null,m(s.value,((e,t)=>(a(),o("div",{class:"dataset",key:t},[d("label",{class:"dataset-name",onClick:a=>T(e)},g(e),9,Ks),d("label",ei,[c(n,{type:"text",class:"text-btn",onClick:a=>{return t=e,void L.prompt("请输入数据集名称","提示",{confirmButtonText:"确认",cancelButtonText:"取消",inputValue:t}).then((({value:e})=>{if(s.value.find((a=>a===e)))return void b.error("数据集名称不可重复");const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),l=new FormData;l.append("dataset_name",t),l.append("new_name",e),y.post(`${ri}/datasets/rename_dataset`,l).then((()=>{a.close(),E(),b({type:"success",message:"修改成功"})}))})).catch((()=>{b({type:"info",message:"取消操作"})}));var t}},{default:u((()=>[v("重命名")])),_:2},1032,["onClick"]),c(n,{type:"text",class:"text-btn danger",onClick:a=>{return t=e,void L.confirm("此操作不可逆是否继续?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),a=new FormData;a.append("dataset_name",t),y.post(`${ri}/datasets/delete_dataset`,a).then((()=>{e.close(),E(),b({type:"success",message:"删除成功"})}))})).catch((()=>{b({type:"info",message:"取消删除"})}));var t}},{default:u((()=>[v("删除")])),_:2},1032,["onClick"])])])))),128))])),_:1})]),d("div",ai,[c(n,{style:{width:"100%"},type:"primary",onClick:i[1]||(i[1]=e=>{L.prompt("请输入数据集名称","提示",{confirmButtonText:"确认",cancelButtonText:"取消"}).then((({value:e})=>{if(!e)return void b.error("请输入数据集名称");if(s.value.find((a=>a===e)))return void b.error("数据集名称不可重复");const a=new FormData;a.append("dataset_name",e);const t=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});y.post(`${ri}/datasets/add_dataset`,a).then((()=>{t.close(),E(),b({type:"success",message:"添加成功"})}))})).catch((()=>{b({type:"info",message:"取消操作"})}))})},{default:u((()=>[v(" 添加图像数据集 ")])),_:1})])])),right:u((()=>[d("div",ti,[d("div",null,[I.value?(a(),t(n,{key:0,type:"text",onClick:i[2]||(i[2]=e=>(I.value=null,void(C.value=[])))},{default:u((()=>[v("返回")])),_:1})):p("",!0)]),d("div",null,[I.value?(a(),t(n,{key:0,onClick:i[3]||(i[3]=e=>R(-1)),disabled:0===w.value.findIndex((e=>e===I.value))},{default:u((()=>[v("上一组")])),_:1},8,["disabled"])):p("",!0),I.value?(a(),t(n,{key:1,onClick:i[4]||(i[4]=e=>R(1)),disabled:w.value.findIndex((e=>e===I.value))===w.value.length-1},{default:u((()=>[v("下一组")])),_:1},8,["disabled"])):p("",!0),0===f.value?(a(),t(n,{key:2,type:"primary",onClick:W},{default:u((()=>[v("新增样机数据")])),_:1})):p("",!0),c(n,{type:"primary",onClick:O},{default:u((()=>[v("更新样机图片")])),_:1}),1!==f.value||I.value?p("",!0):(a(),t(n,{key:3,onClick:U},{default:u((()=>[v("新增图片集")])),_:1})),1===f.value&&I.value?(a(),t(n,{key:4,onClick:X},{default:u((()=>[v("上传图片")])),_:1})):p("",!0)])]),d("div",li,[c($,null,{default:u((()=>[0===f.value?(a(!0),o(h,{key:0},m(D.value,((e,t)=>(a(),o("div",{class:"image-item",key:t},[c(H,{style:{width:"100%",height:"190px"},previewSrcList:[`${ri}/datasets/mockups/${e}`],src:`${ri}/datasets/mockups/${e}`,fit:"cover",lazy:""},null,8,["previewSrcList","src"]),d("div",si,g(e),1)])))),128)):p("",!0),1===f.value?(a(!0),o(h,{key:1},m(I.value?C.value:w.value,((e,l)=>(a(),o("div",{class:"image-item",key:l},[I.value?(a(),t(H,{key:0,style:{width:"100%",height:"190px"},previewSrcList:[`${ri}/datasets/datasets/${_.value}/${I.value}/${e}`],src:`${ri}/datasets/datasets/${_.value}/${I.value}/${e}`,fit:"cover",lazy:""},null,8,["previewSrcList","src"])):(a(),t(H,{key:1,style:{width:"100%",height:"190px"},fit:"cover",onClick:a=>Z(e),lazy:"",src:`${ri}/datasets/datasets/${_.value}/${e}/${e}`},null,8,["onClick","src"])),!I.value||I.value&&e!==I.value?(a(),o("div",{key:2,class:"image-icon del",onClick:x((a=>(e=>{L.confirm("此操作不可逆是否继续?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{I.value?F(e):Y(e)})).catch((()=>{b({type:"info",message:"取消操作"})}))})(e)),["stop"])},[c(G,null,{default:u((()=>[c(r(A))])),_:1})],8,ii)):p("",!0),I.value?p("",!0):(a(),o("div",ni,[c(G,null,{default:u((()=>[c(r(N))])),_:1})])),I.value&&e!==I.value?(a(),o("div",{key:4,class:"image-icon",onClick:x((a=>(e=>{const a=k.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),t=new FormData;t.append("dataset_name",_.value),t.append("imageset",I.value),t.append("image",e),y.post(`${ri}/datasets/set_main`,t).then((()=>{a.close(),Z();const t=w.value.findIndex((e=>e===I.value));w.value.splice(t,1,e),I.value=e,Z(),b({type:"success",message:"操作"})}))})(e)),["stop"])},[c(G,null,{default:u((()=>[c(r(j))])),_:1})],8,oi)):p("",!0),d("div",di,g(e),1)])))),128)):p("",!0)])),_:1})])])),_:1}),c(_s,{ref_key:"addImagesetDom",ref:V,onReviewImageset:T,onReviewImage:Z},null,512),c(Vs,{ref_key:"addMockupDom",ref:M,onReview:P},null,512),c(Gs,{ref_key:"updateMockupImageDom",ref:S,onReview:z},null,512)])}}},[["__scopeId","data-v-1ff63afe"]]);const ui="_AICLOTH_CONSOLE_",hi="_AICLOTH_CONSOLE__token";function mi(e){localStorage.setItem(ui+"USER",JSON.stringify(e))}function vi(){const e=$.get(hi);return""!==e||void 0!==e||null!==e?e:null}function gi(e,a){localStorage.setItem(ui+e,JSON.stringify(a))}const pi=y.create({baseURL:"http://www.weishih-ai.com:10010/dev-api",timeout:6e4,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}});function fi(e){if(!e.response)return b.error({message:"请求超时",description:`${e.toString()}`}),Promise.reject(e);vi();const a=e.response.status,t=e.response.data,{userStore:l}=ki;return 401===a?(b.error({message:"登录失效, 请重新登陆"}),l.handleLogout().then((()=>{setTimeout((()=>{xi.replace("/login")}),1500)}))):400!==a&&500!==a||b.error({message:t.message}),Promise.reject(e)}pi.interceptors.request.use((e=>{const a=vi()||"22";return a&&e.headers&&(e.headers["X-Auth-Token"]=a),e}),fi),pi.interceptors.response.use((e=>200===e.status?e.data||{}:Promise.reject("")),fi);const wi=H({id:"users",state:()=>({user:null,permissions:null,token:"",workingTenant:null}),getters:{getUser(){return this.user},getPermissions(){return this.permissions}},actions:{handleLogin(e){return new Promise(((a,t)=>{var l;(l=e,pi.post("/sso/api/v1/session/login",l)).then((e=>{const t=e.token;var l;this.token=t.token,this.user=t.user,this.workingTenant=t.working_tenant,gi("workingTenant",t.working_tenant),mi(t.user),l=t.token,$.set(hi,l,{expires:1}),a({...t.user,needPasswd:e.need_passwd}),pi.get("/sso/api/v1/roles").then((e=>{gi("roles",e.roles||[])}))})).catch((e=>{t(e)}))}))},handleLogout(e=""){return new Promise(((e,a)=>{$.remove(hi),localStorage.removeItem(ui+"USER"),this.user=null,this.permissions=null,this.token="",mi(null),e(null)}))},getUserInfo(){return new Promise(((e,a)=>{pi.get("/sso/api/v1/accounts/get").then((a=>{const t=function(){const e=localStorage.getItem(ui+"USER");return e&&"undefined"!==e?JSON.parse(e):null}()||{};Object.assign(t,a),this.user=t,mi(t);const l=[].concat([t.sys_role]);window.localStorage.setItem("ROLE_PERMISSIONS_LIST",JSON.stringify(l)),this.permissions=l,e(t)})).catch((e=>{a(e)}))}))}}});const yi={"./modules/user.js":Object.freeze(Object.defineProperty({__proto__:null,useUserStore:wi,setupStore:function(e){return wi(e)}},Symbol.toStringTag,{value:"Module"}))},bi=G(),ki={};Object.keys(yi).forEach((e=>{const a=e.match(/([a-zA-Z]*)\.js$/)[0].split(".")[0];ki[`${a}Store`]=yi[e].setupStore(bi)}));var xi=B({history:Q("/"),routes:[{path:"/",name:"home",component:ye,redirect:"/ImageGenerationImage",children:[{path:"imageSearch",name:"imageSearch",component:Cl},{path:"gallery",name:"gallery",component:zl},{path:"superImageSearch",name:"superImageSearch",component:ns},{path:"activationKeys",name:"activationKeys",component:ws},{path:"ImageGenerationImage",name:"ImageGenerationImage",component:da},{path:"swapFace",name:"swapFace",component:ja},{path:"partialModifications",name:"partialModifications",component:ft},{path:"trainModel",name:"trainModel",component:xs},{path:"imageSearchTrainDataset",name:"imageSearchTrainDataset",component:ci}]}]});if("undefined"!=typeof window){let e=function(){var e=document.body,a=document.getElementById("__svg__icons__dom__");a||((a=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",a.style.width="0",a.style.height="0",a.id="__svg__icons__dom__",a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("xmlns:link","http://www.w3.org/1999/xlink")),a.innerHTML="",e.insertBefore(a,e.lastChild)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}const Di=q(ae);Di.use(G()),Di.use(xi),Di.use(J,{locale:K}),Di.mount("#app");
