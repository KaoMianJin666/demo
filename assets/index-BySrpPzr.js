import{x as e,m as a,n as t,F as l,A as s,H as n,k as o,I as d,r as u,D as r,C as i,U as c,J as p,j as v,B as m,p as y,w as f,y as g,u as _,V as k,G as b,N as h,o as w,E as x,M as D,L as S}from"./lib-COXcuUSy.js";import{_ as j}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{T as R}from"./TLoading-DwqXYK7E.js";import{u as A,o as W}from"./opInput-3i8d36OJ.js";import{l as T}from"./logo2-l66aD4rS.js";import{u as C,_ as I}from"./index-CQfQ98fb.js";import O from"./index-6onSRwvu.js";import{a as V,g as E}from"./promptSetting-BXFCiAce.js";import{g as P}from"./artwork-CaWR8PeP.js";import L from"./index-Ckfi_zx2.js";import{m as U,c as M,h as N,a as q}from"./index-BHqcfl6J.js";/* empty css                                                                 */import{c as J,m as Y,d as z,e as $,h as B,k as F,n as G,o as H,q as K}from"./index-D2jkVZeO.js";import{a as Q,b as X,s as Z}from"./dataWarehouse-DHKQ3GOe.js";import{j as ee}from"./file-C3RgH22k.js";import"./syncSleep-DvzJnWfR.js";/* empty css                                                                */import"./modelCard-CSvj7zen.js";import"./menu-B85Lp49n.js";const ae={class:"page-count-body"},te={class:"page-count-inner"},le=["num"],se=j({__name:"pageCount",props:{pageData:{type:Array(),default:()=>[]},now:{type:Number,default:0}},emits:["addPage"],setup(u,{emit:r}){const i=r,c=u,p=e(c,"pageData"),v=e(c,"now");return(e,u)=>(o(),a("div",ae,[t("div",te,[p.value.length>1?(o(!0),a(l,{key:0},s(p.value,((e,l)=>{return o(),a("div",{class:"page-count",style:d((s=l,s===v.value?{transform:"translateY(0rem)"}:s>v.value?{transform:"translateY(100%)"}:s<v.value?{transform:"translateY(-100%)"}:void 0)),key:l},u[1]||(u[1]=[t("div",{class:"page-count-line"},null,-1),t("label",null,null,-1)]),4);var s})),128)):n("",!0),v.value===p.value.length-1?(o(),a("div",{key:1,class:"add-btn",num:p.value.length,onClick:u[0]||(u[0]=e=>{i("addPage")})},u[2]||(u[2]=[t("div",{class:"page-count-line"},null,-1),t("label",null,"+",-1)]),8,le)):n("",!0)])]))}},[["__scopeId","data-v-95a86af8"]]),ne=j({__name:"modelSelectedDialog",props:["type"],emits:["setData"],setup(t,{expose:l,emit:s}){const{publicStore:d}=C(),p=s,v=e(d,"isCarryOut"),m=u(!1),y=e=>{p("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(e,l)=>(o(),r(c,{to:"body"},[m.value?(o(),a("div",{key:0,class:i(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(o(),r(O,{key:0,componentType:"component",type:t.type,onSetData:y},null,8,["type"])):n("",!0)],2)):n("",!0)]))}},[["__scopeId","data-v-15493417"]]),oe={class:"json-editor-body"},de={class:"input-area"},ue={key:1},re={key:2,class:"image-area"},ie=["src"],ce={class:"add-image-area"},pe=j({__name:"jsonEditor",props:{modelValue:{default:()=>[{key:"",code:null,value:null}]},list:{default:!1}},emits:["update:modelValue"],setup(e,{expose:d,emit:c}){const h=k((()=>I((()=>Promise.resolve().then((()=>ve))),void 0))),w=[{name:"文本",code:"text"},{name:"图片",code:"image"},{name:"字典",code:"map"},{name:"列表",code:"list"}],x=u(e.modelValue),D=c;p(x.value,(e=>{D("update:modelValue",e)}));const S=()=>{x.value.push({key:"",code:null,value:null})},j=(e=x.value,a="map")=>{const t="map"===a?{}:[];return e.forEach((({key:e,code:l,value:s},n)=>{if(l)switch(l){case"text":case"image":"map"===a?t[e]=s:t[n]=s;break;case"list":"map"===a?t[e]=j(s,"list"):t[n]=j(s,"list");break;case"map":"map"===a?t[e]=j(s):t[n]=j(s)}})),t},R=(e={},a="map")=>{let t=[];return Object.keys(e).forEach((a=>{const l={key:a,code:null,value:null};Array.isArray(e[a])?e[a].every((e=>e.includes("http")))?(l.code="image",l.value=e[a]):(l.code="list",l.value=R(e[a]).map((e=>(e.key=null,e)))):"string"==typeof e[a]?(l.code="text",l.value=e[a]):(l.code="map",l.value=R(e[a])),t.push(l)})),t};return d({getData:()=>x.value,getSaveData:j,init:e=>{const a=e[0],t=R(a);x.value=t}}),(d,u)=>{const c=v("n-input"),p=v("n-button"),k=v("n-upload");return o(),a("div",oe,[t("div",de,[(o(!0),a(l,null,s(x.value,((d,v)=>(o(),a("div",{class:"input-group",key:v},[t("div",{class:i(["input-key",{list:e.list,unlist:!e.list}])},[e.list?(o(),a("label",ue,m(v+1),1)):(o(),r(c,{key:0,value:d.key,"onUpdate:value":e=>d.key=e,placeholder:"键名称"},null,8,["value","onUpdate:value"]))],2),t("div",{class:i(["input-value",{list:e.list,unlist:!e.list}])},[d.code?n("",!0):(o(),a(l,{key:0},s(w,(e=>y(p,{class:"type-btn",key:e.code,onClick:a=>((e,a)=>{switch(e.code=a,a){case"text":e.value=null;break;case"image":case"map":case"list":e.value=[]}})(d,e.code)},{default:f((()=>[g(m(e.name),1)])),_:2},1032,["onClick"]))),64)),"text"===d.code?(o(),r(c,{key:1,value:d.value,"onUpdate:value":e=>d.value=e,placeholder:"请输入文本",type:"textarea"},null,8,["value","onUpdate:value"])):n("",!0),"image"===d.code?(o(),a("div",re,[(o(!0),a(l,null,s(d.value,((e,l)=>(o(),a("div",{class:"image-item",key:`image-${l}`},[t("img",{src:e},null,8,ie)])))),128)),t("div",ce,[y(k,{"show-file-list":!1,accept:"image/*",action:"",onBeforeUpload:(...e)=>((e,{file:a})=>{const t=b(),l=new FormData;return l.append("file",a.file),A(t,l).then((a=>{200===a.code&&x.value[e].value.push(a.data)})),!1})(v,...e)},{default:f((()=>u[0]||(u[0]=[t("i",{class:"bi bi-plus"},null,-1)]))),_:2},1032,["onBeforeUpload"])])])):n("",!0),"map"===d.code?(o(),r(_(h),{key:3,class:"inline",modelValue:d.value,"onUpdate:modelValue":e=>d.value=e},null,8,["modelValue","onUpdate:modelValue"])):n("",!0),"list"===d.code?(o(),r(_(h),{key:4,list:!0,class:"inline",modelValue:d.value,"onUpdate:modelValue":e=>d.value=e},null,8,["modelValue","onUpdate:modelValue"])):n("",!0)],2)])))),128)),t("div",{class:i(["add-area",{list:e.list,unlist:!e.list}])},[t("label",{onClick:S},"+")],2)])])}}},[["__scopeId","data-v-477d4a69"]]),ve=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"})),me={class:"model-selected-title"},ye={class:"model-selected-title-text"},fe={key:0,class:"other-data-area"},ge={key:1,class:"selected-data-area"},_e=["onClick"],ke={class:"card-tags"},be=j({__name:"modelSelected",props:{type:{},data:{default:()=>[]}},setup(d,{expose:r}){const{publicStore:c}=C(),p=e(c,"isCarryOut"),_=d,k=u(null),b=u(null),w=u(0),x={prompts:"动态",statics:"静态",texts:"文字",colors:"调色板",designs:"设计理念"},D={prompts:["resource_id","preview","resource_name","description","keywords","trigger","server_type"],statics:["resource_id","preview","resource_name","description","keywords","cloud_folder"],texts:["resource_id","preview","resource_name","description","keywords","cloud_folder"],colors:["resource_id","preview","resource_name","description","keywords","colors"]},S=u(_.data[0]?_.data[0].value:[]),j=()=>{k.value.init()},R=e=>{V(e.resource_id).then((e=>{if(200===e.code)if("designs"===_.type){const a=Object.assign({data:e.data},e.info);S.value.push(a)}else{const a=Object.assign(e.data,e.info);S.value.push(a)}}))},A=e=>{const a={};return D[_.type]?(D[_.type].forEach((t=>{a[t]=e[t]})),a):e.data?Object.assign(e.data,{resource_id:e.resource_id,preview:e.preview}):{resource_id:e.resource_id,preview:e.preview}};return r({getSaveData:()=>({role:"database",type:`${x[_.type]}资源参考`,content:[{type:"json",value:S.value.map((e=>A(e)))}]})}),(e,u)=>{const r=v("n-scrollbar"),c=v("n-image"),_=v("n-tag"),D=v("n-space");return o(),a("div",{class:i(["model-selected-body",{expand:!p.value}])},[t("div",me,[t("div",ye," 选择"+m(x[d.type])+"资源 ",1)]),1===w.value?(o(),a("div",fe,[y(r,{onWheel:u[0]||(u[0]=h((()=>{}),["stop"]))},{default:f((()=>[y(pe,{ref_key:"jsonEditorRef",ref:b},null,512)])),_:1})])):n("",!0),0===w.value?(o(),a("div",ge,[(o(!0),a(l,null,s(S.value,((e,l)=>(o(),a("div",{class:"card",key:e.resource_id},[t("div",{class:"remove-btn",onClick:e=>(e=>{S.value.splice(e,1)})(l)},u[1]||(u[1]=[t("i",{class:"bi bi-x-circle"},null,-1)]),8,_e),y(c,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),t("div",ke,[y(D,null,{default:f((()=>[y(_,{bordered:!1},{default:f((()=>u[2]||(u[2]=[g(" 家纺平面设计 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[3]||(u[3]=[g(" 卡通风格和可爱ins风 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[4]||(u[4]=[g(" 奶牛 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[5]||(u[5]=[g(" 胡萝卜 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[6]||(u[6]=[g(" 樱桃 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[7]||(u[7]=[g(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),S.value.length<3?(o(),a("div",{key:0,class:"card",onClick:j},u[8]||(u[8]=[t("i",{class:"bi bi-plus"},null,-1)]))):n("",!0)])):n("",!0),y(ne,{type:d.type,ref_key:"modelSelectedDialogRef",ref:k,onSetData:R},null,8,["type"])],2)}}},[["__scopeId","data-v-022aff06"]]),he={class:"other-data-area"},we=j({__name:"generateDemandAnalysis",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:n}=C(),d=e(n,"isCarryOut"),r=l,c=u([]);u(null);const p=u(null);u(0),u([]);return w((()=>{r.data&&r.data[0]&&(c.value=p.value.init(r.data[0].value))})),s({getSaveData:()=>({role:"system",type:"需求分析",content:[{type:"json",value:[p.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return o(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 生成需求分析 ")],-1)),t("div",he,[y(s,{onWheel:l[0]||(l[0]=h((()=>{}),["stop"]))},{default:f((()=>[y(pe,{ref_key:"jsonEditorRef",ref:p},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-662a6d25"]]),xe={class:"other-data-area"},De=j({__name:"generateText",setup(l){const{publicStore:s}=C(),n=e(s,"isCarryOut");return(e,l)=>{const s=v("n-input");return o(),a("div",{class:i(["model-selected-body",{expand:!n.value}])},[l[0]||(l[0]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 生成文本段落 ")],-1)),t("div",xe,[y(s,{type:"textarea",placeholder:"请输入文本段落",style:{height:"100%"},resize:"none"})])],2)}}},[["__scopeId","data-v-5c1fa973"]]),Se=j({__name:"artworkSelectedDialog",props:["type"],emits:["setData"],setup(t,{expose:l,emit:s}){const{publicStore:d}=C(),p=s,v=e(d,"isCarryOut"),m=u(!1),y=e=>{p("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(e,l)=>(o(),r(c,{to:"body"},[m.value?(o(),a("div",{key:0,class:i(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(o(),r(L,{key:0,componentType:"component",type:t.type,onSetData:y},null,8,["type"])):n("",!0)],2)):n("",!0)]))}},[["__scopeId","data-v-05088086"]]),je={key:0,class:"selected-data-area"},Re=["onClick"],Ae={class:"card-tags"},We={key:1,class:"selected-data-area"},Te=j({__name:"artWorkSelected",props:{type:{},data:{default:()=>[]}},setup(d,{expose:c}){b();const{publicStore:p}=C(),m=e(p,"isCarryOut"),_=d,k=u(null);u(null);const h=u(_.data[0]&&"generateArtWork"===_.type?1:0),w=u(_.data[0]?_.data[0].value:[]),S=u(_.data[0]?_.data[0].value:[]),j=x(),R=u([]),A=u([]),W=u([]),T=u([]),I=u({template_filter:"nomal",template_level:"nomal",points:1}),O=u(!1),V=u(null),L=u({canvasData:{name:j.query.file_name||"",width:2048,height:2048}}),J=u({groups:{},layers:{},elements:{}}),Y=u(!1),z=e=>new Promise((a=>{P(e).then((e=>{L.value=Object.assign(L.value,e.data.viewData),L.value.canvasData.name=e.info.artwork_name,J.value=e.data.layerData,I.value=e.info,Y.value=!0,a()}))})),$=e=>{Promise.all([new Promise((e=>{E("colors").then((a=>{W.value=a.data,e()}))})),new Promise((e=>{E("texts").then((a=>{T.value=a.data,e()}))})),new Promise((e=>{E("prompts").then((a=>{R.value=a.data,e()}))})),new Promise((e=>{E("statics").then((a=>{A.value=a.data,e()}))})),z(e)]).then((()=>{O.value=!0}))},B=()=>{k.value.init()},F=e=>{w.value.push(e),"generateArtWork"===_.type&&(V.value=e.artwork_id,h.value=1,Y.value=!1,G())},G=async(e=V.value)=>{Y.value||(h.value||"generateArtWork"===_.type)&&(M(),S.value.length?(Y.value=!0,D((()=>{S.value.forEach((async e=>{await N(e)}))}))):e?$(e):Y.value=!0)};return c({hideView:()=>{if("generateArtWork"===_.type){if(!Y.value)return;Y.value=!1,S.value.length<q.length&&(S.value=JSON.parse(JSON.stringify(q))),S.value.length&&M()}else"selectedArtWork"===_.type&&(Y.value=!1)},initView:G,getSaveData:()=>"generateArtWork"===_.type?(h.value&&Y.value&&(S.value=JSON.parse(JSON.stringify(q))),{role:"system",type:"生成操作链",content:[{type:"json",value:S.value}]}):"selectedArtWork"===_.type?{role:"system",type:"作品资源参考",content:[{type:"json",value:w.value}]}:void 0}),(e,d)=>{const u=v("n-image"),c=v("n-tag"),p=v("n-space");return o(),a("div",{class:i(["model-selected-body",{expand:!m.value}])},[d[8]||(d[8]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"},"生成作品资源")],-1)),0===h.value?(o(),a("div",je,[(o(!0),a(l,null,s(w.value,((e,l)=>(o(),a("div",{class:"card",key:e.artwork_id},[t("div",{class:"remove-btn",onClick:e=>(e=>{w.value.splice(e,1)})(l)},d[0]||(d[0]=[t("i",{class:"bi bi-x-circle"},null,-1)]),8,Re),y(u,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),t("div",Ae,[y(p,null,{default:f((()=>[y(c,{bordered:!1},{default:f((()=>d[1]||(d[1]=[g(" 家纺平面设计 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[2]||(d[2]=[g(" 卡通风格和可爱ins风 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[3]||(d[3]=[g(" 奶牛 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[4]||(d[4]=[g(" 胡萝卜 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[5]||(d[5]=[g(" 樱桃 ")]))),_:1}),y(c,{bordered:!1},{default:f((()=>d[6]||(d[6]=[g(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),t("div",{class:"card",onClick:B},d[7]||(d[7]=[t("i",{class:"bi bi-plus"},null,-1)]))])):n("",!0),1===h.value?(o(),a("div",We,[Y.value?(o(),r(U,{key:0,colorsList:W.value,textsList:T.value,editorType:"generate",promptsList:R.value,staticsList:A.value,setting:L.value,layerData:J.value,templateId:V.value,info:I.value,needOpInput:!1,needTaskList:!1,needDelete:!1},null,8,["colorsList","textsList","promptsList","staticsList","setting","layerData","templateId","info"])):n("",!0)])):n("",!0),y(Se,{ref_key:"artworkSelectedDialogRef",ref:k,onSetData:F},null,512)],2)}}},[["__scopeId","data-v-9bdb3df6"]]),Ce={class:"other-data-area"},Ie=j({__name:"selectedDisplay",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:n}=C(),d=e(n,"isCarryOut"),r=l,c=u([]);u(null);const p=u(null);u(0),u([]);return w((()=>{r.data&&r.data[0]&&(c.value=p.value.init(r.data[0].value))})),s({getSaveData:()=>({role:"system",type:"参考资源分析",content:[{type:"json",value:[p.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return o(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 选择布局资源 ")],-1)),t("div",Ce,[y(s,{onWheel:l[0]||(l[0]=h((()=>{}),["stop"]))},{default:f((()=>[y(pe,{ref_key:"jsonEditorRef",ref:p},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-d2977504"]]),Oe={class:"other-data-area"},Ve=j({__name:"referenceResource",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:n}=C(),d=e(n,"isCarryOut"),r=l,c=u([]);u(null);const p=u(null);u(0),u([]);return w((()=>{r.data&&r.data[0]&&(c.value=p.value.init(r.data[0].value))})),s({getSaveData:()=>({role:"system",type:"参考资源分析",content:[{type:"json",value:[p.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return o(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 参考资源分析 ")],-1)),t("div",Oe,[y(s,{onWheel:l[0]||(l[0]=h((()=>{}),["stop"]))},{default:f((()=>[y(pe,{ref_key:"jsonEditorRef",ref:p},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-606af7f2"]]),Ee={key:0,class:"set-data-area"},Pe={key:1,class:"init-area"},Le=["onClick"],Ue={class:"init-card-info"},Me={class:"icon"},Ne={class:"name"},qe={class:"content"},Je={class:"type"},Ye=j({__name:"pageItem",props:{count:{type:Number,default:0},now:{type:Number,default:0},data:{}},setup(c,{expose:p}){const v={input:"搜索资源",output:"生成结果"},y=c,f=u(null),g=u(null),_={selectedModelRef:u(null),generateDemandAnalysisRef:u(null),referenceResourceRef:u(null),generateTextRef:u(null),generateArtWorkRef:u(null),selectedArtWorkRef:u(null),selectedDisplayRef:u(null)},k=e(y,"count"),b=e(y,"now"),h=e(y,"data"),x=["动态资源参考","静态资源参考","文字资源参考","调色板资源参考","设计理念资源参考","布局资源参考","作品资源参考","参考资源分析","需求分析","生成操作链"],S=[{name:"选择动态资源",content:"选择可参考的动态资源",icon:J,cardType:"input",code:"selectedModel",type:"prompts"},{name:"选择静态资源",content:"选择可参考的静态资源",icon:Y,cardType:"input",code:"selectedModel",type:"statics"},{name:"选择文字资源",content:"选择可参考的文字资源",icon:z,cardType:"input",code:"selectedModel",type:"texts"},{name:"选择调色板",content:"合理且舒适的颜色搭配",icon:$,cardType:"input",code:"selectedModel",type:"colors"},{name:"选择设计理念",content:"无数种设计思想的集合",icon:B,cardType:"input",code:"selectedModel",type:"designs"},{name:"选择作品资源",content:"选择用户需要的作品资源",icon:F,cardType:"input",code:"selectedArtWork",type:"prompts"},{name:"选择布局资源",content:"选择需要生成设计的布局",icon:G,cardType:"input",code:"selectedDisplay",type:"prompts"},{name:"参考资源分析",content:"生成用户需求的参考分析",icon:H,cardType:"output",code:"referenceResource",type:""},{name:"生成需求分析",content:"生成用户需求的模板分析",icon:K,cardType:"output",code:"generateDemandAnalysis",type:""},{name:"生成作品资源",content:"生成用户需要的模板资源",icon:F,cardType:"output",code:"generateArtWork",type:"designs"}],j=(e=k.value)=>e===b.value+1?("generateArtWork"===f.value&&(_.generateArtWorkRef.value?_.generateArtWorkRef.value.initView():D((()=>{_.generateArtWorkRef.value.initView()}))),{top:"0rem",zIndex:1}):("generateArtWork"===f.value&&(_.generateArtWorkRef.value?_.generateArtWorkRef.value.hideView():D((()=>{_.generateArtWorkRef.value.hideView()}))),{display:"none"});return w((()=>{if(h.value.type){const e=x.findIndex((e=>e===h.value.type));f.value=S[e].code,g.value=S[e].type}})),p({getSaveData:()=>f.value?_[`${f.value}Ref`].value.getSaveData():null}),(e,u)=>(o(),a("div",{class:"page-item-body",style:d(j())},[null!==f.value?(o(),a("div",Ee,["selectedModel"===f.value?(o(),r(be,{key:0,type:g.value,data:h.value.content,ref:_.selectedModelRef},null,8,["type","data"])):n("",!0),"generateDemandAnalysis"===f.value?(o(),r(we,{key:1,data:h.value.content,ref:_.generateDemandAnalysisRef},null,8,["data"])):n("",!0),"referenceResource"===f.value?(o(),r(Ve,{key:2,data:h.value.content,ref:_.referenceResourceRef},null,8,["data"])):n("",!0),"selectedDisplay"===f.value?(o(),r(Ie,{key:3,data:h.value.content,ref:_.selectedDisplayRef},null,8,["data"])):n("",!0),"generateText"===f.value?(o(),r(De,{key:4,data:h.value.content,ref:_.generateTextRef},null,8,["data"])):n("",!0),"selectedArtWork"===f.value||"generateArtWork"===f.value?(o(),r(Te,{key:5,data:h.value.content,type:f.value,ref:_[`${f.value}Ref`]},null,8,["data","type"])):n("",!0)])):n("",!0),null===f.value?(o(),a("div",Pe,[(o(),a(l,null,s(S,((e,a)=>t("div",{class:"init-card",key:a,onClick:a=>(({code:e,type:a})=>{f.value=e,g.value=a})(e)},[t("div",Ue,[t("div",Me,[t("i",{class:i(["bi",e.icon])},null,2)]),t("div",Ne,m(e.name),1),t("div",qe,m(e.content),1),t("div",Je,m(v[e.cardType]),1)])],8,Le))),64))])):n("",!0)],4))}},[["__scopeId","data-v-09dca004"]]),ze={class:"page-ouoter-body"},$e=j({__name:"pageOuter",props:{count:{type:Number,default:0},now:{type:Number,default:0},pageData:{type:Array,default:()=>[]}},setup(t,{expose:n}){const d=t,i=u(null);n({getSaveData:()=>{const e=[];return i.value.forEach((a=>{const t=a.getSaveData();t&&e.push(t)})),e}});const c=e(d,"pageData");e(d,"count");const p=e(d,"now");return(e,t)=>(o(),a("div",ze,[(o(!0),a(l,null,s(c.value,((e,a)=>(o(),r(Ye,{ref_for:!0,ref_key:"page",ref:i,data:e,key:e.uuid,count:a+1,now:p.value},null,8,["data","count","now"])))),128))]))}},[["__scopeId","data-v-6b49b489"]]),Be={class:"page-count"},Fe={class:"data-warehouse-editor"},Ge={class:"data-warehouse-editor-input-box"},He={class:"logo-area"},Ke=["src"],Qe={class:"data-warehouse-editor-input-area"},Xe={class:"data-warehouse-editor-view"},Ze=j({__name:"index",setup(l){const s=S(),n=x(),d=e(n.query,"id"),r=u(n.query.type),i=u(0),c=u(null),p=u(null),m=u([]),k=u(!1),D=e=>{if(e.preventDefault(),!k.value){if(k.value=!0,setTimeout((()=>{k.value=!1}),500),e.deltaY<0){if(i.value-1<0)return;i.value--}else if(e.deltaY>0){if(i.value+1>m.value.length-1)return;i.value++}e.stopPropagation()}},j=()=>{m.value.push({}),i.value=m.value.length-1},A=()=>{const e=p.value.getSaveData(),a=ee(e,String((new Date).getTime())),t=new FormData;t.append("file",a),d.value||0===d.value?X({data_id:d.value,data_type:r.value,data_status:"进行中",formData:t}).then((e=>{200===e.code&&s.success("更新成功")})):Z({data_type:r.value,data_status:"进行中",formData:t}).then((e=>{200===e.code&&(d.value=e.data.data_id,s.success("保存成功"))}))};return w((()=>{window.loading||(window.loading=R()),d.value?Q({data_id:d.value}).then((e=>{200===e.code&&(m.value=e.data.map((e=>(e.uuid=b(),e))))})):m.value=[{}],setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300)})),(e,l)=>{const s=v("n-button");return o(),a("div",{class:"data-warehouse-editor-body",onWheel:h(D,["stop"]),tabindex:"0"},[t("div",Be,[y(se,{pageData:m.value,now:i.value,onAddPage:j},null,8,["pageData","now"])]),t("div",Fe,[t("div",Ge,[t("div",He,[t("img",{src:_(T)},null,8,Ke),l[0]||(l[0]=t("label",null,"Oplus",-1))]),t("div",Qe,[y(W,{style:{"box-shadow":"var(--op-thr-shadow)"},ref_key:"opInputRef",ref:c},null,512)]),y(s,{class:"save-btn",size:"large",onClick:A},{default:f((()=>l[1]||(l[1]=[g("保存数据")]))),_:1})]),l[2]||(l[2]=t("div",{class:"message"}," 参考其他的设计作品，查看是否有喜欢的风格布局或者元素，把它加入你的设计理念中！ ",-1)),t("div",Xe,[y($e,{now:i.value,pageData:m.value,ref_key:"pageOuterRef",ref:p},null,8,["now","pageData"])])])],32)}}},[["__scopeId","data-v-c795700a"]]);export{Ze as default};
