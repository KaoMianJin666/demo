import{_ as e}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{x as a,k as t,m as l,B as s,n,C as o,u as i,L as d,v as u,r,j as c,D as v,w as p,p as g,y,F as _,A as m,O as w,o as b,R as h,S as k,U as f}from"./lib-CGZrokFx.js";import{a as x,x as T}from"./index-DBr3Z3sO.js";import{T as C}from"./TLoading-iM_Jx5sS.js";import{g as j,d as I}from"./dataWarehouse-f8CJaR3G.js";import"./index-CycG4A1b.js";/* empty css                                                                 */const U=["type"],D=e({__name:"tableTag",props:{type:{type:String,default:"doing"}},setup(e){const n=a(e,"type"),o={done:"完成",doing:"进行中",design:"需求设计",revision:"设计微调"};return(e,a)=>(t(),l("div",{class:"table-tag-body",type:n.value},s(o[n.value]),9,U))}},[["__scopeId","data-v-df067714"]]),E={class:"table-btns"},V={class:"table-btn"},B={class:"table-btn"},S=e({__name:"tableBtn",emits:["toEdit","toDel"],setup(e,{emit:a}){const s=a;return(e,a)=>(t(),l("div",E,[n("div",V,[n("i",{class:o(["bi",i(x)]),onClick:a[0]||(a[0]=e=>s("toEdit"))},null,2)]),n("div",B,[n("i",{class:o(["bi",i(T)]),onClick:a[1]||(a[1]=e=>s("toDel"))},null,2)])]))}},[["__scopeId","data-v-1c71de1e"]]),W={class:"ware-house-area"},q=["onClick"],z={class:"footer"},A=e({__name:"wareHouseType",setup(e,{expose:a}){const i=d(),w=u(),b=r(!1),h=r(null),k=r(["需求设计","设计微调"]),f=()=>{if(!h.value)return i.error("请选择数据类型后操作"),!1;((e,a=null)=>{window.loading=C(),w.push({path:"/basic/dataWarehouseEditor",query:{id:a,type:e}})})(h.value),b.value=!1};return a({init:()=>{b.value=!0}}),(e,a)=>{const i=c("n-button"),d=c("n-card"),u=c("n-modal");return t(),v(u,{show:b.value,"onUpdate:show":a[1]||(a[1]=e=>b.value=e),"auto-focus":!1},{default:p((()=>[g(d,{title:"请选择数据类型",bordered:!1,size:"huge",style:{width:"15rem"},role:"dialog","aria-modal":"true"},{"header-extra":p((()=>a[2]||(a[2]=[]))),footer:p((()=>[n("div",z,[g(i,{onClick:a[0]||(a[0]=e=>f())},{default:p((()=>a[4]||(a[4]=[y("确认")]))),_:1})])])),default:p((()=>[n("div",W,[(t(!0),l(_,null,m(k.value,((e,i)=>(t(),l("div",{class:"ware-house-item",onClick:a=>h.value=e,key:i},[n("div",{class:o(["selected-mark",{show:e===h.value}])},a[3]||(a[3]=[n("i",{class:"bi bi-check"},null,-1)]),2),y(" "+s(e),1)],8,q)))),128))])])),_:1})])),_:1},8,["show"])}}},[["__scopeId","data-v-cd3dae81"]]),F={class:"data-warehouse-body"},H={class:"data-warehouse-sub-title"},L={class:"table-area"},N=e({__name:"index",setup(e){const a=d(),o=w(),i=u(),v=r([]),_=r(null),m=k({props:{value:[String,Number],onUpdateValue:[Function,Array]},setup(e){const a=r(!1),t=r(null),l=r(e.value);function s(){a.value=!0,nextTick((()=>{t.value.focus()}))}function n(){e.onUpdateValue(l.value),a.value=!1}return()=>h("div",{style:"min-height: 22px",onClick:s},a.value?h(f,{ref:t,value:l.value,onUpdateValue:e=>{l.value=e},onChange:n,onBlur:n}):e.value)}}),x=e=>e.id,T=()=>[{type:"selection"},{title:"ID",key:"id"},{title:"名称",key:"名称",render(e){const a=(t=e.key,v.value.findIndex((e=>e.key===t)));var t;return h(m,{value:e["名称"],onUpdateValue(e){v.value[a]["名称"]=e}})}},{title:"数据类型",key:"数据类型",align:"center",render:e=>h(D,{type:"需求设计"===e["数据类型"]?"design":"revision"})},{title:"数据状态",key:"数据状态",render:e=>h(D,{type:"完成"===e["数据状态"]?"done":"doing"})},{title:"数据归属人",key:"数据归属人"},{title:"创建时间",key:"创建时间"},{title:"完成时间",key:"完成时间"},{title:"操作",key:"title",align:"right",render:e=>h(S,{onToEdit(){((e,a=null)=>{window.loading=C(),i.push({path:"/basic/dataWarehouseEditor",query:{id:a,type:e}})})(e["数据类型"],e.id)},onToDel(){var t;t=e.id,o.warning({title:"警告",content:"此操作不可逆，请确认是否继续",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{const e=C();I({data_id:t}).then((t=>{200===t.code&&(E(),e.close(),a.success("删除成功"))}))},onNegativeClick:()=>{a.error("取消删除")}})}})}],U=r([]),E=()=>{j({page:1,page_size:100}).then((e=>{200===e.code&&(v.value=e.data)}))};return b((()=>{window.loading||(window.loading=C()),E(),setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300),U.value=T()})),(e,a)=>{const o=c("n-button"),i=c("n-data-table");return t(),l("div",F,[a[2]||(a[2]=n("div",{class:"data-warehouse-title"},"数据仓库",-1)),n("div",H,[y(s(v.value.length)+"条总共数据 ",1),g(o,{class:"add-btn",onClick:a[0]||(a[0]=e=>{_.value.init()})},{default:p((()=>a[1]||(a[1]=[y("新建数据")]))),_:1})]),n("div",L,[g(i,{class:"table-item",columns:U.value,data:v.value,pagination:!0,bordered:!1,"row-key":x},null,8,["columns","data"])]),g(A,{ref_key:"wareHouseTypeRef",ref:_},null,512)])}}},[["__scopeId","data-v-cfcd9de1"]]);export{N as default};
