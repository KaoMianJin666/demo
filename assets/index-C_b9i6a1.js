import{g as l,u as e}from"./index-Dc2RlmRA.js";import{l as a}from"./logo2-l66aD4rS.js";import{_ as s,T as o}from"./TLoading-Bct1L4DW.js";import{u,r as n,o as i,C as t,g as c,h as r,i as v,j as d,k as p,x as m,D as b,p as g,s as h,y as w,w as y,m as f,t as k,F as C,q as _,E as I,v as x,A as B}from"./lib-CZQAdzIv.js";import{p as S,s as P,w as T,f as F,a as U,l as j,b as D}from"./index-2JieiYcA.js";import{m as O}from"./menu-B85Lp49n.js";const E={class:"login-outer"},q={class:"login-box-image"},L={class:"login-input-area"},$={class:"logo-area"},z=["src"],A={class:"main-title"},G={class:"sub-title"},M={key:1,class:"input-box"},W={class:"input-item"},H={key:0,class:"input-item"},K={key:1,class:"input-item"},N={class:"input-handle"},J={key:2,class:"input-box"},Q={class:"input-item"},R={class:"input-item"},V={class:"input-item"},X={class:"input-item"},Y={key:3,class:"button-box"},Z={key:4,class:"button-box"},ll=s({__name:"login",props:{bgColor:{type:String,default:"var(--t-bg-opacity-color)"},maskClickHide:{type:Boolean,default:!0},destroy:{type:Function}},setup(s){const o=u(),{userStore:y}=e();n("tMaskDom");const f=n(null),k=n(null),C=n(null),_=n(!1),I=n(!1),x=n("widthCaptcha"),B=n(!1),S=n("获取验证码"),P=n(!1),T=n(null),F=n(null),U=/^1[3-9]\d{9}$/,j=()=>{x.value="widthPwd"===x.value?"widthCaptcha":"widthPwd",localStorage.setItem("loginType",x.value)},D=()=>{if(B.value)return;if(!f.value||!U.test(f.value))return void o.error("请输入正确的手机号");const e=(new Date).getTime()+3e4;localStorage.setItem("captchaGettingTime",e),O(e),l({phone_number:f.value}).then((l=>{}))},O=l=>{if(!l)return;l=Number(l);const e=(new Date).getTime();e>l?S.value="获取验证码":(S.value=`${Math.ceil((l-e)/1e3)}秒后可发送`,setTimeout((()=>{O(l)}),1e3))},ll=l=>{"Enter"===l.code&&el()},el=()=>{if(!f.value||!U.test(f.value))return void o.error("请输入正确的手机号");if("widthPwd"===x.value){if(!C.value)return void o.error("请输入密码")}else if("widthCaptcha"===x.value&&!F.value)return void o.error("请输入密码");const l={phone_number:f.value,password:C.value,login_code:F.value};"widthPwd"===x.value?delete l.login_code:"widthCaptcha"===x.value&&delete l.password,y.handleLogin(l).then((()=>{location.reload()}))},al=()=>{f.value&&U.test(f.value)?F.value?C.value?k.value===C.value||o.error("两次输入密码不一致，请检查"):o.error("请输入密码后操作"):o.error("请输入验证码后操作"):o.error("请输入正确的手机号")};return i((()=>{f.value=null,C.value=null;const l=localStorage.getItem("captchaGettingTime");O(l),x.value=localStorage.getItem("loginType")||"widthPwd",t((()=>{_.value=!0}))})),(l,e)=>{const s=c("n-image"),o=c("n-input"),u=c("n-checkbox");return r(),v("div",E,[d("div",{class:w(["login-box show_start",{show_end:_.value}])},[d("div",q,[p(s,{style:{width:"100%",height:"100%"},src:"widthPwd"===x.value?m("/assets/login-image_0-BS1lCqqe.png"):m("/assets/login-image_1-BslzShbL.png")},null,8,["src"])]),d("div",L,[P.value?(r(),v("div",{key:0,class:"to-login",onClick:e[0]||(e[0]=l=>P.value=!1)},e[24]||(e[24]=[d("i",{class:"bi bi-arrow-left"},null,-1)]))):b("",!0),d("div",$,[d("img",{src:m(a),class:"login-logo"},null,8,z),e[25]||(e[25]=g(" U+ Oplus "))]),d("div",A,h(P.value?"你好，请重置密码！":"你好，欢迎回来！"),1),d("div",G,h(P.value?"请输入重置账户信息":"请输入登录账户信息"),1),P.value?b("",!0):(r(),v("div",M,[d("div",W,[d("label",{class:w({hide:0===T.value})},h("widthPwd"===x.value?"手机账号":"手机号"),3),p(o,{class:"login-input",clearable:"",value:f.value,"onUpdate:value":e[1]||(e[1]=l=>f.value=l),placeholder:"新用户登录即注册",onFocus:e[2]||(e[2]=l=>T.value=0),onBlur:e[3]||(e[3]=l=>T.value=null)},null,8,["value"])]),"widthPwd"===x.value?(r(),v("div",H,[d("label",{class:w({hide:1===T.value})},"登录密码",2),p(o,{class:"login-input",onKeydown:ll,placeholder:"请输入密码",clearable:"",value:C.value,"onUpdate:value":e[4]||(e[4]=l=>C.value=l),type:"password","show-password-on":"mousedown",onFocus:e[5]||(e[5]=l=>T.value=1),onBlur:e[6]||(e[6]=l=>T.value=null)},null,8,["value"])])):b("",!0),"widthPwd"!==x.value?(r(),v("div",K,[d("label",{class:w({hide:2===T.value})},"验证码",2),p(o,{class:"login-input",placeholder:"请输入验证码",clearable:"",value:F.value,"onUpdate:value":e[7]||(e[7]=l=>F.value=l),onFocus:e[8]||(e[8]=l=>T.value=2),onBlur:e[9]||(e[9]=l=>T.value=null)},null,8,["value"]),d("div",{class:w(["get-captcha",{disable:"获取验证码"===S.value}]),onClick:D},h(S.value),3)])):b("",!0),d("div",N,[p(u,{value:I.value,"onUpdate:value":e[10]||(e[10]=l=>I.value=l),label:"30天内记住密码",size:"large"},null,8,["value"]),d("div",{class:"forget-pwd",onClick:e[11]||(e[11]=l=>P.value=!0)},"忘记密码")])])),P.value?(r(),v("div",J,[d("div",Q,[e[26]||(e[26]=d("label",null,h("手机号"),-1)),p(o,{class:"login-input",clearable:"",value:f.value,"onUpdate:value":e[12]||(e[12]=l=>f.value=l),placeholder:"",onFocus:e[13]||(e[13]=l=>T.value=0),onBlur:e[14]||(e[14]=l=>T.value=null)},null,8,["value"])]),d("div",R,[e[27]||(e[27]=d("label",null,"验证码",-1)),p(o,{class:"login-input",placeholder:"请输入验证码",clearable:"",value:F.value,"onUpdate:value":e[15]||(e[15]=l=>F.value=l),onFocus:e[16]||(e[16]=l=>T.value=1),onBlur:e[17]||(e[17]=l=>T.value=null)},null,8,["value"]),d("div",{class:w(["get-captcha",{disable:"获取验证码"===S.value}]),onClick:D},h(S.value),3)]),d("div",V,[e[28]||(e[28]=d("label",null,"新的密码",-1)),p(o,{class:"login-input",placeholder:"请输入验证码",clearable:"","show-password-on":"mousedown",value:C.value,"onUpdate:value":e[18]||(e[18]=l=>C.value=l),type:"password","show-password":"",onFocus:e[19]||(e[19]=l=>T.value=2),onBlur:e[20]||(e[20]=l=>T.value=null)},null,8,["value"])]),d("div",X,[e[29]||(e[29]=d("label",null,"确认密码",-1)),p(o,{class:"login-input",placeholder:"请输入验证码",clearable:"","show-password-on":"mousedown",value:k.value,"onUpdate:value":e[21]||(e[21]=l=>k.value=l),type:"password","show-password":"",onFocus:e[22]||(e[22]=l=>T.value=3),onBlur:e[23]||(e[23]=l=>T.value=null)},null,8,["value"])])])):b("",!0),P.value?b("",!0):(r(),v("div",Y,[d("div",{class:"login-btn",onClick:el},"登录账户"),d("div",{class:"login-btn change-login-type",onClick:j},h("widthPwd"===x.value?"验证码登录":"密码登录"),1)])),P.value?(r(),v("div",Z,[d("div",{class:"login-btn",onClick:al},"重置密码")])):b("",!0),e[30]||(e[30]=d("div",{class:"agreement-box"}," 相关用户协议（注册登录后即代表您同意相关协议） ",-1))])],2)])}}},[["__scopeId","data-v-65731341"]]),el={class:"leftbar-logo"},al={class:"logo-area"},sl=["src"],ol={class:"leftbar-user"},ul={class:"points-data"},nl={class:"person-icon"},il={class:"menu-list"},tl=["onClick"],cl={class:"menu-item-icon"},rl={class:"menu-handle-icon"},vl=["src"],dl=s({__name:"leftBar",setup(l){const s=y(),o=f(),u=k(s,"path"),{publicStore:n}=e(),i=k(n,"isCarryOut"),t=[{name:"AI智绘",icon:P,path:"/basic/ai",routeIncluds:["/basic/ai"]},{name:"模板仓库",icon:T,path:"/basic/templateDepot",routeIncluds:["/basic/templateDepot"]},{name:"作品仓库",icon:F,path:"/basic/artWorks",routeIncluds:["/basic/artWorks"]},{name:"模板编辑",icon:U,path:"/basic/modelEditor",routeIncluds:["/basic/modelEditor"]},{name:"资源仓库",icon:j,path:"/basic/resourceCenter",routeIncluds:["/basic/resourceCenter","/basic/resourceCenterInfo","/basic/resourceInfo"]},{name:"数据仓库",icon:D,path:"/basic/",routeIncluds:[]}];return(l,e)=>(r(),v("div",{class:w(["leftbar-body",{"carry-out":i.value}])},[d("div",el,[d("div",al,[d("img",{src:m(a),class:"logo-icon"},null,8,sl),e[1]||(e[1]=d("label",null,"Oplus",-1))])]),d("div",ol,[d("div",ul,[d("div",nl,[d("i",{class:w(["bi",m(S)])},null,2)]),e[2]||(e[2]=d("div",{class:"points"},"100/∞积分",-1))]),e[3]||(e[3]=d("div",{class:"username"},"邵大吊",-1)),e[4]||(e[4]=d("div",{class:"points-bar"},[d("div",{class:"points-bar-box"},[d("div",{class:"points-bar-info"})])],-1))]),d("div",il,[(r(),v(C,null,_(t,(l=>{return d("div",{class:w(["menu-item",{selected:(e=l.routeIncluds,Boolean(e.find((l=>u.value===l))))}]),onClick:e=>(({path:l})=>{o.push(l)})(l),key:l.name},[d("div",cl,[d("i",{class:w(["bi",l.icon])},null,2)]),d("label",null,h(l.name),1)],10,tl);var e})),64))]),d("div",{class:"menu-handle-area",onClick:e[0]||(e[0]=l=>(i.value=!i.value,void n.setIsCarryOut(i.value)))},[d("div",rl,[d("img",{src:m(O),class:"menu-handle-icon-item"},null,8,vl)]),e[5]||(e[5]=d("label",null," 收起面板 ",-1))]),e[6]||(e[6]=d("div",{class:"logout-btn"},[d("label",null,"退出登录")],-1))],2))}},[["__scopeId","data-v-a96087f6"]]),pl={class:"basic-body"},ml={key:1,class:"basic-view"},bl=s({__name:"index",setup(l){const{userStore:a,publicStore:s}=e(),u=y(),n=k(a.token),t=k(s,"isCarryOut");return i((()=>{window.loading||(window.loading=o()),setTimeout((()=>{window.loading.close(),window.loading=null}),200)})),(l,e)=>{const a=c("router-view"),s=c("n-message-provider");return r(),v("div",pl,[p(s,null,{default:I((()=>[n.value?b("",!0):(r(),x(ll,{key:0})),n.value?(r(),v("div",ml,[p(dl),d("div",{class:"basic-content",style:B(`width: calc(100% - ${t.value?2.99:6.8}rem);`)},[(r(),x(a,{key:u.path}))],4)])):b("",!0)])),_:1})])}}},[["__scopeId","data-v-aa4712e0"]]);export{bl as default};
