import{g as e,u as a,a as l}from"./index-QuXMKZDh.js";import{l as s}from"./logo2-l66aD4rS.js";import{_ as o}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{L as t,r as i,o as n,M as u,j as r,k as c,m as v,n as d,H as p,u as h,y as b,B as g,C as m,p as w,E as y,v as k,x as _,I as f,F as C,A as I,D as B,w as x,e as S}from"./lib-CKDAqxUM.js";import{T as P}from"./TLoading-DiViiRSi.js";import{p as U,s as T,w as j,f as F,a as D,l as M,b as V}from"./index-ozdrtwfE.js";import{m as W}from"./menu-B85Lp49n.js";/* empty css                                                                 */const E={class:"login-outer"},O={class:"login-input-area"},$={class:"logo-area"},L=["src"],A={class:"main-title"},G={key:1,class:"input-box"},H={class:"input-handle"},q={key:2,class:"input-box"},z={key:3,class:"button-box"},K={key:4,class:"button-box"},N=o({__name:"login",props:{bgColor:{type:String,default:"var(--t-bg-opacity-color)"},maskClickHide:{type:Boolean,default:!0},destroy:{type:Function}},setup(l){const o=t(),{userStore:y}=a();i("tMaskDom");const k=i(null),_=i(null),f=i(null),C=i(!1),I=i(!1),B=i("widthCaptcha"),x=i(!1),S=i("获取验证码"),P=i(!1),U=i(null),T=i(null),j=/^1[3-9]\d{9}$/,F=()=>{B.value="widthPwd"===B.value?"widthCaptcha":"widthPwd",localStorage.setItem("loginType",B.value)},D=()=>{if(x.value)return;if(!k.value||!j.test(k.value))return void o.error("请输入正确的手机号");const a=(new Date).getTime()+3e4;localStorage.setItem("captchaGettingTime",a),M(a),e({phone_number:k.value}).then((e=>{}))},M=e=>{if(!e)return;e=Number(e);const a=(new Date).getTime();a>e?S.value="获取验证码":(S.value=`${Math.ceil((e-a)/1e3)}秒后可发送`,setTimeout((()=>{M(e)}),1e3))},V=e=>{"Enter"===e.code&&W()},W=()=>{if(!k.value||!j.test(k.value))return void o.error("请输入正确的手机号");if("widthPwd"===B.value){if(!f.value)return void o.error("请输入密码")}else if("widthCaptcha"===B.value&&!T.value)return void o.error("请输入密码");const e={phone_number:k.value,password:f.value,login_code:T.value};"widthPwd"===B.value?delete e.login_code:"widthCaptcha"===B.value&&delete e.password,y.handleLogin(e).then((()=>{location.reload()}))},N=()=>{k.value&&j.test(k.value)?T.value?f.value?_.value===f.value||o.error("两次输入密码不一致，请检查"):o.error("请输入密码后操作"):o.error("请输入验证码后操作"):o.error("请输入正确的手机号")};return n((()=>{k.value=null,f.value=null;const e=localStorage.getItem("captchaGettingTime");M(e),B.value=localStorage.getItem("loginType")||"widthPwd",u((()=>{C.value=!0}))})),(e,a)=>{const l=r("n-input"),o=r("n-checkbox");return c(),v("div",E,[d("div",{class:m(["login-box show_start",{show_end:C.value}])},[d("div",O,[P.value?(c(),v("div",{key:0,class:"to-login",onClick:a[0]||(a[0]=e=>P.value=!1)},a[24]||(a[24]=[d("i",{class:"bi bi-arrow-left"},null,-1)]))):p("",!0),d("div",$,[d("img",{src:h(s),class:"login-logo"},null,8,L),a[25]||(a[25]=b(" U+ Oplus "))]),d("div",A,g(P.value?"你好，请重置密码！":"你好，欢迎回来！"),1),a[30]||(a[30]=d("div",{class:"sub-title"},null,-1)),P.value?p("",!0):(c(),v("div",G,[d("div",{class:m(["input-item",{hasVal:Boolean(k.value)}])},[d("label",{class:m({hide:0===U.value})},g("widthPwd"===B.value?"手机账号":"手机号"),3),w(l,{class:"login-input editor-setting-input",clearable:"",value:k.value,"onUpdate:value":a[1]||(a[1]=e=>k.value=e),placeholder:"新用户登录即注册",onFocus:a[2]||(a[2]=e=>U.value=0),onBlur:a[3]||(a[3]=e=>U.value=null)},null,8,["value"])],2),"widthPwd"===B.value?(c(),v("div",{key:0,class:m(["input-item",{hasVal:Boolean(f.value)}])},[d("label",{class:m({hide:1===U.value})},"登录密码",2),w(l,{class:"login-input editor-setting-input",onKeydown:V,placeholder:"请输入密码",clearable:"",value:f.value,"onUpdate:value":a[4]||(a[4]=e=>f.value=e),type:"password","show-password-on":"mousedown",onFocus:a[5]||(a[5]=e=>U.value=1),onBlur:a[6]||(a[6]=e=>U.value=null)},null,8,["value"])],2)):p("",!0),"widthPwd"!==B.value?(c(),v("div",{key:1,class:m(["input-item",{hasVal:Boolean(T.value)}])},[d("label",{class:m({hide:2===U.value})},"验证码",2),w(l,{class:"login-input editor-setting-input",placeholder:"请输入验证码",clearable:"",value:T.value,"onUpdate:value":a[7]||(a[7]=e=>T.value=e),onFocus:a[8]||(a[8]=e=>U.value=2),onBlur:a[9]||(a[9]=e=>U.value=null)},null,8,["value"]),d("div",{class:m(["get-captcha",{disable:"获取验证码"===S.value}]),onClick:D},g(S.value),3)],2)):p("",!0),d("div",H,[w(o,{value:I.value,"onUpdate:value":a[10]||(a[10]=e=>I.value=e),style:{"--n-color":"var(--op-main-sub-bg-color)","--n-color-table":"var(--op-main-sub-bg-color)","--n-color-table-modal":"var(--op-main-sub-bg-color)","--n-color-table-popover":"var(--op-main-sub-bg-color)"},label:"30天内记住密码",size:"large"},null,8,["value"]),d("div",{class:"forget-pwd",onClick:a[11]||(a[11]=e=>P.value=!0)},"忘记密码")])])),P.value?(c(),v("div",q,[d("div",{class:m(["input-item",{hasVal:Boolean(k.value)}])},[a[26]||(a[26]=d("label",null,g("手机号"),-1)),w(l,{class:"login-input editor-setting-input",clearable:"",value:k.value,"onUpdate:value":a[12]||(a[12]=e=>k.value=e),placeholder:"",onFocus:a[13]||(a[13]=e=>U.value=0),onBlur:a[14]||(a[14]=e=>U.value=null)},null,8,["value"])],2),d("div",{class:m(["input-item",{hasVal:Boolean(T.value)}])},[a[27]||(a[27]=d("label",null,"验证码",-1)),w(l,{class:"login-input editor-setting-input",placeholder:"请输入验证码",clearable:"",value:T.value,"onUpdate:value":a[15]||(a[15]=e=>T.value=e),onFocus:a[16]||(a[16]=e=>U.value=1),onBlur:a[17]||(a[17]=e=>U.value=null)},null,8,["value"]),d("div",{class:m(["get-captcha",{disable:"获取验证码"===S.value}]),onClick:D},g(S.value),3)],2),d("div",{class:m(["input-item",{hasVal:Boolean(f.value)}])},[a[28]||(a[28]=d("label",null,"新的密码",-1)),w(l,{class:"login-input editor-setting-input",placeholder:"请输入验证码",clearable:"","show-password-on":"mousedown",value:f.value,"onUpdate:value":a[18]||(a[18]=e=>f.value=e),type:"password","show-password":"",onFocus:a[19]||(a[19]=e=>U.value=2),onBlur:a[20]||(a[20]=e=>U.value=null)},null,8,["value"])],2),d("div",{class:m(["input-item",{hasVal:Boolean(_.value)}])},[a[29]||(a[29]=d("label",null,"确认密码",-1)),w(l,{class:"login-input editor-setting-input",placeholder:"请输入验证码",clearable:"","show-password-on":"mousedown",value:_.value,"onUpdate:value":a[21]||(a[21]=e=>_.value=e),type:"password","show-password":"",onFocus:a[22]||(a[22]=e=>U.value=3),onBlur:a[23]||(a[23]=e=>U.value=null)},null,8,["value"])],2)])):p("",!0),P.value?p("",!0):(c(),v("div",z,[d("div",{class:"login-btn",onClick:W},"登录账户"),d("div",{class:"login-btn change-login-type",onClick:F},g("widthPwd"===B.value?"验证码登录":"密码登录"),1)])),P.value?(c(),v("div",K,[d("div",{class:"login-btn",onClick:N},"重置密码")])):p("",!0),a[31]||(a[31]=d("div",{class:"agreement-box"}," 相关用户协议（注册登录后即代表您同意相关协议） ",-1))])],2)])}}},[["__scopeId","data-v-feb482a2"]]),R={class:"leftbar-logo"},J={class:"logo-area"},Q=["src"],X={class:"points-data"},Y={class:"username"},Z={class:"person-icon"},ee={class:"points"},ae={class:"points-bar"},le={class:"points-bar-box"},se={class:"menu-list"},oe=["onClick"],te={class:"menu-item-icon"},ie={class:"menu-handle-icon"},ne=["src"],ue=o({__name:"leftBar",setup(e){const l=y(),o=k(),t=_(l,"path"),{publicStore:i,userStore:n}=a(),u=_(i,"isCarryOut"),r=_(n,"points"),p=_(n,"phone"),b=[{name:"AI智绘",icon:T,path:"/basic/ai",routeIncluds:["/basic/ai"]},{name:"模板仓库",icon:j,path:"/basic/templateDepot",routeIncluds:["/basic/templateDepot","/basic/generateImage"]},{name:"作品仓库",icon:F,path:"/basic/artWorks",routeIncluds:["/basic/artWorks","/basic/artWorkEditor","/basic/artWorkInfo"]},{name:"模板编辑",icon:D,path:"/basic/modelEditor",routeIncluds:["/basic/modelEditor","/basic/updateModel"]},{name:"资源仓库",icon:M,path:"/basic/resourceCenter",routeIncluds:["/basic/resourceCenter","/basic/resourceCenterInfo","/basic/resourceInfo"]},{name:"数据仓库",icon:V,path:"/basic/dataWarehouse",routeIncluds:["/basic/dataWarehouse","/basic/dataWarehouseEditor"]}];return(e,a)=>(c(),v("div",{class:m(["leftbar-body",{"carry-out":u.value}])},[d("div",R,[d("div",J,[d("img",{src:h(s),class:"logo-icon"},null,8,Q),a[3]||(a[3]=d("label",null,"Oplus",-1))])]),d("div",{class:"leftbar-user",onClick:a[0]||(a[0]=e=>{i.setChargeShow(!0)})},[d("div",X,[d("div",Y,g(u.value?String(p.value).substring(0,5):p.value),1),d("div",Z,[d("i",{class:m(["bi",h(U)])},null,2)]),d("div",ee,g(r.value)+"/"+g(r.value)+"积分",1)]),d("div",ae,[d("div",le,[d("div",{class:"points-bar-info",style:f({width:`${Math.round(r.value/r.value*100)}%`})},null,4)])])]),d("div",se,[(c(),v(C,null,I(b,(e=>{return d("div",{class:m(["menu-item",{selected:(a=e.routeIncluds,Boolean(a.find((e=>t.value===e))))}]),onClick:a=>(({path:e})=>{o.push(e)})(e),key:e.name},[d("div",te,[d("i",{class:m(["bi",e.icon])},null,2)]),d("label",null,g(e.name),1)],10,oe);var a})),64))]),d("div",{class:"menu-handle-area",onClick:a[1]||(a[1]=e=>(u.value=!u.value,void i.setIsCarryOut(u.value)))},[d("div",ie,[d("img",{src:h(W),class:"menu-handle-icon-item"},null,8,ne)]),a[4]||(a[4]=d("label",null," 收起面板 ",-1))]),d("div",{class:"logout-btn",onClick:a[2]||(a[2]=e=>h(n).handleLogout().then((()=>{})))},a[5]||(a[5]=[d("label",null,"退出登录",-1)]))],2))}},[["__scopeId","data-v-389a58b1"]]),re={class:"charge-body"},ce={class:"charge-type-area"},ve=["onClick"],de={class:"charge-input-area-outer"},pe={class:"charge-input-area"},he={class:"charge-input-item"},be={class:"charge-input-area"},ge={class:"charge-input-item"},me=o({__name:"rightDrawer",setup(e){const{publicStore:l}=a(),s=_(l,"chargeShow"),o=i([{name:"支付宝",key:"aliPay"},{name:"微信",key:"weChatPay"}]),t=i("aliPay"),n=i(10);return(e,a)=>{const l=r("n-input-number"),i=r("n-drawer"),u=r("n-config-provider");return c(),B(u,{theme:h(S)},{default:x((()=>[w(i,{show:s.value,"onUpdate:show":a[1]||(a[1]=e=>s.value=e),width:"16.171rem",placement:"right"},{default:x((()=>[d("div",re,[d("div",ce,[(c(!0),v(C,null,I(o.value,(e=>(c(),v("div",{class:m(["charge-type-item",{selected:t.value===e.key}]),onClick:a=>t.value=e.key,key:e.key},g(e.name),11,ve)))),128))]),a[6]||(a[6]=d("div",{class:"charge-title"},[d("div",{class:"charge-title-text"},"充值积分"),d("div",{class:"charge-title-view"},[d("label",null," RMB "),d("div",{class:"charge-title-icon"},[d("i",{class:"bi bi-arrow-right"})]),d("label",null," U+积分 ")])],-1)),d("div",de,[d("div",pe,[a[3]||(a[3]=d("div",{class:"charge-input-title"},"充值",-1)),d("div",he,[w(l,{placeholder:"10",value:n.value,"onUpdate:value":a[0]||(a[0]=e=>n.value=e),style:f(`width: ${.67*Math.ceil(n.value>10?String(n.value).length:2)+1.7}rem;`),max:1e4,min:10,class:"editor-setting-input input","show-button":!1},{suffix:x((()=>a[2]||(a[2]=[d("div",{class:"icon"},"￥",-1)]))),_:1},8,["value","style"])])]),d("div",be,[a[5]||(a[5]=d("div",{class:"charge-input-title"},"获得",-1)),d("div",ge,[d("label",null,g(10*n.value),1),a[4]||(a[4]=d("div",{class:"icon"},"积分",-1))])])])])])),_:1},8,["show"])])),_:1},8,["theme"])}}},[["__scopeId","data-v-89901a05"]]),we={key:1,class:"basic-view"},ye=o({__name:"index",setup(e){const{userStore:s,publicStore:o}=a(),t=y(),i=_(s,"token"),u=_(o,"isCarryOut"),h=_(s,"points"),b=_(s,"phone");return n((()=>{window.loading||(window.loading=P()),setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null),l().then((e=>{200===e.code&&(h.value=e.data.points,b.value=e.data.phone_number)}))}),200)})),(e,a)=>{const l=r("router-view"),s=r("n-message-provider"),o=r("n-dialog-provider");return c(),v("div",{class:m(["basic-body",{login:!i.value}])},[w(o,null,{default:x((()=>[w(s,null,{default:x((()=>[i.value?p("",!0):(c(),B(N,{key:0})),i.value?(c(),v("div",we,[w(ue),d("div",{class:"basic-content",style:f(`width: calc(100% - ${u.value?2.99:6.8}rem);`)},[(c(),B(l,{key:t.path}))],4)])):p("",!0),w(me)])),_:1})])),_:1})],2)}}},[["__scopeId","data-v-7277c105"]]);export{ye as default};
