import{_ as e}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{x as a,k as t,m as l,B as s,n,E as o,u as i,K as d,v as u,r,j as c,C as v,w as p,p as y,y as g,F as w,A as m,o as b,Q as h,R as _,S as f}from"./lib-B5SO1xxf.js";import{a as k,x}from"./index-BKne-HHw.js";import{T as C}from"./TLoading-Ba__YXOy.js";import{g as T}from"./dataWarehouse-C8aVoyY-.js";import"./index-DJa-fsKY.js";const j=["type"],E=e({__name:"tableTag",props:{type:{type:String,default:"doing"}},setup(e){const n=a(e,"type"),o={done:"完成",doing:"进行中",design:"需求设计",revision:"设计微调"};return(e,a)=>(t(),l("div",{class:"table-tag-body",type:n.value},s(o[n.value]),9,j))}},[["__scopeId","data-v-df067714"]]),I={class:"table-btns"},U={class:"table-btn"},D={class:"table-btn"},V=e({__name:"tableBtn",emits:["toEdit","toDel"],setup(e,{emit:a}){const s=a;return(e,a)=>(t(),l("div",I,[n("div",U,[n("i",{class:o(["bi",i(k)]),onClick:a[0]||(a[0]=e=>s("toEdit"))},null,2)]),n("div",D,[n("i",{class:o(["bi",i(x)]),onClick:a[1]||(a[1]=e=>s("toDel"))},null,2)])]))}},[["__scopeId","data-v-1c71de1e"]]),q={class:"ware-house-area"},B=["onClick"],S={class:"footer"},W=e({__name:"wareHouseType",setup(e,{expose:a}){const i=d(),b=u(),h=r(!1),_=r(null),f=r(["需求设计","设计微调"]),k=()=>{if(!_.value)return i.error("请选择数据类型后操作"),!1;((e,a=null)=>{window.loading=C(),b.push({path:"/basic/dataWarehouseEditor",query:{id:a,type:e}})})(_.value),h.value=!1};return a({init:()=>{h.value=!0}}),(e,a)=>{const i=c("n-button"),d=c("n-card"),u=c("n-modal");return t(),v(u,{show:h.value,"onUpdate:show":a[1]||(a[1]=e=>h.value=e),"auto-focus":!1},{default:p((()=>[y(d,{title:"请选择数据类型",bordered:!1,size:"huge",style:{width:"15rem"},role:"dialog","aria-modal":"true"},{"header-extra":p((()=>a[2]||(a[2]=[]))),footer:p((()=>[n("div",S,[y(i,{onClick:a[0]||(a[0]=e=>k())},{default:p((()=>a[4]||(a[4]=[g("确认")]))),_:1})])])),default:p((()=>[n("div",q,[(t(!0),l(w,null,m(f.value,((e,i)=>(t(),l("div",{class:"ware-house-item",onClick:a=>_.value=e,key:i},[n("div",{class:o(["selected-mark",{show:e===_.value}])},a[3]||(a[3]=[n("i",{class:"bi bi-check"},null,-1)]),2),g(" "+s(e),1)],8,B)))),128))])])),_:1})])),_:1},8,["show"])}}},[["__scopeId","data-v-cd3dae81"]]),z={class:"data-warehouse-body"},A={class:"data-warehouse-sub-title"},F={class:"table-area"},H=e({__name:"index",setup(e){const a=u(),o=r([]),i=r(null),d=_({props:{value:[String,Number],onUpdateValue:[Function,Array]},setup(e){const a=r(!1),t=r(null),l=r(e.value);function s(){a.value=!0,nextTick((()=>{t.value.focus()}))}function n(){e.onUpdateValue(l.value),a.value=!1}return()=>h("div",{style:"min-height: 22px",onClick:s},a.value?h(f,{ref:t,value:l.value,onUpdateValue:e=>{l.value=e},onChange:n,onBlur:n}):e.value)}}),v=e=>e.id,w=()=>[{type:"selection"},{title:"ID",key:"id"},{title:"名称",key:"名称",render(e){const a=(t=e.key,o.value.findIndex((e=>e.key===t)));var t;return h(d,{value:e["名称"],onUpdateValue(e){o.value[a]["名称"]=e}})}},{title:"数据类型",key:"数据类型",align:"center",render:e=>h(E,{type:"需求设计"===e["数据类型"]?"design":"revision"})},{title:"数据状态",key:"数据状态",render:e=>h(E,{type:"完成"===e["数据状态"]?"done":"doing"})},{title:"数据归属人",key:"数据归属人"},{title:"创建时间",key:"创建时间"},{title:"完成时间",key:"完成时间"},{title:"操作",key:"title",align:"right",render:e=>h(V,{onToEdit(){((e,t=null)=>{window.loading=C(),a.push({path:"/basic/dataWarehouseEditor",query:{id:t,type:e}})})(e["数据类型"],e.id)},onToDel(){e.id,window.loading=C()}})}],m=r([]);return b((()=>{window.loading||(window.loading=C()),T({page:1,page_size:100}).then((e=>{200===e.code&&(o.value=e.data)})),setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300),m.value=w()})),(e,a)=>{const d=c("n-button"),u=c("n-data-table");return t(),l("div",z,[a[2]||(a[2]=n("div",{class:"data-warehouse-title"},"数据仓库",-1)),n("div",A,[g(s(o.value.length)+"条总共数据 ",1),y(d,{class:"add-btn",onClick:a[0]||(a[0]=e=>{i.value.init()})},{default:p((()=>a[1]||(a[1]=[g("新建数据")]))),_:1})]),n("div",F,[y(u,{class:"table-item",columns:m.value,data:o.value,pagination:!0,bordered:!1,"row-key":v},null,8,["columns","data"])]),y(W,{ref_key:"wareHouseTypeRef",ref:i},null,512)])}}},[["__scopeId","data-v-987468e6"]]);export{H as default};
