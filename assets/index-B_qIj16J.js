import{g as l,u as a}from"./index-B9TnIHOe.js";import{l as e}from"./logo2-l66aD4rS.js";import{_ as s}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{u as o,r as u,o as n,E as i,g as t,h as c,i as r,j as v,k as d,x as p,C as m,p as b,s as h,y as g,w,m as y,t as f,F as k,q as C,D as _,v as I,A as x}from"./lib-Dn7wYpIU.js";import{T as B}from"./TLoading-FusFGd4y.js";import{p as S,s as P,w as T,f as j,a as F,l as U,b as D}from"./index-ZrP_5N1V.js";import{m as E}from"./menu-B85Lp49n.js";const O={class:"login-outer"},W={class:"login-box-image"},q={class:"login-input-area"},L={class:"logo-area"},$=["src"],z={class:"main-title"},A={class:"sub-title"},G={key:1,class:"input-box"},M={class:"input-item"},H={key:0,class:"input-item"},K={key:1,class:"input-item"},N={class:"input-handle"},J={key:2,class:"input-box"},Q={class:"input-item"},R={class:"input-item"},V={class:"input-item"},X={class:"input-item"},Y={key:3,class:"button-box"},Z={key:4,class:"button-box"},ll=s({__name:"login",props:{bgColor:{type:String,default:"var(--t-bg-opacity-color)"},maskClickHide:{type:Boolean,default:!0},destroy:{type:Function}},setup(s){const w=o(),{userStore:y}=a();u("tMaskDom");const f=u(null),k=u(null),C=u(null),_=u(!1),I=u(!1),x=u("widthCaptcha"),B=u(!1),S=u("获取验证码"),P=u(!1),T=u(null),j=u(null),F=/^1[3-9]\d{9}$/,U=()=>{x.value="widthPwd"===x.value?"widthCaptcha":"widthPwd",localStorage.setItem("loginType",x.value)},D=()=>{if(B.value)return;if(!f.value||!F.test(f.value))return void w.error("请输入正确的手机号");const a=(new Date).getTime()+3e4;localStorage.setItem("captchaGettingTime",a),E(a),l({phone_number:f.value}).then((l=>{}))},E=l=>{if(!l)return;l=Number(l);const a=(new Date).getTime();a>l?S.value="获取验证码":(S.value=`${Math.ceil((l-a)/1e3)}秒后可发送`,setTimeout((()=>{E(l)}),1e3))},ll=l=>{"Enter"===l.code&&al()},al=()=>{if(!f.value||!F.test(f.value))return void w.error("请输入正确的手机号");if("widthPwd"===x.value){if(!C.value)return void w.error("请输入密码")}else if("widthCaptcha"===x.value&&!j.value)return void w.error("请输入密码");const l={phone_number:f.value,password:C.value,login_code:j.value};"widthPwd"===x.value?delete l.login_code:"widthCaptcha"===x.value&&delete l.password,y.handleLogin(l).then((()=>{location.reload()}))},el=()=>{f.value&&F.test(f.value)?j.value?C.value?k.value===C.value||w.error("两次输入密码不一致，请检查"):w.error("请输入密码后操作"):w.error("请输入验证码后操作"):w.error("请输入正确的手机号")};return n((()=>{f.value=null,C.value=null;const l=localStorage.getItem("captchaGettingTime");E(l),x.value=localStorage.getItem("loginType")||"widthPwd",i((()=>{_.value=!0}))})),(l,a)=>{const s=t("n-image"),o=t("n-input"),u=t("n-checkbox");return c(),r("div",O,[v("div",{class:g(["login-box show_start",{show_end:_.value}])},[v("div",W,[d(s,{style:{width:"100%",height:"100%"},src:"widthPwd"===x.value?p("/assets/login-image_0-BS1lCqqe.png"):p("/assets/login-image_1-BslzShbL.png")},null,8,["src"])]),v("div",q,[P.value?(c(),r("div",{key:0,class:"to-login",onClick:a[0]||(a[0]=l=>P.value=!1)},a[24]||(a[24]=[v("i",{class:"bi bi-arrow-left"},null,-1)]))):m("",!0),v("div",L,[v("img",{src:p(e),class:"login-logo"},null,8,$),a[25]||(a[25]=b(" U+ Oplus "))]),v("div",z,h(P.value?"你好，请重置密码！":"你好，欢迎回来！"),1),v("div",A,h(P.value?"请输入重置账户信息":"请输入登录账户信息"),1),P.value?m("",!0):(c(),r("div",G,[v("div",M,[v("label",{class:g({hide:0===T.value})},h("widthPwd"===x.value?"手机账号":"手机号"),3),d(o,{class:"login-input",clearable:"",value:f.value,"onUpdate:value":a[1]||(a[1]=l=>f.value=l),placeholder:"新用户登录即注册",onFocus:a[2]||(a[2]=l=>T.value=0),onBlur:a[3]||(a[3]=l=>T.value=null)},null,8,["value"])]),"widthPwd"===x.value?(c(),r("div",H,[v("label",{class:g({hide:1===T.value})},"登录密码",2),d(o,{class:"login-input",onKeydown:ll,placeholder:"请输入密码",clearable:"",value:C.value,"onUpdate:value":a[4]||(a[4]=l=>C.value=l),type:"password","show-password-on":"mousedown",onFocus:a[5]||(a[5]=l=>T.value=1),onBlur:a[6]||(a[6]=l=>T.value=null)},null,8,["value"])])):m("",!0),"widthPwd"!==x.value?(c(),r("div",K,[v("label",{class:g({hide:2===T.value})},"验证码",2),d(o,{class:"login-input",placeholder:"请输入验证码",clearable:"",value:j.value,"onUpdate:value":a[7]||(a[7]=l=>j.value=l),onFocus:a[8]||(a[8]=l=>T.value=2),onBlur:a[9]||(a[9]=l=>T.value=null)},null,8,["value"]),v("div",{class:g(["get-captcha",{disable:"获取验证码"===S.value}]),onClick:D},h(S.value),3)])):m("",!0),v("div",N,[d(u,{value:I.value,"onUpdate:value":a[10]||(a[10]=l=>I.value=l),label:"30天内记住密码",size:"large"},null,8,["value"]),v("div",{class:"forget-pwd",onClick:a[11]||(a[11]=l=>P.value=!0)},"忘记密码")])])),P.value?(c(),r("div",J,[v("div",Q,[a[26]||(a[26]=v("label",null,h("手机号"),-1)),d(o,{class:"login-input",clearable:"",value:f.value,"onUpdate:value":a[12]||(a[12]=l=>f.value=l),placeholder:"",onFocus:a[13]||(a[13]=l=>T.value=0),onBlur:a[14]||(a[14]=l=>T.value=null)},null,8,["value"])]),v("div",R,[a[27]||(a[27]=v("label",null,"验证码",-1)),d(o,{class:"login-input",placeholder:"请输入验证码",clearable:"",value:j.value,"onUpdate:value":a[15]||(a[15]=l=>j.value=l),onFocus:a[16]||(a[16]=l=>T.value=1),onBlur:a[17]||(a[17]=l=>T.value=null)},null,8,["value"]),v("div",{class:g(["get-captcha",{disable:"获取验证码"===S.value}]),onClick:D},h(S.value),3)]),v("div",V,[a[28]||(a[28]=v("label",null,"新的密码",-1)),d(o,{class:"login-input",placeholder:"请输入验证码",clearable:"","show-password-on":"mousedown",value:C.value,"onUpdate:value":a[18]||(a[18]=l=>C.value=l),type:"password","show-password":"",onFocus:a[19]||(a[19]=l=>T.value=2),onBlur:a[20]||(a[20]=l=>T.value=null)},null,8,["value"])]),v("div",X,[a[29]||(a[29]=v("label",null,"确认密码",-1)),d(o,{class:"login-input",placeholder:"请输入验证码",clearable:"","show-password-on":"mousedown",value:k.value,"onUpdate:value":a[21]||(a[21]=l=>k.value=l),type:"password","show-password":"",onFocus:a[22]||(a[22]=l=>T.value=3),onBlur:a[23]||(a[23]=l=>T.value=null)},null,8,["value"])])])):m("",!0),P.value?m("",!0):(c(),r("div",Y,[v("div",{class:"login-btn",onClick:al},"登录账户"),v("div",{class:"login-btn change-login-type",onClick:U},h("widthPwd"===x.value?"验证码登录":"密码登录"),1)])),P.value?(c(),r("div",Z,[v("div",{class:"login-btn",onClick:el},"重置密码")])):m("",!0),a[30]||(a[30]=v("div",{class:"agreement-box"}," 相关用户协议（注册登录后即代表您同意相关协议） ",-1))])],2)])}}},[["__scopeId","data-v-65731341"]]),al={class:"leftbar-logo"},el={class:"logo-area"},sl=["src"],ol={class:"leftbar-user"},ul={class:"points-data"},nl={class:"person-icon"},il={class:"menu-list"},tl=["onClick"],cl={class:"menu-item-icon"},rl={class:"menu-handle-icon"},vl=["src"],dl=s({__name:"leftBar",setup(l){const s=w(),o=y(),u=f(s,"path"),{publicStore:n}=a(),i=f(n,"isCarryOut"),t=[{name:"AI智绘",icon:P,path:"/basic/ai",routeIncluds:["/basic/ai"]},{name:"模板仓库",icon:T,path:"/basic/templateDepot",routeIncluds:["/basic/templateDepot"]},{name:"作品仓库",icon:j,path:"/basic/artWorks",routeIncluds:["/basic/artWorks"]},{name:"模板编辑",icon:F,path:"/basic/modelEditor",routeIncluds:["/basic/modelEditor"]},{name:"资源仓库",icon:U,path:"/basic/resourceCenter",routeIncluds:["/basic/resourceCenter","/basic/resourceCenterInfo","/basic/resourceInfo"]},{name:"数据仓库",icon:D,path:"/basic/dataWarehouse",routeIncluds:["/basic/dataWarehouse","/basic/dataWarehouseEditor"]}];return(l,a)=>(c(),r("div",{class:g(["leftbar-body",{"carry-out":i.value}])},[v("div",al,[v("div",el,[v("img",{src:p(e),class:"logo-icon"},null,8,sl),a[1]||(a[1]=v("label",null,"Oplus",-1))])]),v("div",ol,[v("div",ul,[v("div",nl,[v("i",{class:g(["bi",p(S)])},null,2)]),a[2]||(a[2]=v("div",{class:"points"},"100/∞积分",-1))]),a[3]||(a[3]=v("div",{class:"username"},"邵大吊",-1)),a[4]||(a[4]=v("div",{class:"points-bar"},[v("div",{class:"points-bar-box"},[v("div",{class:"points-bar-info"})])],-1))]),v("div",il,[(c(),r(k,null,C(t,(l=>{return v("div",{class:g(["menu-item",{selected:(a=l.routeIncluds,Boolean(a.find((l=>u.value===l))))}]),onClick:a=>(({path:l})=>{o.push(l)})(l),key:l.name},[v("div",cl,[v("i",{class:g(["bi",l.icon])},null,2)]),v("label",null,h(l.name),1)],10,tl);var a})),64))]),v("div",{class:"menu-handle-area",onClick:a[0]||(a[0]=l=>(i.value=!i.value,void n.setIsCarryOut(i.value)))},[v("div",rl,[v("img",{src:p(E),class:"menu-handle-icon-item"},null,8,vl)]),a[5]||(a[5]=v("label",null," 收起面板 ",-1))]),a[6]||(a[6]=v("div",{class:"logout-btn"},[v("label",null,"退出登录")],-1))],2))}},[["__scopeId","data-v-6597f747"]]),pl={class:"basic-body"},ml={key:1,class:"basic-view"},bl=s({__name:"index",setup(l){const{userStore:e,publicStore:s}=a(),o=w(),u=f(e.token),i=f(s,"isCarryOut");return n((()=>{window.loading||(window.loading=B()),setTimeout((()=>{window.loading.close(),window.loading=null}),200)})),(l,a)=>{const e=t("router-view"),s=t("n-message-provider");return c(),r("div",pl,[d(s,null,{default:_((()=>[u.value?m("",!0):(c(),I(ll,{key:0})),u.value?(c(),r("div",ml,[d(dl),v("div",{class:"basic-content",style:x(`width: calc(100% - ${i.value?2.99:6.8}rem);`)},[(c(),I(e,{key:o.path}))],4)])):m("",!0)])),_:1})])}}},[["__scopeId","data-v-aa4712e0"]]);export{bl as default};
