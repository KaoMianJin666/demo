import{x as e,m as a,n as t,F as l,A as s,J as o,k as n,H as d,r as u,D as r,C as i,T as c,G as p,j as v,B as m,p as y,w as f,y as g,u as _,V as k,N as b,M as w,o as h,E as x,L as D,K as j}from"./lib-COJami17.js";import{_ as S}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{T as A}from"./TLoading-pjY04-Bj.js";import{u as R,o as T}from"./opInput-DZmuhvpX.js";import{l as W}from"./logo2-l66aD4rS.js";import{u as I,_ as O}from"./index-C1NzruPt.js";import C from"./index-D7i0GGRa.js";import{a as V,g as P}from"./promptSetting-53z8wL41.js";import{g as E}from"./artwork-C24kWHgJ.js";import L from"./index-aqRvLeml.js";import{m as M,h as N,a as U,c as z}from"./index-C76ZuiuS.js";/* empty css                                                                 */import{j as q,m as J,h as Y,k as $,n as B,q as F,r as G}from"./index-BKne-HHw.js";import{a as H,u as K,s as Q}from"./dataWarehouse-B_wdGPsl.js";import{j as X}from"./file-C3RgH22k.js";import"./modelCard-AX5V_ilO.js";import"./menu-B85Lp49n.js";const Z={class:"page-count-body"},ee={class:"page-count-inner"},ae=["num"],te=S({__name:"pageCount",props:{pageData:{type:Array(),default:()=>[]},now:{type:Number,default:0}},emits:["addPage"],setup(u,{emit:r}){const i=r,c=u,p=e(c,"pageData"),v=e(c,"now");return(e,u)=>(n(),a("div",Z,[t("div",ee,[p.value.length>1?(n(!0),a(l,{key:0},s(p.value,((e,l)=>{return n(),a("div",{class:"page-count",style:d((s=l,s===v.value?{transform:"translateY(0rem)"}:s>v.value?{transform:"translateY(100%)"}:s<v.value?{transform:"translateY(-100%)"}:void 0)),key:l},u[1]||(u[1]=[t("div",{class:"page-count-line"},null,-1),t("label",null,null,-1)]),4);var s})),128)):o("",!0),v.value===p.value.length-1?(n(),a("div",{key:1,class:"add-btn",num:p.value.length,onClick:u[0]||(u[0]=e=>{i("addPage")})},u[2]||(u[2]=[t("div",{class:"page-count-line"},null,-1),t("label",null,"+",-1)]),8,ae)):o("",!0)])]))}},[["__scopeId","data-v-95a86af8"]]),le=S({__name:"modelSelectedDialog",props:["type"],emits:["setData"],setup(t,{expose:l,emit:s}){const{publicStore:d}=I(),p=s,v=e(d,"isCarryOut"),m=u(!1),y=e=>{p("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(e,l)=>(n(),r(c,{to:"body"},[m.value?(n(),a("div",{key:0,class:i(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(n(),r(C,{key:0,componentType:"component",type:t.type,onSetData:y},null,8,["type"])):o("",!0)],2)):o("",!0)]))}},[["__scopeId","data-v-15493417"]]),se={class:"json-editor-body"},oe={class:"input-area"},ne={key:1},de={key:2,class:"image-area"},ue=["src"],re={class:"add-image-area"},ie=S({__name:"jsonEditor",props:{modelValue:{default:()=>[{key:"",code:null,value:null}]},list:{default:!1}},emits:["update:modelValue"],setup(e,{expose:d,emit:c}){const w=k((()=>O((()=>Promise.resolve().then((()=>ce))),void 0))),h=[{name:"文本",code:"text"},{name:"图片",code:"image"},{name:"字典",code:"map"},{name:"列表",code:"list"}],x=u(e.modelValue),D=c;p(x.value,(e=>{D("update:modelValue",e)}));const j=()=>{x.value.push({key:"",code:null,value:null})},S=(e=x.value,a="map")=>{const t="map"===a?{}:[];return e.forEach((({key:e,code:l,value:s},o)=>{if(l)switch(l){case"text":case"image":"map"===a?t[e]=s:t[o]=s;break;case"list":"map"===a?t[e]=S(s,"list"):t[o]=S(s,"list");break;case"map":"map"===a?t[e]=S(s):t[o]=S(s)}})),t},A=(e={},a="map")=>{let t=[];return Object.keys(e).forEach((a=>{const l={key:a,code:null,value:null};Array.isArray(e[a])?e[a].every((e=>e.includes("http")))?(l.code="image",l.value=e[a]):(l.code="list",l.value=A(e[a]).map((e=>(e.key=null,e)))):"string"==typeof e[a]?(l.code="text",l.value=e[a]):(l.code="map",l.value=A(e[a])),t.push(l)})),t};return d({getData:()=>x.value,getSaveData:S,init:e=>{const a=e[0],t=A(a);x.value=t}}),(d,u)=>{const c=v("n-input"),p=v("n-button"),k=v("n-upload");return n(),a("div",se,[t("div",oe,[(n(!0),a(l,null,s(x.value,((d,v)=>(n(),a("div",{class:"input-group",key:v},[t("div",{class:i(["input-key",{list:e.list,unlist:!e.list}])},[e.list?(n(),a("label",ne,m(v+1),1)):(n(),r(c,{key:0,value:d.key,"onUpdate:value":e=>d.key=e,placeholder:"键名称"},null,8,["value","onUpdate:value"]))],2),t("div",{class:i(["input-value",{list:e.list,unlist:!e.list}])},[d.code?o("",!0):(n(),a(l,{key:0},s(h,(e=>y(p,{class:"type-btn",key:e.code,onClick:a=>((e,a)=>{switch(e.code=a,a){case"text":e.value=null;break;case"image":case"map":case"list":e.value=[]}})(d,e.code)},{default:f((()=>[g(m(e.name),1)])),_:2},1032,["onClick"]))),64)),"text"===d.code?(n(),r(c,{key:1,value:d.value,"onUpdate:value":e=>d.value=e,placeholder:"请输入文本",type:"textarea"},null,8,["value","onUpdate:value"])):o("",!0),"image"===d.code?(n(),a("div",de,[(n(!0),a(l,null,s(d.value,((e,l)=>(n(),a("div",{class:"image-item",key:`image-${l}`},[t("img",{src:e},null,8,ue)])))),128)),t("div",re,[y(k,{"show-file-list":!1,accept:"image/*",action:"",onBeforeUpload:(...e)=>((e,{file:a})=>{const t=b(),l=new FormData;return l.append("file",a.file),R(t,l).then((a=>{200===a.code&&x.value[e].value.push(a.data)})),!1})(v,...e)},{default:f((()=>u[0]||(u[0]=[t("i",{class:"bi bi-plus"},null,-1)]))),_:2},1032,["onBeforeUpload"])])])):o("",!0),"map"===d.code?(n(),r(_(w),{key:3,class:"inline",modelValue:d.value,"onUpdate:modelValue":e=>d.value=e},null,8,["modelValue","onUpdate:modelValue"])):o("",!0),"list"===d.code?(n(),r(_(w),{key:4,list:!0,class:"inline",modelValue:d.value,"onUpdate:modelValue":e=>d.value=e},null,8,["modelValue","onUpdate:modelValue"])):o("",!0)],2)])))),128)),t("div",{class:i(["add-area",{list:e.list,unlist:!e.list}])},[t("label",{onClick:j},"+")],2)])])}}},[["__scopeId","data-v-477d4a69"]]),ce=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"})),pe={class:"model-selected-title"},ve={class:"model-selected-title-text"},me={key:0,class:"other-data-area"},ye={key:1,class:"selected-data-area"},fe={class:"card-tags"},ge=S({__name:"modelSelected",props:{type:{},data:{default:()=>[]}},setup(d,{expose:r}){const{publicStore:c}=I(),p=e(c,"isCarryOut"),_=d,k=u(null),b=u(null),h=u(0),x={prompts:"动态",statics:"静态",texts:"文字",colors:"调色板",designs:"设计理念"},D={prompts:["resource_id","preview","resource_name","description","keywords","trigger","server_type"],statics:["resource_id","preview","resource_name","description","keywords","cloud_folder"],texts:["resource_id","preview","resource_name","description","keywords","cloud_folder"],colors:["resource_id","preview","resource_name","description","keywords","colors"]},j=u(_.data[0]?_.data[0].value:[]),S=()=>{k.value.init()},A=e=>{V(e.resource_id).then((e=>{if(200===e.code)if("designs"===_.type){const a=Object.assign({data:e.data},e.info);j.value.push(a)}else{const a=Object.assign(e.data,e.info);j.value.push(a)}}))},R=e=>{const a={};return D[_.type]?(D[_.type].forEach((t=>{a[t]=e[t]})),a):e.data?Object.assign(e.data,{resource_id:e.resource_id,preview:e.preview}):{resource_id:e.resource_id,preview:e.preview}};return r({getSaveData:()=>({role:"database",type:`${x[_.type]}资源参考`,content:[{type:"json",value:j.value.map((e=>R(e)))}]})}),(e,u)=>{const r=v("n-scrollbar"),c=v("n-image"),_=v("n-tag"),D=v("n-space");return n(),a("div",{class:i(["model-selected-body",{expand:!p.value}])},[t("div",pe,[t("div",ve," 选择"+m(x[d.type])+"资源 ",1)]),1===h.value?(n(),a("div",me,[y(r,{onWheel:u[0]||(u[0]=w((()=>{}),["stop"]))},{default:f((()=>[y(ie,{ref_key:"jsonEditorRef",ref:b},null,512)])),_:1})])):o("",!0),0===h.value?(n(),a("div",ye,[(n(!0),a(l,null,s(j.value,(e=>(n(),a("div",{class:"card",key:e.resource_id},[y(c,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),t("div",fe,[y(D,null,{default:f((()=>[y(_,{bordered:!1},{default:f((()=>u[1]||(u[1]=[g(" 家纺平面设计 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[2]||(u[2]=[g(" 卡通风格和可爱ins风 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[3]||(u[3]=[g(" 奶牛 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[4]||(u[4]=[g(" 胡萝卜 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[5]||(u[5]=[g(" 樱桃 ")]))),_:1}),y(_,{bordered:!1},{default:f((()=>u[6]||(u[6]=[g(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),j.value.length<3?(n(),a("div",{key:0,class:"card",onClick:S},u[7]||(u[7]=[t("i",{class:"bi bi-plus"},null,-1)]))):o("",!0)])):o("",!0),y(le,{type:d.type,ref_key:"modelSelectedDialogRef",ref:k,onSetData:A},null,8,["type"])],2)}}},[["__scopeId","data-v-1e509e85"]]),_e={class:"other-data-area"},ke=S({__name:"generateDemandAnalysis",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:o}=I(),d=e(o,"isCarryOut"),r=l;u(null);const c=u(null);u(0),u([]);return h((()=>{r.data&&r.data[0]&&(data.value=c.value.init(r.data[0].value))})),s({getSaveData:()=>({role:"system",type:"需求分析",content:[{type:"json",value:[c.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return n(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 生成需求分析 ")],-1)),t("div",_e,[y(s,{onWheel:l[0]||(l[0]=w((()=>{}),["stop"]))},{default:f((()=>[y(ie,{ref_key:"jsonEditorRef",ref:c},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-b7860791"]]),be={class:"other-data-area"},we=S({__name:"generateText",setup(l){const{publicStore:s}=I(),o=e(s,"isCarryOut");return(e,l)=>{const s=v("n-input");return n(),a("div",{class:i(["model-selected-body",{expand:!o.value}])},[l[0]||(l[0]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 生成文本段落 ")],-1)),t("div",be,[y(s,{type:"textarea",placeholder:"请输入文本段落",style:{height:"100%"},resize:"none"})])],2)}}},[["__scopeId","data-v-5c1fa973"]]),he=S({__name:"artworkSelectedDialog",props:["type"],emits:["setData"],setup(t,{expose:l,emit:s}){const{publicStore:d}=I(),p=s,v=e(d,"isCarryOut"),m=u(!1),y=e=>{p("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(e,l)=>(n(),r(c,{to:"body"},[m.value?(n(),a("div",{key:0,class:i(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(n(),r(L,{key:0,componentType:"component",type:t.type,onSetData:y},null,8,["type"])):o("",!0)],2)):o("",!0)]))}},[["__scopeId","data-v-05088086"]]),xe={key:0,class:"selected-data-area"},De={class:"card-tags"},je={key:1,class:"selected-data-area"},Se=S({__name:"artWorkSelected",props:{type:{},data:{default:()=>[]}},setup(d,{expose:r}){const{publicStore:c}=I(),p=e(c,"isCarryOut"),m=d,_=u(null);u(null);const k=u(m.data[0]&&"generateArtWork"===m.type?1:0),b=u(m.data[0]?m.data[0].value:[]),w=u(m.data[0]?m.data[0].value:[]),h=x(),j=u([]),S=u([]),A=u([]),R=u([]),T=u({template_filter:"nomal",template_level:"nomal",points:1}),W=u(!1),O=u(null),C=u({canvasData:{name:h.query.file_name||"",width:2048,height:2048}}),V=u({groups:{},layers:{},elements:{}}),L=u(!1),q=e=>new Promise((a=>{E(e).then((e=>{C.value=Object.assign(C.value,e.data.viewData),C.value.canvasData.name=e.info.artwork_name,V.value=e.data.layerData,T.value=e.info,L.value=!0,a()}))})),J=e=>{Promise.all([new Promise((e=>{P("colors").then((a=>{A.value=a.data,e()}))})),new Promise((e=>{P("texts").then((a=>{R.value=a.data,e()}))})),new Promise((e=>{P("prompts").then((a=>{j.value=a.data,e()}))})),new Promise((e=>{P("statics").then((a=>{S.value=a.data,e()}))})),q(e)]).then((()=>{W.value=!0}))},Y=()=>{_.value.init()},$=e=>{b.value.push(e),"generateArtWork"===m.type&&(O.value=e.artwork_id,k.value=1,B())},B=async(e=O.value)=>{(k.value||"generateArtWork"===m.type)&&(w.value.length?(L.value=!0,D((()=>{w.value.forEach((async e=>{await N(e)}))}))):J(e))};return r({hideView:()=>{if("generateArtWork"===m.type){if(!L.value)return;L.value=!1,w.value=JSON.parse(JSON.stringify(U)),z()}else"selectedArtWork"===m.type&&(L.value=!1)},initView:B,getSaveData:()=>"generateArtWork"===m.type?(k.value&&L.value&&(w.value=JSON.parse(JSON.stringify(U))),{role:"system",type:"生成操作链",content:[{type:"json",value:w.value}]}):"selectedArtWork"===m.type?{role:"system",type:"作品资源参考",content:[{type:"json",value:b.value}]}:void 0}),(e,d)=>{const u=v("n-image"),r=v("n-tag"),c=v("n-space");return n(),a("div",{class:i(["model-selected-body",{expand:!p.value}])},[d[7]||(d[7]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"},"生成作品资源")],-1)),0===k.value?(n(),a("div",xe,[(n(!0),a(l,null,s(b.value,(e=>(n(),a("div",{class:"card",key:e.artwork_id},[y(u,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),t("div",De,[y(c,null,{default:f((()=>[y(r,{bordered:!1},{default:f((()=>d[0]||(d[0]=[g(" 家纺平面设计 ")]))),_:1}),y(r,{bordered:!1},{default:f((()=>d[1]||(d[1]=[g(" 卡通风格和可爱ins风 ")]))),_:1}),y(r,{bordered:!1},{default:f((()=>d[2]||(d[2]=[g(" 奶牛 ")]))),_:1}),y(r,{bordered:!1},{default:f((()=>d[3]||(d[3]=[g(" 胡萝卜 ")]))),_:1}),y(r,{bordered:!1},{default:f((()=>d[4]||(d[4]=[g(" 樱桃 ")]))),_:1}),y(r,{bordered:!1},{default:f((()=>d[5]||(d[5]=[g(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),t("div",{class:"card",onClick:Y},d[6]||(d[6]=[t("i",{class:"bi bi-plus"},null,-1)]))])):o("",!0),1===k.value&&L.value?(n(),a("div",je,[y(M,{colorsList:A.value,textsList:R.value,editorType:"generate",promptsList:j.value,staticsList:S.value,setting:C.value,layerData:V.value,templateId:O.value,info:T.value,needOpInput:!1,needTaskList:!1},null,8,["colorsList","textsList","promptsList","staticsList","setting","layerData","templateId","info"])])):o("",!0),y(he,{ref_key:"artworkSelectedDialogRef",ref:_,onSetData:$},null,512)],2)}}},[["__scopeId","data-v-ae2693d9"]]),Ae={class:"other-data-area"},Re=S({__name:"referenceResource",props:{type:{},data:{default:()=>[]}},setup(l,{expose:s}){const{publicStore:o}=I(),d=e(o,"isCarryOut"),r=l,c=u([]);u(null);const p=u(null);u(0),u([]);return h((()=>{r.data&&r.data[0]&&(c.value=p.value.init(r.data[0].value))})),s({getSaveData:()=>({role:"system",type:"参考资源分析",content:[{type:"json",value:[p.value.getSaveData()]}]})}),(e,l)=>{const s=v("n-scrollbar");return n(),a("div",{class:i(["model-selected-body",{expand:!d.value}])},[l[1]||(l[1]=t("div",{class:"model-selected-title"},[t("div",{class:"model-selected-title-text"}," 参考资源分析 ")],-1)),t("div",Ae,[y(s,{onWheel:l[0]||(l[0]=w((()=>{}),["stop"]))},{default:f((()=>[y(ie,{ref_key:"jsonEditorRef",ref:p},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-606af7f2"]]),Te={key:0,class:"set-data-area"},We={key:1,class:"init-area"},Ie=["onClick"],Oe={class:"init-card-info"},Ce={class:"icon"},Ve={class:"name"},Pe={class:"content"},Ee={class:"type"},Le=S({__name:"pageItem",props:{count:{type:Number,default:0},now:{type:Number,default:0},data:{}},setup(c,{expose:p}){const v={input:"搜索资源",output:"生成结果"},y=c,f=u(null),g=u(null),_={selectedModelRef:u(null),generateDemandAnalysisRef:u(null),referenceResourceRef:u(null),generateTextRef:u(null),generateArtWorkRef:u(null),selectedArtWorkRef:u(null)},k=e(y,"count"),b=e(y,"now"),w=e(y,"data"),x=["动态资源参考","静态资源参考","文字资源参考","调色板资源参考","设计理念资源参考","作品资源参考","参考资源分析","需求分析","生成操作链"],j=[{name:"选择动态资源",content:"选择可参考的动态资源",icon:q,cardType:"input",code:"selectedModel",type:"prompts"},{name:"选择静态资源",content:"选择可参考的静态资源",icon:J,cardType:"input",code:"selectedModel",type:"statics"},{name:"选择文字资源",content:"选择可参考的文字资源",icon:Y,cardType:"input",code:"selectedModel",type:"texts"},{name:"选择调色板",content:"合理且舒适的颜色搭配",icon:$,cardType:"input",code:"selectedModel",type:"colors"},{name:"选择设计理念",content:"无数种设计思想的集合",icon:B,cardType:"input",code:"selectedModel",type:"designs"},{name:"选择作品资源",content:"选择用户需要的作品资源",icon:F,cardType:"input",code:"selectedArtWork",type:"prompts"},{name:"参考资源分析",content:"生成用户需求的参考分析",icon:G,cardType:"output",code:"referenceResource",type:""},{name:"生成需求分析",content:"生成用户需求的模板分析",icon:G,cardType:"output",code:"generateDemandAnalysis",type:""},{name:"生成作品资源",content:"生成用户需要的模板资源",icon:F,cardType:"output",code:"generateArtWork",type:"designs"}],S=(e=k.value)=>e===b.value+1?("generateArtWork"===f.value&&D((()=>{_.generateArtWorkRef.value.initView()})),{top:"0rem",zIndex:1}):e===b.value+1?("generateArtWork"===f.value&&D((()=>{_.generateArtWorkRef.value.hideView()})),{top:"100%",zIndex:0}):e===b.value+1?("generateArtWork"===f.value&&D((()=>{_.generateArtWorkRef.value.hideView()})),{top:"-100%",zIndex:0}):{display:"none"};return h((()=>{if(w.value.type){const e=x.findIndex((e=>e===w.value.type));f.value=j[e].code,g.value=j[e].type}})),p({getSaveData:()=>f.value?_[`${f.value}Ref`].value.getSaveData():null}),(e,u)=>(n(),a("div",{class:"page-item-body",style:d(S())},[null!==f.value?(n(),a("div",Te,["selectedModel"===f.value?(n(),r(ge,{key:0,type:g.value,data:w.value.content,ref:_.selectedModelRef},null,8,["type","data"])):o("",!0),"generateDemandAnalysis"===f.value?(n(),r(ke,{key:1,data:w.value.content,ref:_.generateDemandAnalysisRef},null,8,["data"])):o("",!0),"referenceResource"===f.value?(n(),r(Re,{key:2,data:w.value.content,ref:_.referenceResourceRef},null,8,["data"])):o("",!0),"generateText"===f.value?(n(),r(we,{key:3,data:w.value.content,ref:_.generateTextRef},null,8,["data"])):o("",!0),"selectedArtWork"===f.value||"generateArtWork"===f.value?(n(),r(Se,{key:4,data:w.value.content,type:f.value,ref:_[`${f.value}Ref`]},null,8,["data","type"])):o("",!0)])):o("",!0),null===f.value?(n(),a("div",We,[(n(),a(l,null,s(j,((e,a)=>t("div",{class:"init-card",key:a,onClick:a=>(({code:e,type:a})=>{f.value=e,g.value=a})(e)},[t("div",Oe,[t("div",Ce,[t("i",{class:i(["bi",e.icon])},null,2)]),t("div",Ve,m(e.name),1),t("div",Pe,m(e.content),1),t("div",Ee,m(v[e.cardType]),1)])],8,Ie))),64))])):o("",!0)],4))}},[["__scopeId","data-v-50b663d0"]]),Me={class:"page-ouoter-body"},Ne=S({__name:"pageOuter",props:{count:{type:Number,default:0},now:{type:Number,default:0},pageData:{type:Array,default:()=>[]}},setup(t,{expose:o}){const d=t,i=u(null);o({getSaveData:()=>{const e=[];return i.value.forEach((a=>{const t=a.getSaveData();t&&e.push(t)})),e}});const c=e(d,"pageData");e(d,"count");const p=e(d,"now");return(e,t)=>(n(),a("div",Me,[(n(!0),a(l,null,s(c.value,((e,a)=>(n(),r(Le,{ref_for:!0,ref_key:"page",ref:i,data:e,key:e.uuid,count:a+1,now:p.value},null,8,["data","count","now"])))),128))]))}},[["__scopeId","data-v-6b49b489"]]),Ue={class:"page-count"},ze={class:"data-warehouse-editor"},qe={class:"data-warehouse-editor-input-box"},Je={class:"logo-area"},Ye=["src"],$e={class:"data-warehouse-editor-input-area"},Be={class:"data-warehouse-editor-view"},Fe=S({__name:"index",setup(l){const s=j(),o=x(),d=e(o.query,"id"),r=u(o.query.type),i=u(0),c=u(null),p=u(null),m=u([]),k=u(!1),D=e=>{if(!k.value){if(k.value=!0,setTimeout((()=>{k.value=!1}),200),e.deltaY<0){if(i.value-1<0)return;i.value--}else if(e.deltaY>0){if(i.value+1>m.value.length-1)return;i.value++}e.stopPropagation()}},S=()=>{m.value.push({}),i.value=m.value.length-1},R=()=>{const e=p.value.getSaveData(),a=X(e,String((new Date).getTime())),t=new FormData;t.append("file",a),d.value||0===d.value?K({data_id:d.value,data_type:r.value,data_status:"进行中",formData:t}).then((e=>{200===e.code&&s.success("更新成功")})):Q({data_type:r.value,data_status:"进行中",formData:t}).then((e=>{200===e.code&&(d.value=e.data.data_id,s.success("保存成功"))}))};return h((()=>{window.loading||(window.loading=A()),d.value?H({data_id:d.value}).then((e=>{200===e.code&&(m.value=e.data.map((e=>(e.uuid=b(),e))))})):m.value=[{}],setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300)})),(e,l)=>{const s=v("n-button");return n(),a("div",{class:"data-warehouse-editor-body",onWheel:w(D,["stop"]),tabindex:"0"},[t("div",Ue,[y(te,{pageData:m.value,now:i.value,onAddPage:S},null,8,["pageData","now"])]),t("div",ze,[t("div",qe,[t("div",Je,[t("img",{src:_(W)},null,8,Ye),l[0]||(l[0]=t("label",null,"Oplus",-1))]),t("div",$e,[y(T,{style:{"box-shadow":"var(--op-thr-shadow)"},ref_key:"opInputRef",ref:c},null,512)]),y(s,{class:"save-btn",size:"large",onClick:R},{default:f((()=>l[1]||(l[1]=[g("保存数据")]))),_:1})]),l[2]||(l[2]=t("div",{class:"message"}," 参考其他的设计作品，查看是否有喜欢的风格布局或者元素，把它加入你的设计理念中！ ",-1)),t("div",Be,[y(Ne,{now:i.value,pageData:m.value,ref_key:"pageOuterRef",ref:p},null,8,["now","pageData"])])])],32)}}},[["__scopeId","data-v-7c41aa8d"]]);export{Fe as default};
