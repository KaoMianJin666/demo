import{_ as e}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{x as a,m as t,n as l,F as s,A as n,J as o,k as u,H as d,r,C as i,E as c,T as p,G as v,j as m,B as y,p as f,w as g,y as _,u as k,U as b,N as h,M as w,D as x,L as D,o as S}from"./lib-B5SO1xxf.js";import{T as j}from"./TLoading-Ba__YXOy.js";import{u as R,o as T}from"./opInput-C-THORyM.js";import{l as A}from"./logo2-l66aD4rS.js";import{u as I,_ as O}from"./index-DJa-fsKY.js";import C from"./index-CWh6Z3bZ.js";import{a as V,g as W}from"./promptSetting-DwXiNrfn.js";import{m as P,h as L,a as E,c as N}from"./index-Os1Re91M.js";import{j as U,m as M,h as Y,k as q,n as z,q as J,r as B}from"./index-BKne-HHw.js";import{a as $}from"./dataWarehouse-C8aVoyY-.js";import"./modelCard-3t_4QFQE.js";import"./file-C3RgH22k.js";import"./menu-B85Lp49n.js";const F={class:"page-count-body"},G={class:"page-count-inner"},H=["num"],K=e({__name:"pageCount",props:{pageData:{type:Array(),default:()=>[]},now:{type:Number,default:0}},emits:["addPage"],setup(e,{emit:r}){const i=r,c=e,p=a(c,"pageData"),v=a(c,"now");return(e,a)=>(u(),t("div",F,[l("div",G,[p.value.length>1?(u(!0),t(s,{key:0},n(p.value,((e,s)=>{return u(),t("div",{class:"page-count",style:d((n=s,n===v.value?{transform:"translateY(0rem)"}:n>v.value?{transform:"translateY(100%)"}:n<v.value?{transform:"translateY(-100%)"}:void 0)),key:s},a[1]||(a[1]=[l("div",{class:"page-count-line"},null,-1),l("label",null,null,-1)]),4);var n})),128)):o("",!0),v.value===p.value.length-1?(u(),t("div",{key:1,class:"add-btn",num:p.value.length,onClick:a[0]||(a[0]=e=>{i("addPage")})},a[2]||(a[2]=[l("div",{class:"page-count-line"},null,-1),l("label",null,"+",-1)]),8,H)):o("",!0)])]))}},[["__scopeId","data-v-95a86af8"]]),Q=e({__name:"modelSelectedDialog",props:["type"],emits:["setData"],setup(e,{expose:l,emit:s}){const{publicStore:n}=I(),d=s,v=a(n,"isCarryOut"),m=r(!1),y=e=>{d("setData",e),m.value=!1};return l({init:()=>{m.value=!0}}),(a,l)=>(u(),i(p,{to:"body"},[m.value?(u(),t("div",{key:0,class:c(["model-selected-dialog-body",{expand:!v.value}])},[m.value?(u(),i(C,{key:0,componentType:"component",type:e.type,onSetData:y},null,8,["type"])):o("",!0)],2)):o("",!0)]))}},[["__scopeId","data-v-15493417"]]),X={class:"json-editor-body"},Z={class:"input-area"},ee={key:1},ae={key:2,class:"image-area"},te=["src"],le={class:"add-image-area"},se=e({__name:"jsonEditor",props:{modelValue:{default:null},list:{default:!1}},emits:["update:modelValue"],setup(e,{expose:a,emit:d}){const p=b((()=>O((()=>Promise.resolve().then((()=>ne))),void 0))),w=[{name:"文本",code:"text"},{name:"图片",code:"image"},{name:"字典",code:"map"},{name:"列表",code:"list"}],x=r([{key:"",code:null,value:null}]),D=d;v(x.value,(e=>{D("update:modelValue",e)}));const S=()=>{x.value.push({key:"",code:null,value:null})},j=(e=x.value,a="map")=>{const t="map"===a?{}:[];return e.forEach((({key:e,code:l,value:s},n)=>{if(l)switch(l){case"text":case"image":"map"===a?t[e]=s:t[n]=s;break;case"list":"map"===a?t[e]=j(s,"list"):t[n]=j(s,"list");break;case"map":"map"===a?t[e]=j(s):t[n]=j(s)}})),t};return a({getData:()=>x.value,getSaveData:j}),(a,d)=>{const r=m("n-input"),v=m("n-button"),b=m("n-upload");return u(),t("div",X,[l("div",Z,[(u(!0),t(s,null,n(x.value,((a,m)=>(u(),t("div",{class:"input-group",key:m},[l("div",{class:c(["input-key",{list:e.list,unlist:!e.list}])},[e.list?(u(),t("label",ee,y(m+1),1)):(u(),i(r,{key:0,value:a.key,"onUpdate:value":e=>a.key=e,placeholder:"键名称"},null,8,["value","onUpdate:value"]))],2),l("div",{class:c(["input-value",{list:e.list,unlist:!e.list}])},[a.code?o("",!0):(u(),t(s,{key:0},n(w,(e=>f(v,{class:"type-btn",key:e.code,onClick:t=>((e,a)=>{switch(e.code=a,a){case"text":e.value=null;break;case"image":case"map":case"list":e.value=[]}})(a,e.code)},{default:g((()=>[_(y(e.name),1)])),_:2},1032,["onClick"]))),64)),"text"===a.code?(u(),i(r,{key:1,value:a.value,"onUpdate:value":e=>a.value=e,placeholder:"请输入文本",type:"textarea"},null,8,["value","onUpdate:value"])):o("",!0),"image"===a.code?(u(),t("div",ae,[(u(!0),t(s,null,n(a.value,((e,a)=>(u(),t("div",{class:"image-item",key:`image-${a}`},[l("img",{src:e},null,8,te)])))),128)),l("div",le,[f(b,{"show-file-list":!1,accept:"image/*",action:"",onBeforeUpload:(...e)=>((e,{file:a})=>{const t=h(),l=new FormData;return l.append("file",a.file),R(t,l).then((a=>{200===a.code&&x.value[e].value.push(a.data)})),!1})(m,...e)},{default:g((()=>d[0]||(d[0]=[l("i",{class:"bi bi-plus"},null,-1)]))),_:2},1032,["onBeforeUpload"])])])):o("",!0),"map"===a.code?(u(),i(k(p),{key:3,class:"inline",modelValue:a.value,"onUpdate:modelValue":e=>a.value=e},null,8,["modelValue","onUpdate:modelValue"])):o("",!0),"list"===a.code?(u(),i(k(p),{key:4,list:!0,class:"inline",modelValue:a.value,"onUpdate:modelValue":e=>a.value=e},null,8,["modelValue","onUpdate:modelValue"])):o("",!0)],2)])))),128)),l("div",{class:c(["add-area",{list:e.list,unlist:!e.list}])},[l("label",{onClick:S},"+")],2)])])}}},[["__scopeId","data-v-c47f15b8"]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"})),oe={class:"model-selected-title"},ue={class:"model-selected-title-text"},de={key:0,class:"other-data-area"},re={key:1,class:"selected-data-area"},ie={class:"card-tags"},ce=e({__name:"modelSelected",props:["type"],setup(e,{expose:d}){const{publicStore:i}=I(),p=a(i,"isCarryOut"),v=e,k=r(null),b=r(null),h=r(0),x={prompts:"动态",statics:"静态",texts:"文字",colors:"调色板",designs:"设计理念"},D={prompts:["resource_name","description","keywords","trigger","server_type"],statics:["resource_name","description","keywords","cloud_folder"],texts:["resource_name","description","keywords","cloud_folder"],colors:["resource_name","description","keywords","colors"]},S=r([]),j=()=>{k.value.init()},R=e=>{V(e.resource_id).then((e=>{if(200===e.code)if("designs"===v.type){const a=Object.assign({data:e.data},e.info);S.value.push(a)}else{const a=Object.assign(e.data,e.info);S.value.push(a)}}))},T=e=>{const a={};return D[v.type]?(D[v.type].forEach((t=>{a[t]=e[t]})),a):e.data};return d({getSaveData:()=>({role:"database",type:`${x[v.type]}资源参考`,content:[{type:"json",value:S.value.map((e=>T(e)))}]})}),(a,d)=>{const r=m("n-scrollbar"),i=m("n-image"),v=m("n-tag"),D=m("n-space");return u(),t("div",{class:c(["model-selected-body",{expand:!p.value}])},[l("div",oe,[l("div",ue," 选择"+y(x[e.type])+"资源 ",1)]),1===h.value?(u(),t("div",de,[f(r,{onWheel:d[0]||(d[0]=w((()=>{}),["stop"]))},{default:g((()=>[f(se,{ref_key:"jsonEditorRef",ref:b},null,512)])),_:1})])):o("",!0),0===h.value?(u(),t("div",re,[(u(!0),t(s,null,n(S.value,(e=>(u(),t("div",{class:"card",key:e.resource_id},[f(i,{width:"100%",src:e.preview,class:"image",fit:"contain"},null,8,["src"]),l("div",ie,[f(D,null,{default:g((()=>[f(v,{bordered:!1},{default:g((()=>d[1]||(d[1]=[_(" 家纺平面设计 ")]))),_:1}),f(v,{bordered:!1},{default:g((()=>d[2]||(d[2]=[_(" 卡通风格和可爱ins风 ")]))),_:1}),f(v,{bordered:!1},{default:g((()=>d[3]||(d[3]=[_(" 奶牛 ")]))),_:1}),f(v,{bordered:!1},{default:g((()=>d[4]||(d[4]=[_(" 胡萝卜 ")]))),_:1}),f(v,{bordered:!1},{default:g((()=>d[5]||(d[5]=[_(" 樱桃 ")]))),_:1}),f(v,{bordered:!1},{default:g((()=>d[6]||(d[6]=[_(" 莫兰蒂色 ")]))),_:1})])),_:1})])])))),128)),S.value.length<3?(u(),t("div",{key:0,class:"card",onClick:j},d[7]||(d[7]=[l("i",{class:"bi bi-plus"},null,-1)]))):o("",!0)])):o("",!0),f(Q,{type:e.type,ref_key:"modelSelectedDialogRef",ref:k,onSetData:R},null,8,["type"])],2)}}},[["__scopeId","data-v-cceba073"]]),pe={class:"other-data-area"},ve=e({__name:"generateDemandAnalysis",props:["type"],setup(e,{expose:s}){const{publicStore:n}=I(),o=a(n,"isCarryOut");r(null);const d=r(null);r(0),r([]);return s({getSaveData:()=>({role:"system",type:"需求分析",content:[{type:"json",value:[d.value.getSaveData()]}]})}),(e,a)=>{const s=m("n-scrollbar");return u(),t("div",{class:c(["model-selected-body",{expand:!o.value}])},[a[1]||(a[1]=l("div",{class:"model-selected-title"},[l("div",{class:"model-selected-title-text"}," 生成需求分析 ")],-1)),l("div",pe,[f(s,{onWheel:a[0]||(a[0]=w((()=>{}),["stop"]))},{default:g((()=>[f(se,{ref_key:"jsonEditorRef",ref:d},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-a19c6efa"]]),me={class:"other-data-area"},ye=e({__name:"generateText",setup(e){const{publicStore:s}=I(),n=a(s,"isCarryOut");return(e,a)=>{const s=m("n-input");return u(),t("div",{class:c(["model-selected-body",{expand:!n.value}])},[a[0]||(a[0]=l("div",{class:"model-selected-title"},[l("div",{class:"model-selected-title-text"}," 生成文本段落 ")],-1)),l("div",me,[f(s,{type:"textarea",placeholder:"请输入文本段落",style:{height:"100%"},resize:"none"})])],2)}}},[["__scopeId","data-v-5c1fa973"]]),fe={key:0,class:"selected-data-area"},ge={key:1,class:"selected-data-area"},_e=e({__name:"artWorkSelected",props:["type"],setup(e,{expose:s}){const{publicStore:n}=I(),d=a(n,"isCarryOut"),i=r(null);r(null);const p=r(0),m=r([]),y=r([]),g=x(),_=r([]),k=r([]),b=r([]),h=r([]),w=r({template_filter:"nomal",template_level:"nomal",points:1}),S=r(!1),j=r(g.query.template_id?Number(g.query.template_id):null),R=r({canvasData:{name:g.query.file_name||"",width:2048,height:2048}}),T=r({groups:{},layers:{},elements:{}}),A=r(!1);v((()=>g.query.template_id),((e,a)=>{j.value=e,S.value=!1,D((()=>{S.value=!0}))}));const O=()=>{Promise.all([new Promise((e=>{W("colors").then((a=>{b.value=a.data,e()}))})),new Promise((e=>{W("texts").then((a=>{h.value=a.data,e()}))})),new Promise((e=>{W("prompts").then((a=>{_.value=a.data,e()}))})),new Promise((e=>{W("statics").then((a=>{k.value=a.data,e()}))})),new Promise((e=>{R.value.canvasData.name?V(j.value,"layouts",R.value.canvasData.name).then((a=>{R.value=Object.assign(R.value,a.data.viewData),T.value=a.data.layerData,w.value=a.info,e()})):e()}))]).then((()=>{S.value=!0}))},C=()=>{i.value.init()},U=e=>{m.value.push(e),p.value=1,M()},M=()=>{p.value&&(A.value=!0,D((()=>{O(),y.value.forEach((async e=>{await L(e)}))})))};return s({hideView:()=>{A.value&&(A.value=!1,y.value=JSON.parse(JSON.stringify(E)),N())},initView:M,getSaveData:()=>(p.value&&A.value&&(y.value=JSON.parse(JSON.stringify(E))),{role:"system",type:"生成操作链",content:[{type:"json",value:y.value}]})}),(a,s)=>(u(),t("div",{class:c(["model-selected-body",{expand:!d.value}])},[s[1]||(s[1]=l("div",{class:"model-selected-title"},[l("div",{class:"model-selected-title-text"},"生成作品资源")],-1)),0===p.value?(u(),t("div",fe,[l("div",{class:"card",onClick:C},s[0]||(s[0]=[l("i",{class:"bi bi-plus"},null,-1)]))])):o("",!0),1===p.value&&A.value?(u(),t("div",ge,[f(P,{colorsList:b.value,textsList:h.value,editorType:"edit",promptsList:_.value,staticsList:k.value,setting:R.value,layerData:T.value,templateId:j.value,info:w.value,needOpInput:!1,needTaskList:!1},null,8,["colorsList","textsList","promptsList","staticsList","setting","layerData","templateId","info"])])):o("",!0),f(Q,{type:e.type,ref_key:"modelSelectedDialogRef",ref:i,onSetData:U},null,8,["type"])],2))}},[["__scopeId","data-v-f48561ee"]]),ke={class:"other-data-area"},be=e({__name:"referenceResource",props:["type"],setup(e,{expose:s}){const{publicStore:n}=I(),o=a(n,"isCarryOut");r(null);const d=r(null);r(0),r([]);return s({getSaveData:()=>({role:"system",type:"参考资源分析",content:[{type:"json",value:[d.value.getSaveData()]}]})}),(e,a)=>{const s=m("n-scrollbar");return u(),t("div",{class:c(["model-selected-body",{expand:!o.value}])},[a[1]||(a[1]=l("div",{class:"model-selected-title"},[l("div",{class:"model-selected-title-text"}," 参考资源分析 ")],-1)),l("div",ke,[f(s,{onWheel:a[0]||(a[0]=w((()=>{}),["stop"]))},{default:g((()=>[f(se,{ref_key:"jsonEditorRef",ref:d},null,512)])),_:1})])],2)}}},[["__scopeId","data-v-aba9d6e9"]]),he={key:0,class:"set-data-area"},we={key:1,class:"init-area"},xe=["onClick"],De={class:"init-card-info"},Se={class:"icon"},je={class:"name"},Re={class:"content"},Te={class:"type"},Ae=e({__name:"pageItem",props:{count:{type:Number,default:0},now:{type:Number,default:0},data:{}},setup(e,{expose:p}){const v={input:"搜索资源",output:"生成结果"},m=e,f=r(null),g=r(null),_={selectedModelRef:r(null),generateDemandAnalysisRef:r(null),referenceResourceRef:r(null),generateTextRef:r(null),generateArtWorkRef:r(null)},k=a(m,"count"),b=a(m,"now");a(m,"data");const h=[{name:"选择动态资源",content:"选择可参考的动态资源",icon:U,cardType:"input",code:"selectedModel",type:"prompts"},{name:"选择静态资源",content:"选择可参考的静态资源",icon:M,cardType:"input",code:"selectedModel",type:"statics"},{name:"选择文字资源",content:"选择可参考的文字资源",icon:Y,cardType:"input",code:"selectedModel",type:"texts"},{name:"选择调色板",content:"合理且舒适的颜色搭配",icon:q,cardType:"input",code:"selectedModel",type:"colors"},{name:"选择设计理念",content:"无数种设计思想的集合",icon:z,cardType:"input",code:"selectedModel",type:"designs"},{name:"选择作品资源",content:"选择用户需要的作品资源",icon:J,cardType:"input",code:"selectedArtWork",type:"prompts"},{name:"参考资源分析",content:"生成用户需求的参考分析",icon:B,cardType:"output",code:"referenceResource",type:""},{name:"生成需求分析",content:"生成用户需求的模板分析",icon:B,cardType:"output",code:"generateDemandAnalysis",type:""},{name:"生成作品资源",content:"生成用户需要的模板资源",icon:J,cardType:"output",code:"generateArtWork",type:"designs"}],w=(e=k.value)=>e===b.value+1?("generateArtWork"===f.value&&D((()=>{_.generateArtWorkRef.value.initView()})),{transform:"translateY(0rem)",zIndex:1}):e>b.value+1?("generateArtWork"===f.value&&D((()=>{_.generateArtWorkRef.value.hideView()})),{transform:"translateY(100%)",zIndex:0}):e<b.value+1?("generateArtWork"===f.value&&D((()=>{_.generateArtWorkRef.value.hideView()})),{transform:"translateY(-100%)",zIndex:0}):void 0;return p({getSaveData:()=>f.value?_[`${f.value}Ref`].value.getSaveData():null}),(e,a)=>(u(),t("div",{class:"page-item-body",style:d(w())},[null!==f.value?(u(),t("div",he,["selectedModel"===f.value?(u(),i(ce,{key:0,type:g.value,ref:_.selectedModelRef},null,8,["type"])):o("",!0),"generateDemandAnalysis"===f.value?(u(),i(ve,{key:1,ref:_.generateDemandAnalysisRef},null,512)):o("",!0),"referenceResource"===f.value?(u(),i(be,{key:2,ref:_.referenceResourceRef},null,512)):o("",!0),"generateText"===f.value?(u(),i(ye,{key:3,ref:_.generateTextRef},null,512)):o("",!0),"generateArtWork"===f.value?(u(),i(_e,{key:4,type:g.value,ref:_.generateArtWorkRef},null,8,["type"])):o("",!0)])):o("",!0),null===f.value?(u(),t("div",we,[(u(),t(s,null,n(h,((e,a)=>l("div",{class:"init-card",key:a,onClick:a=>(({code:e,type:a})=>{f.value=e,g.value=a})(e)},[l("div",De,[l("div",Se,[l("i",{class:c(["bi",e.icon])},null,2)]),l("div",je,y(e.name),1),l("div",Re,y(e.content),1),l("div",Te,y(v[e.cardType]),1)])],8,xe))),64))])):o("",!0)],4))}},[["__scopeId","data-v-bc69af36"]]),Ie={class:"page-ouoter-body"},Oe=e({__name:"pageOuter",props:{count:{type:Number,default:0},now:{type:Number,default:0},pageData:{type:Array,default:()=>[]}},setup(e,{expose:l}){const o=e,d=r(null);l({getSaveData:()=>{const e=[];return d.value.forEach((a=>{const t=a.getSaveData();t&&e.push(t)})),e}});const c=a(o,"pageData");a(o,"count");const p=a(o,"now");return(e,a)=>(u(),t("div",Ie,[(u(!0),t(s,null,n(c.value,((e,a)=>(u(),i(Ae,{ref_for:!0,ref_key:"page",ref:d,data:e,key:a,count:a+1,now:p.value},null,8,["data","count","now"])))),128))]))}},[["__scopeId","data-v-199bf4d5"]]),Ce={class:"page-count"},Ve={class:"data-warehouse-editor"},We={class:"data-warehouse-editor-input-box"},Pe={class:"logo-area"},Le=["src"],Ee={class:"data-warehouse-editor-input-area"},Ne={class:"data-warehouse-editor-view"},Ue=e({__name:"index",setup(e){const a=x(),s=r(a.query.id),n=r(0),o=r(null),d=r(null),i=r([{}]),c=e=>{if(e.deltaY<0){if(n.value-1<0)return;n.value--}else if(e.deltaY>0){if(n.value+1>i.value.length-1)return;n.value++}e.stopPropagation()},p=()=>{i.value.push({}),n.value=i.value.length-1},v=()=>{d.value.getSaveData()};return S((()=>{window.loading||(window.loading=j()),s.value?$({data_id:s.value}).then((e=>{})):i.value=[{}],setTimeout((()=>{window.loading&&(window.loading.close(),window.loading=null)}),300)})),(e,a)=>{const s=m("n-button");return u(),t("div",{class:"data-warehouse-editor-body",onWheel:c,tabindex:"0"},[l("div",Ce,[f(K,{pageData:i.value,now:n.value,onAddPage:p},null,8,["pageData","now"])]),l("div",Ve,[l("div",We,[l("div",Pe,[l("img",{src:k(A)},null,8,Le),a[0]||(a[0]=l("label",null,"Oplus",-1))]),l("div",Ee,[f(T,{style:{"box-shadow":"var(--op-thr-shadow)"},ref_key:"opInputRef",ref:o},null,512)]),f(s,{class:"save-btn",size:"large",onClick:v},{default:g((()=>a[1]||(a[1]=[_("保存数据")]))),_:1})]),a[2]||(a[2]=l("div",{class:"message"}," 参考其他的设计作品，查看是否有喜欢的风格布局或者元素，把它加入你的设计理念中！ ",-1)),l("div",Ne,[f(Oe,{now:n.value,pageData:i.value,ref_key:"pageOuterRef",ref:d},null,8,["now","pageData"])])])],32)}}},[["__scopeId","data-v-6707ac18"]]);export{Ue as default};
