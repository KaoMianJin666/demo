import{_ as e,p as a,s as l,u as t,g as n,a as s,d as i,b as d,r as u,T as o}from"./index.e7622c5c.js";import{r as v,a as m,o as c,c as r,b as p,n as _,e as f,w as g,s as h,O as b,y as w,Z as y,_ as k,k as x,h as V,g as U,i as D,$ as I,a0 as C,a1 as O,a2 as S,F as T,x as L,f as j,v as M,B as A,p as N,l as $,j as H,t as B}from"./lib.524d2fb3.js";const E={class:"setting-list-item"},F=["contenteditable",".innerHTML"];var J=e({__name:"settingItem",props:{name:{type:String,default:""},itemList:{type:Boolean,default:!1},needRemove:{type:Boolean,default:!1},col:{type:Number,default:0},needEdit:{type:Boolean,default:!1}},emits:["deleteItem"],setup(e,{emit:a}){const l=v(!1),t=a,n=e,s=e=>{e===Number(n.needEdit)&&(l.value=!l.value)},i=e=>{e.preventDefault();var a=(e.clipboardData||window.clipboardData).getData("text");t("setName",a)},d=({target:e})=>{t("setName",e.innerHTML)};return(a,u)=>{const o=m("el-icon");return c(),r("div",E,[p("div",{class:"setting-item-title",onClick:u[2]||(u[2]=V((e=>s(0)),["stop"]))},[p("div",{class:_(["setting-handle-icon",{selected:l.value}]),onClick:u[0]||(u[0]=e=>s(1))},[f(o,null,{default:g((()=>[(c(),h(b(w(y))))])),_:1})],2),p("div",{class:"setting-name",contenteditable:n.needEdit,".innerHTML":e.name,onPaste:i,onBlur:d},null,40,F),n.needRemove?(c(),r("div",{key:0,class:"settgin-remove-handle",onClick:u[1]||(u[1]=e=>t("deleteItem"))},[f(o,null,{default:g((()=>[f(w(k))])),_:1})])):x("",!0)]),p("div",{class:"setting-item-data-list",style:D({height:l.value?1.2*n.col+"rem":"0rem"})},[U(a.$slots,"default",{},void 0,!0)],4)])}}},[["__scopeId","data-v-63894b6e"]]);const R=e=>(N("data-v-22a48c1d"),e=e(),$(),e),z={class:"add-or-update"},P={class:"add-or-update-box"},Z={class:"title"},q=R((()=>p("div",{class:"title-label"},"参数选择:",-1))),G=["contenteditable",".innerHTML"],K={class:"folder"},Q={class:"setting-list folder-list"},W={class:"setting-item-data"},X=R((()=>p("div",{class:"setting-item-data-name"},"文件夹",-1))),Y={class:"setting-item-data-value"},ee={class:"setting-item-data"},ae=R((()=>p("div",{class:"setting-item-data-name"},"透明度",-1))),le={class:"setting-item-data-value"},te={class:"setting-handle"},ne={class:"setting-item-data-value"},se={class:"setting-list params-list"},ie={class:"setting-item-data"},de=R((()=>p("div",{class:"setting-item-data-name"},"value",-1))),ue={class:"setting-item-data-value"},oe={class:"setting-item-data"},ve=R((()=>p("div",{class:"setting-item-data-name"},"预览图地址",-1))),me={class:"setting-item-data-value"},ce={class:"setting-item-data"},re=R((()=>p("div",{class:"setting-item-data-name"},"value",-1))),pe={class:"setting-item-data-value"};var _e=e({__name:"staticsSettingAddOrUpdate",emits:["review"],setup(e,{expose:n,emit:s}){const i=v("maskDom"),d=v(!1),u=v("add"),o=s,y=v(!1),k=v(null),V=v(!1),U=v(!1),N=v(!1);v(new Set([])),v(new Set([]));const $=v(null),H=v(""),B=v(""),E=v(null),F=v(!0),R=[{name:"横向二方连续",key:"tile_x"},{name:"纵向二方连续",key:"tile_y"},{name:"四方连续",key:"tile_xy"}],_e=v([]),fe=({target:e})=>{k.value=e.innerHTML},ge=()=>{y.value=!y.value,y.value?H.value=H.value:H.value=k.value},he=()=>{i.value.hide(),setTimeout((()=>{d.value=!1}),200)};return n({init:(e="add",a={},l)=>{if(d.value)return;d.value=!0,V.value=!1,U.value=!1,N.value=!1,H.value=a.name||"",B.value=a.preview||"",E.value="add"===e?null:l,a.extra_params?(F.value=a.extra_params.remove_bg.value,$.value=a.extra_params.tile.value):(F.value=!0,$.value=null);const t=a.folders||[],n=[];t.forEach((e=>{const a={uuid:M(),folder:e.folder,fusion_params:e.fusion_params};n.push(a)})),_e.value=n,u.value=e,A((()=>{i.value.show()}))}}),(e,n)=>{const s=m("el-icon"),v=m("el-input"),k=m("el-scrollbar"),V=m("el-option"),U=m("el-select"),A=m("t-mask");return c(),r("div",z,[d.value?(c(),h(A,{key:0,ref_key:"maskDom",ref:i},{default:g((()=>[p("div",P,[p("div",Z,[q,p("div",{class:"title-name",contenteditable:y.value,".innerHTML":H.value,onBlur:fe},null,40,G),p("div",{class:"title-handle-area",style:D({width:("add"===u.value?1.7:.8)+"rem"})},["add"===u.value?(c(),r("div",{key:0,class:"title-handle-btn",onClick:ge},[f(s,null,{default:g((()=>[(c(),h(b(y.value?w(C):w(I))))])),_:1})])):x("",!0),p("div",{class:"title-handle-btn",onClick:n[0]||(n[0]=e=>(()=>{const e={folders:[],extra_params:{preview:B.value,remove_bg:{value:F.value},tile:{value:$.value}}};_e.value.forEach((a=>{const l={folder:a.folder,fusion_params:a.fusion_params};e.folders.push(l)}));const a=JSON.stringify(e),n=new Blob([a],{type:"application/json"}),s=$.value?`${H.value.replaceAll("_tile_xy","").replaceAll("_tile_x","").replaceAll("_tile_y","")}_${$.value}.json`:`${H.value.replaceAll("_tile_xy","").replaceAll("_tile_x","").replaceAll("_tile_y","")}.json`,i=new File([n],s,{type:"application/json",lastModified:Date.now()}),d=new FormData;d.append("file",i),E.value?t(E.value,d,"statics",H.value,B.value).then((e=>{he(),o("review")})):l(d,"statics",H.value,B.value).then((e=>{he(),o("review")}))})())},[f(s,null,{default:g((()=>[f(w(O))])),_:1})])],4),p("div",{class:"close-btn",onClick:he},[f(s,null,{default:g((()=>[f(w(S))])),_:1})])]),p("div",K,[p("div",Q,[f(k,null,{default:g((()=>[(c(!0),r(T,null,L(_e.value,(e=>(c(),h(J,{key:e.uuid,name:"文件夹",col:2,"need-remove":"",onSetName:a=>{e.folder=a},onDeleteItem:()=>{(e=>{const a=_e.value.findIndex((a=>a.uuid===e));_e.value.splice(a,1)})(e.uuid)}},{default:g((()=>[p("div",W,[X,p("div",Y,[f(v,{modelValue:e.folder,"onUpdate:modelValue":a=>e.folder=a},null,8,["modelValue","onUpdate:modelValue"])])]),p("div",ee,[ae,p("div",le,[f(v,{modelValue:e.fusion_params.transparency,"onUpdate:modelValue":a=>e.fusion_params.transparency=a},null,8,["modelValue","onUpdate:modelValue"])])])])),_:2},1032,["onSetName","onDeleteItem"])))),128)),p("div",te,[p("div",ne,[p("div",{class:"folder-input",onClick:n[1]||(n[1]=e=>(()=>{const e=M();_e.value.push({uuid:e,folder:"",fusion_params:{transparency:.2}})})())},[p("i",{class:_(["bi",w(a)])},null,2),j(" 添加 ")])])])])),_:1})]),p("div",se,[f(k,null,{default:g((()=>[f(J,{name:"连续方式",col:1},{default:g((()=>[p("div",ie,[de,p("div",ue,[f(U,{modelValue:$.value,"onUpdate:modelValue":n[2]||(n[2]=e=>$.value=e),clearable:""},{default:g((()=>[(c(),r(T,null,L(R,(e=>f(V,{label:e.name,value:e.key,key:e.key},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])])])),_:1}),f(J,{name:"预览图",col:1},{default:g((()=>[p("div",oe,[ve,p("div",me,[f(v,{modelValue:B.value,"onUpdate:modelValue":n[3]||(n[3]=e=>B.value=e)},null,8,["modelValue"])])])])),_:1}),f(J,{name:"是否需要背景",col:1},{default:g((()=>[p("div",ce,[re,p("div",pe,[f(U,{modelValue:F.value,"onUpdate:modelValue":n[4]||(n[4]=e=>F.value=e)},{default:g((()=>[f(V,{value:!0,label:"是"}),f(V,{value:!1,label:"否"})])),_:1},8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):x("",!0)])}}},[["__scopeId","data-v-22a48c1d"]]);const fe={class:"statics-setting"},ge={class:"statics-setting-info"};var he=e({__name:"staticsSetting",props:["class"],setup(e,{expose:a}){const l=v({}),t=v("addOrUpdateDom"),d=e,u=()=>{n("statics").then((e=>{l.value=e.data}))},o=(...e)=>{t.value.init(...e)};return H((()=>{u()})),a({addOrUpdate:o}),(e,a)=>{const n=m("modelCard"),v=m("el-scrollbar");return c(),r("div",fe,[f(v,null,{default:g((()=>[p("div",ge,[(c(!0),r(T,null,L(l.value,(e=>(c(),h(n,{class:_(d.class),key:e.template_id,data:{name:e.template_name,preview:e.preview},onToUpdate:()=>{(({template_id:e,name:a,preview:l})=>{s(e).then((t=>{o("update",Object.assign({name:a,preview:l},t.data),e)}))})({template_id:e.template_id,name:e.template_name,preview:e.preview})},onDeleteItem:()=>{(({name:e,template_id:a})=>{i(a,"statics",e).then((e=>{u()}))})({template_id:e.template_id,name:e.template_name})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),f(_e,{ref_key:"addOrUpdateDom",ref:t,onReview:u},null,512)])}}},[["__scopeId","data-v-d52006ba"]]);const be=e=>(N("data-v-b9f4e494"),e=e(),$(),e),we={class:"add-or-update"},ye={class:"add-or-update-box"},ke={class:"title"},xe=be((()=>p("div",{class:"title-label"},"参数选择:",-1))),Ve=["contenteditable",".innerHTML"],Ue={class:"content"},De={class:"setting-list prompts-list"},Ie={class:"setting-item-data-name"},Ce={class:"setting-item-data-value"},Oe={class:"setting-item-data"},Se=["onClick"],Te=be((()=>p("div",{class:"setting-item-data-value"},null,-1))),Le={class:"setting-handle"},je={class:"setting-item-data-value"},Me={class:"setting-list params-list"},Ae={class:"setting-item-data"},Ne=be((()=>p("div",{class:"setting-item-data-name"},"value",-1))),$e={class:"setting-item-data-value"},He={class:"setting-item-data"},Be=be((()=>p("div",{class:"setting-item-data-name"},"权重",-1))),Ee={class:"setting-item-data-value"},Fe={class:"setting-item-data"},Je=be((()=>p("div",{class:"setting-item-data-name"},"预览图地址",-1))),Re={class:"setting-item-data-value"},ze={class:"setting-item-data"},Pe=be((()=>p("div",{class:"setting-item-data-name"},"value",-1))),Ze={class:"setting-item-data-value"},qe={class:"setting-item-data"},Ge=be((()=>p("div",{class:"setting-item-data-name"},"风格参考",-1))),Ke={class:"setting-item-data-value"},Qe={class:"setting-item-data"},We=be((()=>p("div",{class:"setting-item-data-name"},"结构参考",-1))),Xe={class:"setting-item-data-value"},Ye={class:"setting-item-data"},ea=be((()=>p("div",{class:"setting-item-data-name"},"value",-1))),aa={class:"setting-item-data-value"};var la=e({__name:"promptSettingAddOrUpdate",emits:["review"],setup(e,{expose:n,emit:s}){const i=v("maskDom"),d=v(!1),u=v("add"),o=s,y=v(!1),k=v(null),V=v(!1),U=v(!1),N=v(!1);v(new Set([])),v(new Set([]));const $=v(""),H=v({lora:"",weight:100}),E=v(!0),F=v(""),R=v(null),z=v({ref_style:!0,ref_struct:!0,value:""});v({probability:20,value:""}),v({probability:20,value:""});const P=v([]),Z=({target:e})=>{k.value=e.innerHTML},q=()=>{y.value=!y.value,y.value?$.value=$.value:$.value=k.value},G=()=>{i.value.hide(),setTimeout((()=>{d.value=!1}),200)};return n({init:(e="add",a={},l)=>{if(d.value)return;d.value=!0,V.value=!1,U.value=!1,N.value=!1,$.value=a.name||"",F.value=a.preview||"",R.value="add"===e?null:l,a.extra_params?(a.extra_params.lora.weight*=100,H.value.lora=a.extra_params.lora.value,H.value.weight=a.extra_params.lora.weight,z.value=a.extra_params.reference,E.value=a.extra_params.remove_bg.value):(H.value={lora:"",weight:100},z.value={ref_style:!0,ref_struct:!0,value:""},E.value=!0);const t=a.contents||[],n=[];t.forEach((e=>{const a={uuid:M(),content:e.content,maxLength:0,elements:[]},l=[0,0];Object.keys(e).forEach((t=>{t.includes("elements")&&(l.push(Number(t.replaceAll("elements_",""))),a.elements.push({name:t,values:e[t]}))})),a.maxLength=Math.max(...l),n.push(a)})),P.value=n,u.value=e,A((()=>{i.value.show()}))}}),(e,n)=>{const s=m("el-icon"),v=m("el-select"),k=m("el-scrollbar"),V=m("el-input"),U=m("el-input-number"),A=m("el-option"),N=m("t-mask");return c(),r("div",we,[d.value?(c(),h(N,{key:0,ref_key:"maskDom",ref:i},{default:g((()=>[p("div",ye,[p("div",ke,[xe,p("div",{class:"title-name",contenteditable:y.value,".innerHTML":$.value,onBlur:Z},null,40,Ve),p("div",{class:"title-handle-area",style:D({width:("add"===u.value?1.7:.8)+"rem"})},["add"===u.value?(c(),r("div",{key:0,class:"title-handle-btn",onClick:q},[f(s,null,{default:g((()=>[(c(),h(b(y.value?w(C):w(I))))])),_:1})])):x("",!0),p("div",{class:"title-handle-btn",onClick:n[0]||(n[0]=e=>(()=>{const e=JSON.parse(JSON.stringify(H.value));e.weight/=100;const a={contents:[],extra_params:{lora:{value:e.lora||null,weight:e.weight},reference:z.value,remove_bg:{value:E.value}}};P.value.forEach((e=>{const l={content:e.content};e.elements.forEach((e=>{l[e.name]=e.values})),a.contents.push(l)}));const n=JSON.stringify(a),s=new Blob([n],{type:"application/json"}),i=new File([s],`${$.value}.json`,{type:"application/json",lastModified:Date.now()}),d=new FormData;d.append("file",i),R.value?t(R.value,d,"prompts",$.value,F.value).then((e=>{G(),o("review")})):l(d,"prompts",$.value,F.value).then((e=>{G(),o("review")}))})())},[f(s,null,{default:g((()=>[f(w(O))])),_:1})])],4),p("div",{class:"close-btn",onClick:G},[f(s,null,{default:g((()=>[f(w(S))])),_:1})])]),p("div",Ue,[p("div",De,[f(k,null,{default:g((()=>[(c(!0),r(T,null,L(P.value,(e=>(c(),h(J,{key:e.uuid,name:e.content,col:e.elements.length+1,"need-remove":"","need-edit":"",onSetName:a=>{e.content=a},onDeleteItem:()=>{(e=>{const a=P.value.findIndex((a=>a.uuid===e));P.value.splice(a,1)})(e.uuid)}},{default:g((()=>[(c(!0),r(T,null,L(e.elements,(a=>(c(),r("div",{class:"setting-item-data",key:a.name},[p("div",Ie,[j(B(a.name.replace("elements_","参数"))+" ",1),f(s,{onClick:l=>((e,a)=>{const l=P.value.findIndex((a=>a.uuid===e)),t=P.value[l].elements.findIndex((e=>e.name===a));P.value[l].content=P.value[l].content.replaceAll(`{${a}}`,""),P.value[l].elements.splice(t,1)})(e.uuid,a.name),class:"handle-btn"},{default:g((()=>[f(w(S))])),_:2},1032,["onClick"])]),p("div",Ce,[f(v,{"reserve-keyword":!1,"default-first-option":"","allow-create":"",modelValue:a.values,"onUpdate:modelValue":e=>a.values=e,multiple:"",filterable:""},null,8,["modelValue","onUpdate:modelValue"])])])))),128)),p("div",Oe,[p("div",{class:"setting-item-data-name pointer",onClick:a=>((e,a)=>{const l=P.value.findIndex((a=>a.uuid===e));P.value[l].maxLength+=1,P.value[l].content+=`{elements_${P.value[l].maxLength}}`,P.value[l].elements.push({name:`elements_${P.value[l].maxLength}`,values:[]})})(e.uuid)},"添加",8,Se),Te])])),_:2},1032,["name","col","onSetName","onDeleteItem"])))),128)),p("div",Le,[p("div",je,[p("div",{class:"content-input",onClick:n[1]||(n[1]=e=>(()=>{const e=M();P.value.push({uuid:e,content:"",maxLength:0,elements:[]})})())},[p("i",{class:_(["bi",w(a)])},null,2),j(" 添加 ")])])])])),_:1})]),p("div",Me,[f(k,null,{default:g((()=>[f(J,{name:"lora",col:2},{default:g((()=>[p("div",Ae,[Ne,p("div",$e,[f(V,{modelValue:H.value.lora,"onUpdate:modelValue":n[2]||(n[2]=e=>H.value.lora=e)},null,8,["modelValue"])])]),p("div",He,[Be,p("div",Ee,[f(U,{controls:!1,min:0,max:100,modelValue:H.value.weight,"onUpdate:modelValue":n[3]||(n[3]=e=>H.value.weight=e)},null,8,["modelValue"]),j(" % ")])])])),_:1}),f(J,{name:"预览图",col:1},{default:g((()=>[p("div",Fe,[Je,p("div",Re,[f(V,{modelValue:F.value,"onUpdate:modelValue":n[4]||(n[4]=e=>F.value=e)},null,8,["modelValue"])])])])),_:1}),f(J,{name:"是否需要背景",col:1},{default:g((()=>[p("div",ze,[Pe,p("div",Ze,[f(v,{modelValue:E.value,"onUpdate:modelValue":n[5]||(n[5]=e=>E.value=e)},{default:g((()=>[f(A,{value:!0,label:"是"}),f(A,{value:!1,label:"否"})])),_:1},8,["modelValue"])])])])),_:1}),f(J,{name:"参考图",col:3},{default:g((()=>[p("div",qe,[Ge,p("div",Ke,[f(v,{modelValue:z.value.ref_style,"onUpdate:modelValue":n[6]||(n[6]=e=>z.value.ref_style=e)},{default:g((()=>[f(A,{value:!0,label:"是"}),f(A,{value:!1,label:"否"})])),_:1},8,["modelValue"])])]),p("div",Qe,[We,p("div",Xe,[f(v,{modelValue:z.value.ref_struct,"onUpdate:modelValue":n[7]||(n[7]=e=>z.value.ref_struct=e)},{default:g((()=>[f(A,{value:!0,label:"是"}),f(A,{value:!1,label:"否"})])),_:1},8,["modelValue"])])]),p("div",Ye,[ea,p("div",aa,[f(V,{modelValue:z.value.value,"onUpdate:modelValue":n[8]||(n[8]=e=>z.value.value=e)},null,8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):x("",!0)])}}},[["__scopeId","data-v-b9f4e494"]]);const ta={class:"prompt-setting"},na={class:"prompt-setting-info"};var sa=e({__name:"promptSetting",props:["class"],setup(e,{expose:a}){const l=v({}),t=v("addOrUpdateDom"),d=e,u=()=>{n("prompts").then((e=>{l.value=e.data}))},o=(...e)=>{t.value.init(...e)};return H((()=>{u()})),a({addOrUpdate:o}),(e,a)=>{const n=m("modelCard"),v=m("el-scrollbar");return c(),r("div",ta,[f(v,null,{default:g((()=>[p("div",na,[(c(!0),r(T,null,L(l.value,(e=>(c(),h(n,{class:_(d.class),key:e.template_id,data:{name:e.template_name,preview:e.preview},onToUpdate:()=>{(({template_id:e,name:a,preview:l})=>{s(e).then((t=>{o("update",Object.assign({name:a,preview:l},t.data),e)}))})({template_id:e.template_id,name:e.template_name,preview:e.preview})},onDeleteItem:()=>{(({name:e,template_id:a})=>{i(a,"prompts",e).then((e=>{u()}))})({template_id:e.template_id,name:e.template_name})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),f(la,{ref_key:"addOrUpdateDom",ref:t,onReview:u},null,512)])}}},[["__scopeId","data-v-2dc0c0ca"]]);const ia=e=>(N("data-v-7970af36"),e=e(),$(),e),da={class:"add-or-update"},ua={class:"add-or-update-box"},oa={class:"title"},va=ia((()=>p("div",{class:"title-label"},"参数选择:",-1))),ma=["contenteditable",".innerHTML"],ca={class:"folder"},ra={class:"setting-list folder-list"},pa={class:"setting-item-data-name"},_a={class:"setting-item-data-value"},fa={class:"setting-item-data"},ga=ia((()=>p("div",{class:"setting-item-data-value"},null,-1))),ha={class:"setting-list params-list"},ba={class:"setting-item-data"},wa=ia((()=>p("div",{class:"setting-item-data-name"},"value",-1))),ya={class:"setting-item-data-value"},ka={class:"setting-item-data"},xa=ia((()=>p("div",{class:"setting-item-data-name"},"value",-1))),Va={class:"setting-item-data-value"};var Ua=e({__name:"backgroundSettingAddOrUpdate",emits:["review"],setup(e,{expose:n,emit:s}){const i=v("maskDom"),o=v(!1),y=v("add"),k=s,V=v(!1),U=v(null),N=v(!1),$=v(!1),H=v(!1);v(new Set([])),v(new Set([]));const B=v(""),E=v([]),F=v(0),R=v(null),z=({target:e})=>{U.value=e.innerHTML},P=v(null),Z=[{name:"横向二方连续",key:"tile_x"},{name:"纵向二方连续",key:"tile_y"},{name:"四方连续",key:"tile_xy"}],q=()=>{V.value=!V.value,V.value?B.value=B.value:B.value=U.value},G=()=>{i.value.hide(),setTimeout((()=>{o.value=!1}),200)};return n({init:(e="add",a={},l)=>{o.value||(o.value=!0,N.value=!1,$.value=!1,H.value=!1,B.value=a.name||"",R.value="add"===e?null:l,a.colors?E.value=a.colors.map((e=>({uuid:M(),value:d(e)}))):E.value=[],a.extra_params?(F.value=a.extra_params.variation,P.value=a.extra_params.tile):(F.value=0,P.value=null),y.value=e,A((()=>{i.value.show()})))}}),(e,n)=>{const s=m("el-icon"),d=m("el-color-picker"),v=m("el-scrollbar"),U=m("el-option"),A=m("el-select"),N=m("el-input-number"),$=m("t-mask");return c(),r("div",da,[o.value?(c(),h($,{key:0,ref_key:"maskDom",ref:i},{default:g((()=>[p("div",ua,[p("div",oa,[va,p("div",{class:"title-name",contenteditable:V.value,".innerHTML":B.value,onBlur:z},null,40,ma),p("div",{class:"title-handle-area",style:D({width:("add"===y.value?1.7:.8)+"rem"})},["add"===y.value?(c(),r("div",{key:0,class:"title-handle-btn",onClick:q},[f(s,null,{default:g((()=>[(c(),h(b(V.value?w(C):w(I))))])),_:1})])):x("",!0),p("div",{class:"title-handle-btn",onClick:n[0]||(n[0]=e=>(()=>{const e={colors:E.value.map((e=>u(e.value))),extra_params:{variation:F.value,tile:P.value}},a=JSON.stringify(e),n=new Blob([a],{type:"application/json"}),s=P.value?`${B.value.replaceAll("_tile_xy","").replaceAll("_tile_x","").replaceAll("_tile_y","")}_${P.value}.json`:`${B.value.replaceAll("_tile_xy","").replaceAll("_tile_x","").replaceAll("_tile_y","")}.json`,i=new File([n],s,{type:"application/json",lastModified:Date.now()}),d=new FormData;d.append("file",i),R.value?t(R.value,d,"colors",B.value,"").then((e=>{G(),k("review")})):l(d,"colors",B.value,"").then((e=>{G(),k("review")}))})())},[f(s,null,{default:g((()=>[f(w(O))])),_:1})])],4),p("div",{class:"close-btn",onClick:G},[f(s,null,{default:g((()=>[f(w(S))])),_:1})])]),p("div",ca,[p("div",ra,[f(v,null,{default:g((()=>[f(J,{name:"颜色",col:E.value.length+1,onSetName:n[2]||(n[2]=a=>{e.n.folder=a}),onDeleteItem:n[3]||(n[3]=()=>{e.deleteFolder(e.n.uuid)})},{default:g((()=>[(c(!0),r(T,null,L(E.value,(e=>(c(),r("div",{class:"setting-item-data",key:e.uuid},[p("div",pa,[j(" 颜色 "),f(s,{onClick:a=>(e=>{const a=E.value.findIndex((a=>a.uuid===e));E.value.splice(a,1)})(e.uuid),class:"handle-btn"},{default:g((()=>[f(w(S))])),_:2},1032,["onClick"])]),p("div",_a,[f(d,{"color-format":"rgba","show-alpha":"",style:{width:"100%"},modelValue:e.value,"onUpdate:modelValue":a=>e.value=a},null,8,["modelValue","onUpdate:modelValue"])])])))),128)),p("div",fa,[p("div",{class:"setting-item-data-name pointer",onClick:n[1]||(n[1]=e=>(()=>{const e=M();E.value.push({uuid:e,value:"rgba(0,0,0,1)"})})())},[p("i",{class:_(["bi",w(a)])},null,2),j(" 添加 ")]),ga])])),_:1},8,["col"])])),_:1})]),p("div",ha,[f(v,null,{default:g((()=>[f(J,{name:"连续方式",col:1},{default:g((()=>[p("div",ba,[wa,p("div",ya,[f(A,{modelValue:P.value,"onUpdate:modelValue":n[4]||(n[4]=e=>P.value=e),clearable:""},{default:g((()=>[(c(),r(T,null,L(Z,(e=>f(U,{label:e.name,value:e.key,key:e.key},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])])])),_:1}),f(J,{name:"变化",col:1},{default:g((()=>[p("div",ka,[xa,p("div",Va,[f(N,{modelValue:F.value,"onUpdate:modelValue":n[5]||(n[5]=e=>F.value=e),controls:!1},null,8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):x("",!0)])}}},[["__scopeId","data-v-7970af36"]]);const Da={class:"statics-setting"},Ia={class:"statics-setting-info"};var Ca=e({__name:"backgroundSetting",props:["class"],setup(e,{expose:a}){const l=v({}),t=v("addOrUpdateDom"),d=e,u=()=>{n("colors").then((e=>{l.value=e.data}))},o=(...e)=>{t.value.init(...e)};return H((()=>{u()})),a({addOrUpdate:o}),(e,a)=>{const n=m("modelCard"),v=m("el-scrollbar");return c(),r("div",Da,[f(v,null,{default:g((()=>[p("div",Ia,[(c(!0),r(T,null,L(l.value,(e=>(c(),h(n,{class:_(d.class),key:e.template_id,data:{name:e.template_name,preview:e.preview},onToUpdate:()=>{(({template_id:e,name:a,preview:l})=>{s(e).then((t=>{o("update",Object.assign({name:a,preview:l},t.data),e)}))})({template_id:e.template_id,name:e.template_name,preview:e.preview})},onDeleteItem:()=>{(({name:e,template_id:a})=>{i(a,"colors",e).then((e=>{u()}))})({template_id:e.template_id,name:e.template_name})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),f(Ua,{ref_key:"addOrUpdateDom",ref:t,onReview:u},null,512)])}}},[["__scopeId","data-v-dad63e58"]]);const Oa=e=>(N("data-v-3fc8f36c"),e=e(),$(),e),Sa={class:"add-or-update"},Ta={class:"add-or-update-box"},La={class:"title"},ja=Oa((()=>p("div",{class:"title-label"},"参数选择:",-1))),Ma=["contenteditable",".innerHTML"],Aa={class:"content"},Na={class:"setting-list prompts-list"},$a={class:"setting-item-data-name"},Ha={class:"setting-item-data-value"},Ba={class:"setting-item-data"},Ea=["onClick"],Fa=Oa((()=>p("div",{class:"setting-item-data-value"},null,-1))),Ja={class:"setting-handle"},Ra={class:"setting-item-data-value"},za={class:"setting-list params-list"},Pa={class:"setting-item-data"},Za=Oa((()=>p("div",{class:"setting-item-data-name"},"value",-1))),qa={class:"setting-item-data-value"},Ga={class:"setting-item-data"},Ka=Oa((()=>p("div",{class:"setting-item-data-name"},"value",-1))),Qa={class:"setting-item-data-value"},Wa={class:"setting-item-data"},Xa=Oa((()=>p("div",{class:"setting-item-data-name"},"value",-1))),Ya={class:"setting-item-data-value"};var el=e({__name:"textSettingAddOrUpdate",emits:["review"],setup(e,{expose:n,emit:s}){const i=v("maskDom"),o=v(!1),y=v("add"),k=s,V=v(!1),U=v(null),N=v(!1),$=v(!1),H=v(!1);v(new Set([])),v(new Set([]));const E=v(""),F=v(""),R=v(""),z=v("rgba(0,0,0,1)"),P=v([]),Z=v(null),q=({target:e})=>{U.value=e.innerHTML},G=()=>{V.value=!V.value,V.value?E.value=E.value:E.value=U.value},K=()=>{i.value.hide(),setTimeout((()=>{o.value=!1}),200)};return n({init:(e="add",a={},l)=>{if(o.value)return;o.value=!0,N.value=!1,$.value=!1,H.value=!1,E.value=a.name||"",Z.value="add"===e?null:l,a.extra_params?(F.value=a.extra_params.font,R.value=a.extra_params.font_size,z.value=d(a.extra_params.font_color)):(F.value="",R.value="",z.value="rgba(0,0,0,1)");const t=a.contents||[],n=[];t.forEach((e=>{const a={uuid:M(),content:e.content,maxLength:0,elements:[]},l=[0,0];Object.keys(e).forEach((t=>{t.includes("elements")&&(l.push(Number(t.replaceAll("elements_",""))),a.elements.push({name:t,values:e[t]}))})),a.maxLength=Math.max(...l),n.push(a)})),P.value=n,y.value=e,A((()=>{i.value.show()}))}}),(e,n)=>{const s=m("el-icon"),d=m("el-select"),v=m("el-scrollbar"),U=m("el-input"),A=m("el-input-number"),N=m("el-color-picker"),$=m("t-mask");return c(),r("div",Sa,[o.value?(c(),h($,{key:0,ref_key:"maskDom",ref:i},{default:g((()=>[p("div",Ta,[p("div",La,[ja,p("div",{class:"title-name",contenteditable:V.value,".innerHTML":E.value,onBlur:q},null,40,Ma),p("div",{class:"title-handle-area",style:D({width:("add"===y.value?1.7:.8)+"rem"})},["add"===y.value?(c(),r("div",{key:0,class:"title-handle-btn",onClick:G},[f(s,null,{default:g((()=>[(c(),h(b(V.value?w(C):w(I))))])),_:1})])):x("",!0),p("div",{class:"title-handle-btn",onClick:n[0]||(n[0]=e=>(()=>{const e={contents:[],extra_params:{font:F.value,font_size:R.value,font_color:u(z.value)}};P.value.forEach((a=>{const l={content:a.content};a.elements.forEach((e=>{l[e.name]=e.values})),e.contents.push(l)}));const a=JSON.stringify(e),n=new Blob([a],{type:"application/json"}),s=new File([n],`${E.value}.json`,{type:"application/json",lastModified:Date.now()}),i=new FormData;i.append("file",s),Z.value?t(Z.value,i,"texts",E.value,"").then((e=>{K(),k("review")})):l(i,"texts",E.value,"").then((e=>{K(),k("review")}))})())},[f(s,null,{default:g((()=>[f(w(O))])),_:1})])],4),p("div",{class:"close-btn",onClick:K},[f(s,null,{default:g((()=>[f(w(S))])),_:1})])]),p("div",Aa,[p("div",Na,[f(v,null,{default:g((()=>[(c(!0),r(T,null,L(P.value,(e=>(c(),h(J,{key:e.uuid,name:e.content,col:e.elements.length+1,"need-remove":"","need-edit":"",onSetName:a=>{e.content=a},onDeleteItem:()=>{(e=>{const a=P.value.findIndex((a=>a.uuid===e));P.value.splice(a,1)})(e.uuid)}},{default:g((()=>[(c(!0),r(T,null,L(e.elements,(a=>(c(),r("div",{class:"setting-item-data",key:a.name},[p("div",$a,[j(B(a.name.replace("elements_","参数"))+" ",1),f(s,{onClick:l=>((e,a)=>{const l=P.value.findIndex((a=>a.uuid===e)),t=P.value[l].elements.findIndex((e=>e.name===a));P.value[l].content=P.value[l].content.replaceAll(`{${a}}`,""),P.value[l].elements.splice(t,1)})(e.uuid,a.name),class:"handle-btn"},{default:g((()=>[f(w(S))])),_:2},1032,["onClick"])]),p("div",Ha,[f(d,{"reserve-keyword":!1,"default-first-option":"","allow-create":"",modelValue:a.values,"onUpdate:modelValue":e=>a.values=e,multiple:"",filterable:""},null,8,["modelValue","onUpdate:modelValue"])])])))),128)),p("div",Ba,[p("div",{class:"setting-item-data-name pointer",onClick:a=>((e,a)=>{const l=P.value.findIndex((a=>a.uuid===e));P.value[l].maxLength+=1,P.value[l].content+=`{elements_${P.value[l].maxLength}}`,P.value[l].elements.push({name:`elements_${P.value[l].maxLength}`,values:[]})})(e.uuid)},[p("i",{class:_(["bi",w(a)])},null,2),j(" 添加 ")],8,Ea),Fa])])),_:2},1032,["name","col","onSetName","onDeleteItem"])))),128)),p("div",Ja,[p("div",Ra,[p("div",{class:"content-input",onClick:n[1]||(n[1]=e=>(()=>{const e=M();P.value.push({uuid:e,content:"",maxLength:0,elements:[]})})())},[p("i",{class:_(["bi",w(a)])},null,2),j(" 添加文本 ")])])])])),_:1})]),p("div",za,[f(v,null,{default:g((()=>[f(J,{name:"字体",col:1},{default:g((()=>[p("div",Pa,[Za,p("div",qa,[f(U,{modelValue:F.value,"onUpdate:modelValue":n[2]||(n[2]=e=>F.value=e)},null,8,["modelValue"])])])])),_:1}),f(J,{name:"字号",col:1},{default:g((()=>[p("div",Ga,[Ka,p("div",Qa,[f(A,{modelValue:R.value,"onUpdate:modelValue":n[3]||(n[3]=e=>R.value=e),controls:!1},null,8,["modelValue"])])])])),_:1}),f(J,{name:"颜色",col:1},{default:g((()=>[p("div",Wa,[Xa,p("div",Ya,[f(N,{"color-format":"rgba","show-alpha":"",style:{width:"100%"},modelValue:z.value,"onUpdate:modelValue":n[4]||(n[4]=e=>z.value=e)},null,8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):x("",!0)])}}},[["__scopeId","data-v-3fc8f36c"]]);const al={class:"statics-setting"},ll={class:"statics-setting-info"};var tl=e({__name:"textSetting",props:["class"],setup(e,{expose:a}){const l=v({}),t=v("addOrUpdateDom"),d=e,u=()=>{n("texts").then((e=>{l.value=e.data}))},o=(...e)=>{t.value.init(...e)};return H((()=>{u()})),a({addOrUpdate:o}),(e,a)=>{const n=m("modelCard"),v=m("el-scrollbar");return c(),r("div",al,[f(v,null,{default:g((()=>[p("div",ll,[(c(!0),r(T,null,L(l.value,(e=>(c(),h(n,{class:_(d.class),key:e.template_id,data:{name:e.template_name,preview:e.preview},onToUpdate:()=>{(({template_id:e,name:a,preview:l})=>{s(e).then((t=>{o("update",Object.assign({name:a,preview:l},t.data),e)}))})({template_id:e.template_id,name:e.template_name,preview:e.preview})},onDeleteItem:()=>{(({name:e,template_id:a})=>{i(a,"texts",e).then((e=>{u()}))})({template_id:e.template_id,name:e.template_name})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),f(el,{ref_key:"addOrUpdateDom",ref:t,onReview:u},null,512)])}}},[["__scopeId","data-v-ef4b08ba"]]);const nl={class:"prompt-setting-outer"},sl={class:"prompt-setting-handle-area"},il={class:"change-setting-type-area"},dl=["onClick"],ul={class:"prompt-setting-component-area"};var ol=e({__name:"index",props:["class"],setup(e){const a=e,l=[{name:"静态层配置",component:he},{name:"动态层配置",component:sa},{name:"纯色层配置",component:Ca},{name:"文本层配置",component:tl}],t=v(0),n=v("componentDom");return H((()=>{window.loading||(window.loading=o()),setTimeout((()=>{window.loading.close(),window.loading=null}),300)})),(e,s)=>{const i=m("t-button");return c(),r("div",nl,[p("div",sl,[p("div",il,[p("div",{class:"component-selected",style:D({left:3.2*t.value+.05+"rem"})},null,4),(c(),r(T,null,L(l,((e,a)=>p("div",{class:"component-item",onClick:e=>t.value=a,key:e.name},B(e.name),9,dl))),64))]),f(i,{style:{margin:"0",width:"2.5rem","text-align":"center"},type:"warn",onClick:s[0]||(s[0]=e=>{n.value.addOrUpdate()})},{default:g((()=>[j("新增")])),_:1})]),p("div",ul,[(c(),h(b(l[t.value].component),{class:_(a.class),ref_key:"componentDom",ref:n},null,8,["class"]))])])}}},[["__scopeId","data-v-2ea6960d"]]);export{ol as default};
