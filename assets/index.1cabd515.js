import{r as e,B as a,e as l,c as t,g as n,h as s,j as i,w as d,f as u,T as o,u as v,a0 as c,a1 as m,b as r,i as p,a as f,n as g,N as _,a2 as h,a3 as b,M as w,F as k,A as y,Q as x,K as V,s as U,t as D,o as I,q as C,z as O}from"./lib.adc83b71.js";import{_ as S,s as T,g as L,a as j,d as M,b as N,r as H,T as B}from"./index.13b9e20e.js";const E={class:"setting-list-item"},$=["contenteditable",".innerHTML"];var F=S({__name:"settingItem",props:{name:{type:String,default:""},itemList:{type:Boolean,default:!1},needRemove:{type:Boolean,default:!1},col:{type:Number,default:0},needEdit:{type:Boolean,default:!1}},emits:["deleteItem"],setup(_,{emit:h}){const b=e(!1),w=h,k=_,y=e=>{e===Number(k.needEdit)&&(b.value=!b.value)},x=({target:e})=>{w("setName",e.innerHTML)};return(e,h)=>{const V=a("el-icon");return l(),t("div",E,[n("div",{class:"setting-item-title",onClick:h[2]||(h[2]=p((e=>y(0)),["stop"]))},[n("div",{class:s(["setting-handle-icon",{selected:b.value}]),onClick:h[0]||(h[0]=e=>y(1))},[i(V,null,{default:d((()=>[(l(),u(o(v(c))))])),_:1})],2),n("div",{class:"setting-name",contenteditable:k.needEdit,".innerHTML":_.name,onBlur:x},null,40,$),k.needRemove?(l(),t("div",{key:0,class:"settgin-remove-handle",onClick:h[1]||(h[1]=e=>w("deleteItem"))},[i(V,null,{default:d((()=>[i(v(m))])),_:1})])):r("",!0)]),n("div",{class:"setting-item-data-list",style:g({height:b.value?1.2*k.col+"rem":"0rem"})},[f(e.$slots,"default",{},void 0,!0)],4)])}}},[["__scopeId","data-v-71cf0196"]]);const A=e=>(U("data-v-4a6b28cb"),e=e(),D(),e),J={class:"add-or-update"},R={class:"add-or-update-box"},z={class:"title"},q=A((()=>n("div",{class:"title-label"},"参数选择:",-1))),K=["contenteditable",".innerHTML"],Q={class:"folder"},G={class:"setting-list folder-list"},P={class:"setting-item-data"},W=A((()=>n("div",{class:"setting-item-data-name"}," 文件夹 ",-1))),X={class:"setting-item-data-value"},Y={class:"setting-item-data"},Z=A((()=>n("div",{class:"setting-item-data-name"}," 透明度 ",-1))),ee={class:"setting-item-data-value"},ae={class:"setting-handle"},le={class:"setting-item-data-value"},te={class:"setting-list params-list"},ne={class:"setting-item-data"},se=A((()=>n("div",{class:"setting-item-data-name"},"value",-1))),ie={class:"setting-item-data-value"},de={class:"setting-item-data"},ue=A((()=>n("div",{class:"setting-item-data-name"},"预览图地址",-1))),oe={class:"setting-item-data-value"},ve={class:"setting-item-data"},ce=A((()=>n("div",{class:"setting-item-data-name"},"value",-1))),me={class:"setting-item-data-value"};var re=S({__name:"staticsSettingAddOrUpdate",emits:["review"],setup(s,{expose:c,emit:m}){const p=e("maskDom"),f=e(!1),U=e("add"),D=m,I=e(!1),C=e(null),O=e(!1),S=e(!1),L=e(!1);e(new Set([])),e(new Set([]));const j=e(null),M=e(""),N=e(""),H=e(!0),B=[{name:"横向二方连续",key:"tile_x"},{name:"纵向二方连续",key:"tile_y"},{name:"四方连续",key:"tile_xy"}],E=e([]),$=({target:e})=>{C.value=e.innerHTML},A=()=>{I.value=!I.value,I.value?M.value=M.value:M.value=C.value},re=()=>{p.value.hide(),setTimeout((()=>{f.value=!1}),200)};return c({init:(e="add",a={})=>{if(f.value)return;f.value=!0,O.value=!1,S.value=!1,L.value=!1,M.value=a.name||"",N.value=a.preview||"",a.extra_params?(H.value=a.extra_params.remove_bg.value,j.value=a.extra_params.tile.value):(H.value=!0,j.value=null);const l=a.folders||[],t=[];l.forEach((e=>{const a={uuid:x(),folder:e.folder,fusion_params:e.fusion_params};t.push(a)})),E.value=t,U.value=e,V((()=>{p.value.show()}))}}),(e,s)=>{const c=a("el-icon"),m=a("el-input"),V=a("el-scrollbar"),C=a("el-option"),O=a("el-select"),S=a("t-mask");return l(),t("div",J,[f.value?(l(),u(S,{key:0,ref_key:"maskDom",ref:p},{default:d((()=>[n("div",R,[n("div",z,[q,n("div",{class:"title-name",contenteditable:I.value,".innerHTML":M.value,onBlur:$},null,40,K),n("div",{class:"title-handle-area",style:g({width:("add"===U.value?1.7:.8)+"rem"})},["add"===U.value?(l(),t("div",{key:0,class:"title-handle-btn",onClick:A},[i(c,null,{default:d((()=>[(l(),u(o(I.value?v(h):v(_))))])),_:1})])):r("",!0),n("div",{class:"title-handle-btn",onClick:s[0]||(s[0]=e=>(()=>{const e={folders:[],extra_params:{preview:N.value,remove_bg:{value:H.value},tile:{value:j.value}}};E.value.forEach((a=>{const l={folder:a.folder,fusion_params:a.fusion_params};e.folders.push(l)}));const a=JSON.stringify(e),l=new Blob([a],{type:"application/json"}),t=new File([l],`${M.value}.json`,{type:"application/json",lastModified:Date.now()}),n=new FormData;n.append("file",t),T(n,"statics",M.value,N.value).then((e=>{re(),D("review")}))})())},[i(c,null,{default:d((()=>[i(v(b))])),_:1})])],4),n("div",{class:"close-btn",onClick:re},[i(c,null,{default:d((()=>[i(v(w))])),_:1})])]),n("div",Q,[n("div",G,[i(V,null,{default:d((()=>[(l(!0),t(k,null,y(E.value,(e=>(l(),u(F,{key:e.uuid,name:"文件夹",col:2,"need-remove":"",onSetName:a=>{e.folder=a},onDeleteItem:()=>{(e=>{const a=E.value.findIndex((a=>a.uuid===e));E.value.splice(a,1)})(e.uuid)}},{default:d((()=>[n("div",P,[W,n("div",X,[i(m,{modelValue:e.folder,"onUpdate:modelValue":a=>e.folder=a},null,8,["modelValue","onUpdate:modelValue"])])]),n("div",Y,[Z,n("div",ee,[i(m,{modelValue:e.fusion_params.transparency,"onUpdate:modelValue":a=>e.fusion_params.transparency=a},null,8,["modelValue","onUpdate:modelValue"])])])])),_:2},1032,["onSetName","onDeleteItem"])))),128)),n("div",ae,[n("div",le,[n("div",{class:"folder-input",onClick:s[1]||(s[1]=e=>(()=>{const e=x();E.value.push({uuid:e,folder:"",fusion_params:{transparency:.2}})})())},"新增")])])])),_:1})]),n("div",te,[i(V,null,{default:d((()=>[i(F,{name:"连续方式",col:1},{default:d((()=>[n("div",ne,[se,n("div",ie,[i(O,{modelValue:j.value,"onUpdate:modelValue":s[2]||(s[2]=e=>j.value=e),clearable:""},{default:d((()=>[(l(),t(k,null,y(B,(e=>i(C,{label:e.name,value:e.key,key:e.key},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])])])),_:1}),i(F,{name:"预览图",col:1},{default:d((()=>[n("div",de,[ue,n("div",oe,[i(m,{modelValue:N.value,"onUpdate:modelValue":s[3]||(s[3]=e=>N.value=e)},null,8,["modelValue"])])])])),_:1}),i(F,{name:"是否需要背景",col:1},{default:d((()=>[n("div",ve,[ce,n("div",me,[i(O,{modelValue:H.value,"onUpdate:modelValue":s[4]||(s[4]=e=>H.value=e)},{default:d((()=>[i(C,{value:!0,label:"是"}),i(C,{value:!1,label:"否"})])),_:1},8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):r("",!0)])}}},[["__scopeId","data-v-4a6b28cb"]]);const pe={class:"statics-setting"},fe={class:"statics-setting-info"};var ge=S({__name:"staticsSetting",props:["class"],setup(o,{expose:v}){const c=e({}),m=e("addOrUpdateDom"),r=o,p=()=>{L("statics").then((e=>{c.value=e.templates}))},f=(...e)=>{m.value.init(...e)};return I((()=>{p()})),v({addOrUpdate:f}),(e,o)=>{const v=a("modelCard"),g=a("el-scrollbar");return l(),t("div",pe,[i(g,null,{default:d((()=>[n("div",fe,[(l(!0),t(k,null,y(Object.keys(c.value),(e=>(l(),u(v,{class:s(r.class),key:e,data:{name:e,preview:c.value[e].preview},onToUpdate:()=>{(({name:e,preview:a})=>{j("statics",e).then((l=>{f("update",Object.assign({name:e,preview:a},l))}))})({name:e,preview:c.value[e].preview})},onDeleteItem:()=>{(({name:e})=>{M("statics",e).then((e=>{p()}))})({name:e})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),i(re,{ref_key:"addOrUpdateDom",ref:m,onReview:p},null,512)])}}},[["__scopeId","data-v-75df05b8"]]);const _e=e=>(U("data-v-0e6fb23a"),e=e(),D(),e),he={class:"add-or-update"},be={class:"add-or-update-box"},we={class:"title"},ke=_e((()=>n("div",{class:"title-label"},"参数选择:",-1))),ye=["contenteditable",".innerHTML"],xe={class:"content"},Ve={class:"setting-list prompts-list"},Ue={class:"setting-item-data-name"},De={class:"setting-item-data-value"},Ie={class:"setting-item-data"},Ce=["onClick"],Oe=_e((()=>n("div",{class:"setting-item-data-value"},null,-1))),Se={class:"setting-handle"},Te={class:"setting-item-data-value"},Le={class:"setting-list params-list"},je={class:"setting-item-data"},Me=_e((()=>n("div",{class:"setting-item-data-name"},"value",-1))),Ne={class:"setting-item-data-value"},He={class:"setting-item-data"},Be=_e((()=>n("div",{class:"setting-item-data-name"},"权重",-1))),Ee={class:"setting-item-data-value"},$e={class:"setting-item-data"},Fe=_e((()=>n("div",{class:"setting-item-data-name"},"预览图地址",-1))),Ae={class:"setting-item-data-value"},Je={class:"setting-item-data"},Re=_e((()=>n("div",{class:"setting-item-data-name"},"value",-1))),ze={class:"setting-item-data-value"},qe={class:"setting-item-data"},Ke=_e((()=>n("div",{class:"setting-item-data-name"},"风格参考",-1))),Qe={class:"setting-item-data-value"},Ge={class:"setting-item-data"},Pe=_e((()=>n("div",{class:"setting-item-data-name"},"结构参考",-1))),We={class:"setting-item-data-value"},Xe={class:"setting-item-data"},Ye=_e((()=>n("div",{class:"setting-item-data-name"},"value",-1))),Ze={class:"setting-item-data-value"};var ea=S({__name:"promptSettingAddOrUpdate",emits:["review"],setup(s,{expose:c,emit:m}){const p=e("maskDom"),f=e(!1),U=e("add"),D=m,I=e(!1),S=e(null),L=e(!1),j=e(!1),M=e(!1);e(new Set([])),e(new Set([]));const N=e(""),H=e({lora:"",weight:100}),B=e(!0),E=e(""),$=e({ref_style:!0,ref_struct:!0,value:""});e({probability:20,value:""}),e({probability:20,value:""});const A=e([]),J=({target:e})=>{S.value=e.innerHTML},R=()=>{I.value=!I.value,I.value?N.value=N.value:N.value=S.value},z=()=>{p.value.hide(),setTimeout((()=>{f.value=!1}),200)};return c({init:(e="add",a={})=>{if(f.value)return;f.value=!0,L.value=!1,j.value=!1,M.value=!1,N.value=a.name||"",E.value=a.preview||"",a.extra_params?(a.extra_params.lora.weight*=100,H.value=a.extra_params.lora,$.value=a.extra_params.reference,B.value=a.extra_params.remove_bg.value):(H.value={lora:"",weight:100},$.value={ref_style:!0,ref_struct:!0,value:""},B.value=!0);const l=a.contents||[],t=[];l.forEach((e=>{const a={uuid:x(),content:e.content,maxLength:0,elements:[]},l=[0,0];Object.keys(e).forEach((t=>{t.includes("elements")&&(l.push(Number(t.replaceAll("elements_",""))),a.elements.push({name:t,values:e[t]}))})),a.maxLength=Math.max(...l),t.push(a)})),A.value=t,U.value=e,V((()=>{p.value.show()}))}}),(e,s)=>{const c=a("el-icon"),m=a("el-select"),V=a("el-scrollbar"),S=a("el-input"),L=a("el-input-number"),j=a("el-option"),M=a("t-mask");return l(),t("div",he,[f.value?(l(),u(M,{key:0,ref_key:"maskDom",ref:p},{default:d((()=>[n("div",be,[n("div",we,[ke,n("div",{class:"title-name",contenteditable:I.value,".innerHTML":N.value,onBlur:J},null,40,ye),n("div",{class:"title-handle-area",style:g({width:("add"===U.value?1.7:.8)+"rem"})},["add"===U.value?(l(),t("div",{key:0,class:"title-handle-btn",onClick:R},[i(c,null,{default:d((()=>[(l(),u(o(I.value?v(h):v(_))))])),_:1})])):r("",!0),n("div",{class:"title-handle-btn",onClick:s[0]||(s[0]=e=>(()=>{const e=JSON.parse(JSON.stringify(H.value));e.weitgh/=100;const a={contents:[],extra_params:{lora:e,reference:$.value,remove_bg:{value:B.value}}};A.value.forEach((e=>{const l={content:e.content};e.elements.forEach((e=>{l[e.name]=e.values})),a.contents.push(l)}));const l=JSON.stringify(a),t=new Blob([l],{type:"application/json"}),n=new File([t],`${N.value}.json`,{type:"application/json",lastModified:Date.now()}),s=new FormData;s.append("file",n),T(s,"prompts",N.value,E.value).then((e=>{z(),D("review")}))})())},[i(c,null,{default:d((()=>[i(v(b))])),_:1})])],4),n("div",{class:"close-btn",onClick:z},[i(c,null,{default:d((()=>[i(v(w))])),_:1})])]),n("div",xe,[n("div",Ve,[i(V,null,{default:d((()=>[(l(!0),t(k,null,y(A.value,(e=>(l(),u(F,{key:e.uuid,name:e.content,col:e.elements.length+1,"need-remove":"","need-edit":"",onSetName:a=>{e.content=a},onDeleteItem:()=>{(e=>{const a=A.value.findIndex((a=>a.uuid===e));A.value.splice(a,1)})(e.uuid)}},{default:d((()=>[(l(!0),t(k,null,y(e.elements,(a=>(l(),t("div",{class:"setting-item-data",key:a.name},[n("div",Ue,[C(O(a.name.replace("elements_","参数"))+" ",1),i(c,{onClick:l=>((e,a)=>{const l=A.value.findIndex((a=>a.uuid===e)),t=A.value[l].elements.findIndex((e=>e.name===a));A.value[l].content=A.value[l].content.replaceAll(`{${a}}`,""),A.value[l].elements.splice(t,1)})(e.uuid,a.name),class:"handle-btn"},{default:d((()=>[i(v(w))])),_:2},1032,["onClick"])]),n("div",De,[i(m,{"reserve-keyword":!1,"default-first-option":"","allow-create":"",modelValue:a.values,"onUpdate:modelValue":e=>a.values=e,multiple:"",filterable:""},null,8,["modelValue","onUpdate:modelValue"])])])))),128)),n("div",Ie,[n("div",{class:"setting-item-data-name pointer",onClick:a=>((e,a)=>{const l=A.value.findIndex((a=>a.uuid===e));A.value[l].maxLength+=1,A.value[l].content+=`{elements_${A.value[l].maxLength}}`,A.value[l].elements.push({name:`elements_${A.value[l].maxLength}`,values:[]})})(e.uuid)},"添加",8,Ce),Oe])])),_:2},1032,["name","col","onSetName","onDeleteItem"])))),128)),n("div",Se,[n("div",Te,[n("div",{class:"content-input",onClick:s[1]||(s[1]=e=>(()=>{const e=x();A.value.push({uuid:e,content:"",maxLength:0,elements:[]})})())},"添加提示词")])])])),_:1})]),n("div",Le,[i(V,null,{default:d((()=>[i(F,{name:"lora",col:2},{default:d((()=>[n("div",je,[Me,n("div",Ne,[i(S,{modelValue:H.value.lora,"onUpdate:modelValue":s[2]||(s[2]=e=>H.value.lora=e)},null,8,["modelValue"])])]),n("div",He,[Be,n("div",Ee,[i(L,{controls:!1,min:0,max:100,modelValue:H.value.weight,"onUpdate:modelValue":s[3]||(s[3]=e=>H.value.weight=e)},null,8,["modelValue"]),C(" % ")])])])),_:1}),i(F,{name:"预览图",col:1},{default:d((()=>[n("div",$e,[Fe,n("div",Ae,[i(S,{modelValue:E.value,"onUpdate:modelValue":s[4]||(s[4]=e=>E.value=e)},null,8,["modelValue"])])])])),_:1}),i(F,{name:"是否需要背景",col:1},{default:d((()=>[n("div",Je,[Re,n("div",ze,[i(m,{modelValue:B.value,"onUpdate:modelValue":s[5]||(s[5]=e=>B.value=e)},{default:d((()=>[i(j,{value:!0,label:"是"}),i(j,{value:!1,label:"否"})])),_:1},8,["modelValue"])])])])),_:1}),i(F,{name:"参考图",col:3},{default:d((()=>[n("div",qe,[Ke,n("div",Qe,[i(m,{modelValue:$.value.ref_style,"onUpdate:modelValue":s[6]||(s[6]=e=>$.value.ref_style=e)},{default:d((()=>[i(j,{value:!0,label:"是"}),i(j,{value:!1,label:"否"})])),_:1},8,["modelValue"])])]),n("div",Ge,[Pe,n("div",We,[i(m,{modelValue:$.value.ref_struct,"onUpdate:modelValue":s[7]||(s[7]=e=>$.value.ref_struct=e)},{default:d((()=>[i(j,{value:!0,label:"是"}),i(j,{value:!1,label:"否"})])),_:1},8,["modelValue"])])]),n("div",Xe,[Ye,n("div",Ze,[i(S,{modelValue:$.value.value,"onUpdate:modelValue":s[8]||(s[8]=e=>$.value.value=e)},null,8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):r("",!0)])}}},[["__scopeId","data-v-0e6fb23a"]]);const aa={class:"prompt-setting"},la={class:"prompt-setting-info"};var ta=S({__name:"promptSetting",props:["class"],setup(o,{expose:v}){const c=e({}),m=e("addOrUpdateDom"),r=o,p=()=>{L("prompts").then((e=>{c.value=e.templates}))},f=(...e)=>{m.value.init(...e)};return I((()=>{p()})),v({addOrUpdate:f}),(e,o)=>{const v=a("modelCard"),g=a("el-scrollbar");return l(),t("div",aa,[i(g,null,{default:d((()=>[n("div",la,[(l(!0),t(k,null,y(Object.keys(c.value),(e=>(l(),u(v,{class:s(r.class),key:e,data:{name:e,preview:c.value[e].preview},onToUpdate:()=>{(({name:e,preview:a})=>{j("prompts",e).then((l=>{f("update",Object.assign({name:e,preview:a},l))}))})({name:e,preview:c.value[e].preview})},onDeleteItem:()=>{(({name:e})=>{M("prompts",e).then((e=>{p()}))})({name:e})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),i(ea,{ref_key:"addOrUpdateDom",ref:m,onReview:p},null,512)])}}},[["__scopeId","data-v-66182dc4"]]);const na=e=>(U("data-v-7cb4990c"),e=e(),D(),e),sa={class:"add-or-update"},ia={class:"add-or-update-box"},da={class:"title"},ua=na((()=>n("div",{class:"title-label"},"参数选择:",-1))),oa=["contenteditable",".innerHTML"],va={class:"folder"},ca={class:"setting-list folder-list"},ma={class:"setting-item-data-name"},ra={class:"setting-item-data-value"},pa={class:"setting-item-data"},fa=na((()=>n("div",{class:"setting-item-data-value"},null,-1))),ga={class:"setting-list params-list"},_a={class:"setting-item-data"},ha=na((()=>n("div",{class:"setting-item-data-name"},"value",-1))),ba={class:"setting-item-data-value"};var wa=S({__name:"backgroundSettingAddOrUpdate",emits:["review"],setup(s,{expose:c,emit:m}){const p=e("maskDom"),f=e(!1),U=e("add"),D=m,I=e(!1),O=e(null),S=e(!1),L=e(!1),j=e(!1);e(new Set([])),e(new Set([]));const M=e(""),B=e([]),E=e(0),$=({target:e})=>{O.value=e.innerHTML},A=()=>{I.value=!I.value,I.value?M.value=M.value:M.value=O.value},J=()=>{p.value.hide(),setTimeout((()=>{f.value=!1}),200)};return c({init:(e="add",a={})=>{f.value||(f.value=!0,S.value=!1,L.value=!1,j.value=!1,M.value=a.name||"",a.colors?B.value=a.colors.map((e=>({uuid:x(),value:N(e)}))):B.value=[],a.extra_params?E.value=a.extra_params.variation:E.value=0,U.value=e,V((()=>{p.value.show()})))}}),(e,s)=>{const c=a("el-icon"),m=a("el-color-picker"),V=a("el-scrollbar"),O=a("el-input-number"),S=a("t-mask");return l(),t("div",sa,[f.value?(l(),u(S,{key:0,ref_key:"maskDom",ref:p},{default:d((()=>[n("div",ia,[n("div",da,[ua,n("div",{class:"title-name",contenteditable:I.value,".innerHTML":M.value,onBlur:$},null,40,oa),n("div",{class:"title-handle-area",style:g({width:("add"===U.value?1.7:.8)+"rem"})},["add"===U.value?(l(),t("div",{key:0,class:"title-handle-btn",onClick:A},[i(c,null,{default:d((()=>[(l(),u(o(I.value?v(h):v(_))))])),_:1})])):r("",!0),n("div",{class:"title-handle-btn",onClick:s[0]||(s[0]=e=>(()=>{const e={colors:B.value.map((e=>H(e.value))),extra_params:{variation:E.value}},a=JSON.stringify(e),l=new Blob([a],{type:"application/json"}),t=new File([l],`${M.value}.json`,{type:"application/json",lastModified:Date.now()}),n=new FormData;n.append("file",t),T(n,"colors",M.value,"").then((e=>{J(),D("review")}))})())},[i(c,null,{default:d((()=>[i(v(b))])),_:1})])],4),n("div",{class:"close-btn",onClick:J},[i(c,null,{default:d((()=>[i(v(w))])),_:1})])]),n("div",va,[n("div",ca,[i(V,null,{default:d((()=>[i(F,{name:"颜色",col:B.value.length+1,onSetName:s[2]||(s[2]=a=>{e.n.folder=a}),onDeleteItem:s[3]||(s[3]=()=>{e.deleteFolder(e.n.uuid)})},{default:d((()=>[(l(!0),t(k,null,y(B.value,(e=>(l(),t("div",{class:"setting-item-data",key:e.uuid},[n("div",ma,[C(" 颜色 "),i(c,{onClick:a=>(e=>{const a=B.value.findIndex((a=>a.uuid===e));B.value.splice(a,1)})(e.uuid),class:"handle-btn"},{default:d((()=>[i(v(w))])),_:2},1032,["onClick"])]),n("div",ra,[i(m,{"color-format":"rgba","show-alpha":"",style:{width:"100%"},modelValue:e.value,"onUpdate:modelValue":a=>e.value=a},null,8,["modelValue","onUpdate:modelValue"])])])))),128)),n("div",pa,[n("div",{class:"setting-item-data-name pointer",onClick:s[1]||(s[1]=e=>(()=>{const e=x();B.value.push({uuid:e,value:"rgba(0,0,0,1)"})})())},"添加"),fa])])),_:1},8,["col"])])),_:1})]),n("div",ga,[i(V,null,{default:d((()=>[i(F,{name:"变化",col:1},{default:d((()=>[n("div",_a,[ha,n("div",ba,[i(O,{modelValue:E.value,"onUpdate:modelValue":s[4]||(s[4]=e=>E.value=e),controls:!1},null,8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):r("",!0)])}}},[["__scopeId","data-v-7cb4990c"]]);const ka={class:"statics-setting"},ya={class:"statics-setting-info"};var xa=S({__name:"backgroundSetting",props:["class"],setup(o,{expose:v}){const c=e({}),m=e("addOrUpdateDom"),r=o,p=()=>{L("colors").then((e=>{c.value=e.templates}))},f=(...e)=>{m.value.init(...e)};return I((()=>{p()})),v({addOrUpdate:f}),(e,o)=>{const v=a("modelCard"),g=a("el-scrollbar");return l(),t("div",ka,[i(g,null,{default:d((()=>[n("div",ya,[(l(!0),t(k,null,y(Object.keys(c.value),(e=>(l(),u(v,{class:s(r.class),key:e,data:{name:e,preview:c.value[e].preview},onToUpdate:()=>{(({name:e,preview:a})=>{j("colors",e).then((l=>{f("update",Object.assign({name:e,preview:a},l))}))})({name:e,preview:c.value[e].preview})},onDeleteItem:()=>{(({name:e})=>{M("colors",e).then((e=>{p()}))})({name:e})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),i(wa,{ref_key:"addOrUpdateDom",ref:m,onReview:p},null,512)])}}},[["__scopeId","data-v-26564696"]]);const Va=e=>(U("data-v-22b6f986"),e=e(),D(),e),Ua={class:"add-or-update"},Da={class:"add-or-update-box"},Ia={class:"title"},Ca=Va((()=>n("div",{class:"title-label"},"参数选择:",-1))),Oa=["contenteditable",".innerHTML"],Sa={class:"content"},Ta={class:"setting-list prompts-list"},La={class:"setting-item-data-name"},ja={class:"setting-item-data-value"},Ma={class:"setting-item-data"},Na=["onClick"],Ha=Va((()=>n("div",{class:"setting-item-data-value"},null,-1))),Ba={class:"setting-handle"},Ea={class:"setting-item-data-value"},$a={class:"setting-list params-list"},Fa={class:"setting-item-data"},Aa=Va((()=>n("div",{class:"setting-item-data-name"},"value",-1))),Ja={class:"setting-item-data-value"},Ra={class:"setting-item-data"},za=Va((()=>n("div",{class:"setting-item-data-name"},"value",-1))),qa={class:"setting-item-data-value"},Ka={class:"setting-item-data"},Qa=Va((()=>n("div",{class:"setting-item-data-name"},"value",-1))),Ga={class:"setting-item-data-value"};var Pa=S({__name:"textSettingAddOrUpdate",emits:["review"],setup(s,{expose:c,emit:m}){const p=e("maskDom"),f=e(!1),U=e("add"),D=m,I=e(!1),S=e(null),L=e(!1),j=e(!1),M=e(!1);e(new Set([])),e(new Set([]));const B=e(""),E=e(""),$=e(""),A=e("rgba(0,0,0,1)"),J=e([]),R=({target:e})=>{S.value=e.innerHTML},z=()=>{I.value=!I.value,I.value?B.value=B.value:B.value=S.value},q=()=>{p.value.hide(),setTimeout((()=>{f.value=!1}),200)};return c({init:(e="add",a={})=>{if(f.value)return;f.value=!0,L.value=!1,j.value=!1,M.value=!1,B.value=a.name||"",a.extra_params?(E.value=a.extra_params.font,$.value=a.extra_params.font_size,A.value=N(a.extra_params.font_color)):(E.value="",$.value="",A.value="rgba(0,0,0,1)");const l=a.contents||[],t=[];l.forEach((e=>{const a={uuid:x(),content:e.content,maxLength:0,elements:[]},l=[0,0];Object.keys(e).forEach((t=>{t.includes("elements")&&(l.push(Number(t.replaceAll("elements_",""))),a.elements.push({name:t,values:e[t]}))})),a.maxLength=Math.max(...l),t.push(a)})),J.value=t,U.value=e,V((()=>{p.value.show()}))}}),(e,s)=>{const c=a("el-icon"),m=a("el-select"),V=a("el-scrollbar"),S=a("el-input"),L=a("el-input-number"),j=a("el-color-picker"),M=a("t-mask");return l(),t("div",Ua,[f.value?(l(),u(M,{key:0,ref_key:"maskDom",ref:p},{default:d((()=>[n("div",Da,[n("div",Ia,[Ca,n("div",{class:"title-name",contenteditable:I.value,".innerHTML":B.value,onBlur:R},null,40,Oa),n("div",{class:"title-handle-area",style:g({width:("add"===U.value?1.7:.8)+"rem"})},["add"===U.value?(l(),t("div",{key:0,class:"title-handle-btn",onClick:z},[i(c,null,{default:d((()=>[(l(),u(o(I.value?v(h):v(_))))])),_:1})])):r("",!0),n("div",{class:"title-handle-btn",onClick:s[0]||(s[0]=e=>(()=>{const e={contents:[],extra_params:{font:E.value,font_size:$.value,font_color:H(A.value)}};J.value.forEach((a=>{const l={content:a.content};a.elements.forEach((e=>{l[e.name]=e.values})),e.contents.push(l)}));const a=JSON.stringify(e),l=new Blob([a],{type:"application/json"}),t=new File([l],`${B.value}.json`,{type:"application/json",lastModified:Date.now()}),n=new FormData;n.append("file",t),T(n,"texts",B.value,"").then((e=>{q(),D("review")}))})())},[i(c,null,{default:d((()=>[i(v(b))])),_:1})])],4),n("div",{class:"close-btn",onClick:q},[i(c,null,{default:d((()=>[i(v(w))])),_:1})])]),n("div",Sa,[n("div",Ta,[i(V,null,{default:d((()=>[(l(!0),t(k,null,y(J.value,(e=>(l(),u(F,{key:e.uuid,name:e.content,col:e.elements.length+1,"need-remove":"","need-edit":"",onSetName:a=>{e.content=a},onDeleteItem:()=>{(e=>{const a=J.value.findIndex((a=>a.uuid===e));J.value.splice(a,1)})(e.uuid)}},{default:d((()=>[(l(!0),t(k,null,y(e.elements,(a=>(l(),t("div",{class:"setting-item-data",key:a.name},[n("div",La,[C(O(a.name.replace("elements_","参数"))+" ",1),i(c,{onClick:l=>((e,a)=>{const l=J.value.findIndex((a=>a.uuid===e)),t=J.value[l].elements.findIndex((e=>e.name===a));J.value[l].content=J.value[l].content.replaceAll(`{${a}}`,""),J.value[l].elements.splice(t,1)})(e.uuid,a.name),class:"handle-btn"},{default:d((()=>[i(v(w))])),_:2},1032,["onClick"])]),n("div",ja,[i(m,{"reserve-keyword":!1,"default-first-option":"","allow-create":"",modelValue:a.values,"onUpdate:modelValue":e=>a.values=e,multiple:"",filterable:""},null,8,["modelValue","onUpdate:modelValue"])])])))),128)),n("div",Ma,[n("div",{class:"setting-item-data-name pointer",onClick:a=>((e,a)=>{const l=J.value.findIndex((a=>a.uuid===e));J.value[l].maxLength+=1,J.value[l].content+=`{elements_${J.value[l].maxLength}}`,J.value[l].elements.push({name:`elements_${J.value[l].maxLength}`,values:[]})})(e.uuid)},"添加",8,Na),Ha])])),_:2},1032,["name","col","onSetName","onDeleteItem"])))),128)),n("div",Ba,[n("div",Ea,[n("div",{class:"content-input",onClick:s[1]||(s[1]=e=>(()=>{const e=x();J.value.push({uuid:e,content:"",maxLength:0,elements:[]})})())},"添加文本")])])])),_:1})]),n("div",$a,[i(V,null,{default:d((()=>[i(F,{name:"字体",col:1},{default:d((()=>[n("div",Fa,[Aa,n("div",Ja,[i(S,{modelValue:E.value,"onUpdate:modelValue":s[2]||(s[2]=e=>E.value=e)},null,8,["modelValue"])])])])),_:1}),i(F,{name:"字号",col:1},{default:d((()=>[n("div",Ra,[za,n("div",qa,[i(L,{modelValue:$.value,"onUpdate:modelValue":s[3]||(s[3]=e=>$.value=e),controls:!1},null,8,["modelValue"])])])])),_:1}),i(F,{name:"颜色",col:1},{default:d((()=>[n("div",Ka,[Qa,n("div",Ga,[i(j,{"color-format":"rgba","show-alpha":"",style:{width:"100%"},modelValue:A.value,"onUpdate:modelValue":s[4]||(s[4]=e=>A.value=e)},null,8,["modelValue"])])])])),_:1})])),_:1})])])])])),_:1},512)):r("",!0)])}}},[["__scopeId","data-v-22b6f986"]]);const Wa={class:"statics-setting"},Xa={class:"statics-setting-info"};var Ya=S({__name:"textSetting",props:["class"],setup(o,{expose:v}){const c=e({}),m=e("addOrUpdateDom"),r=o,p=()=>{L("texts").then((e=>{c.value=e.templates}))},f=(...e)=>{m.value.init(...e)};return I((()=>{p()})),v({addOrUpdate:f}),(e,o)=>{const v=a("modelCard"),g=a("el-scrollbar");return l(),t("div",Wa,[i(g,null,{default:d((()=>[n("div",Xa,[(l(!0),t(k,null,y(Object.keys(c.value),(e=>(l(),u(v,{class:s(r.class),key:e,data:{name:e,preview:c.value[e].preview},onToUpdate:()=>{(({name:e,preview:a})=>{j("texts",e).then((l=>{f("update",Object.assign({name:e,preview:a},l))}))})({name:e,preview:c.value[e].preview})},onDeleteItem:()=>{(({name:e})=>{M("texts",e).then((e=>{p()}))})({name:e})}},null,8,["class","data","onToUpdate","onDeleteItem"])))),128))])])),_:1}),i(Pa,{ref_key:"addOrUpdateDom",ref:m,onReview:p},null,512)])}}},[["__scopeId","data-v-50e494de"]]);const Za={class:"prompt-setting-outer"},el={class:"prompt-setting-handle-area"},al={class:"change-setting-type-area"},ll=["onClick"],tl={class:"prompt-setting-component-area"};var nl=S({__name:"index",props:["class"],setup(v){const c=v,m=[{name:"静态层配置",component:ge},{name:"prompt配置",component:ta},{name:"背景层配置",component:xa},{name:"文本层配置",component:Ya}],r=e(0),p=e("componentDom");return I((()=>{window.loading||(window.loading=B()),setTimeout((()=>{window.loading.close(),window.loading=null}),300)})),(e,v)=>{const f=a("t-button");return l(),t("div",Za,[n("div",el,[n("div",al,[n("div",{class:"component-selected",style:g({left:3.2*r.value+.05+"rem"})},null,4),(l(),t(k,null,y(m,((e,a)=>n("div",{class:"component-item",onClick:e=>r.value=a,key:e.name},O(e.name),9,ll))),64))]),i(f,{style:{margin:"0",width:"2.5rem","text-align":"center"},type:"warn",onClick:v[0]||(v[0]=e=>{p.value.addOrUpdate()})},{default:d((()=>[C("新增")])),_:1})]),n("div",tl,[(l(),u(o(m[r.value].component),{class:s(c.class),ref_key:"componentDom",ref:p},null,8,["class"]))])])}}},[["__scopeId","data-v-e74cf2f4"]]);export{nl as default};
