import{_ as e,i as a,l as t}from"./index.3712656f.js";import{o as s,c as n,t as u,n as l,r as i,a3 as d,j as o,b as c,y as v,k as r,P as p,a as m,e as g,w as y,F as f,x as _,s as w,f as h,a4 as S,p as b,l as k,v as x}from"./lib.b70eb088.js";var M=e({__name:"list",props:{name:{type:String,value:"未设置对话名称"},uuid:{type:String,value:null},selectedUuid:{type:String,value:null}},emits:"setSelected",setup(e,{emit:a}){const t=e,i=a,d=()=>{i("setSelected",t.uuid)};return(a,t)=>(s(),n("div",{class:l(["list-item",{selected:e.selectedUuid===e.uuid}]),onClick:d},u(e.name),3))}},[["__scopeId","data-v-75399a30"]]);const U=["type"],O={key:0,class:"info-image"},$=["src"],j={class:"info-content"},z={key:1,class:"info-image"},A={class:"info-data"};var C=e({__name:"info-list",props:{uuid:{type:String,value:null},content:{type:String,value:""},type:{type:String,value:"send"}},setup(e){const l=e,p=["QAQ","o.O","O.o","OvO"],m=i(null),g=d(l,"uuid");return o((()=>{"get"===l.type&&a.get("message_data",g.value).then((e=>{e&&e.content&&(m.value=e.content.value)}))})),(a,l)=>(s(),n("div",null,[c("div",{class:"info-list-item",type:e.type},["get"===e.type?(s(),n("div",O,[c("img",{src:v(t)},null,8,$)])):r("",!0),c("div",j,u(e.content),1),"send"===e.type?(s(),n("div",z,u(p[Math.floor(Math.random()*p.length)]),1)):r("",!0)],8,U),c("div",A,u(m.value),1)]))}},[["__scopeId","data-v-7df3d019"]]);const I={class:"info-body"},L={class:"info-list"},V={class:"info-input"},Q={class:"info-data-input"},F=(e=>(b("data-v-4d6ba707"),e=e(),k(),e))((()=>c("div",{class:"data-input-area"},null,-1))),K={class:"data-send-area"},P={class:"info-message-input"};var q=e({__name:"info",props:{uuid:{type:String,value:null}},emits:["sendMessage"],setup(e,{emit:t}){const u=i(null),l=t,o=i([]),v=e,r=d(v,"uuid");p(r,(async e=>{e?await(async e=>{const t=await a.get("message",e),{content:s}=t,{contentList:n}=s,u=[];for(let l=0;l<n.length;l++){const e=await a.get("message_info",n[l]);u.push(e.content)}o.value=u})(e):o.value=[]}));const b=()=>{l("sendMessage",{content:u.value.replaceAll("\n",""),uuid:v.uuid}),u.value=null};return(e,a)=>{const t=m("el-scrollbar"),l=m("t-button"),i=m("el-input");return s(),n("div",I,[c("div",L,[g(t,null,{default:y((()=>[(s(!0),n(f,null,_(o.value,(e=>(s(),w(C,{key:e.uuid,content:e.value,type:e.type,uuid:e.uuid},null,8,["content","type","uuid"])))),128))])),_:1})]),c("div",V,[c("div",Q,[F,c("div",K,[g(l,{size:"min",style:{margin:"0",width:"2rem","text-align":"center","line-height":"0.5rem"},type:"success",onClick:b},{default:y((()=>[h("发送")])),_:1})])]),c("div",P,[g(i,{type:"textarea",resize:"none",modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),onKeyup:S(b,["enter"])},null,8,["modelValue"])])])])}}},[["__scopeId","data-v-4d6ba707"]]);const B={class:"conversation-body"},D={class:"conversation-list"},E={class:"conversation-info"},G={__name:"index",setup(e){const t=i(null),u=i([]),l=e=>{t.value=e},d=async({uuid:e,content:s})=>{const n=x(),u=x();if(e){t.value=null;const l=await a.get("message",e);l.content.contentList.push(n,u),await a.update("message",l.content),await a.add("message_info",{uuid:n,type:"send",value:s}),await a.add("message_info",{uuid:u,type:"get",value:`这是 ${s} 这个问题的回答`}),await a.add("message_data",{uuid:u,value:`这是 ${s} 这个问题的回答所携带的数据`}),await v(),t.value=e}else e=x(),await a.add("message",{uuid:e,name:s,contentList:[n,u]}),await a.add("message_info",{uuid:n,type:"send",value:s}),await a.add("message_info",{uuid:u,type:"get",value:`这是 ${s} 这个问题的回答`}),await a.add("message_data",{uuid:u,value:`这是 ${s} 这个问题的回答所携带的数据`}),await v(),t.value=e},v=async()=>{const e=await a.getAll("message");u.value=e.reverse(),u.value.length&&(t.value||(t.value=u.value[0].uuid))};return o((()=>{v()})),(e,a)=>{const i=m("t-button");return s(),n("div",B,[c("div",D,[u.value.length?(s(),w(i,{key:0,size:"nomal",style:{width:"100%","text-align":"center"},type:"success",onClick:a[0]||(a[0]=e=>t.value=null)},{default:y((()=>[h("新对话")])),_:1})):r("",!0),(s(!0),n(f,null,_(u.value,(e=>(s(),w(M,{key:e.uuid,name:e.name,uuid:e.uuid,selectedUuid:t.value,onSetSelected:l},null,8,["name","uuid","selectedUuid"])))),128))]),c("div",E,[g(q,{uuid:t.value,onSendMessage:d},null,8,["uuid"])])])}}};const H={class:"conversation-outer"},J={__name:"index",setup:e=>(e,a)=>(s(),n("div",H,[g(G)]))};export{J as default};
